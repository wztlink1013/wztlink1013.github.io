<!DOCTYPE html>
<!-- TODO: HTML首部 -->
<html lang="zh-cn">
<head>
  <meta charset="UTF-8">
  <title>数据库中的函数 | 尼采般地抒情</title>
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width,height=device-height,initial-scale=1,user-scalable=0">
  <meta name="author" content="https://plus.google.com/112634278852964994392?hl=zh-cn">
  <meta name="email" content="wztlink1013@163.com">
  <meta name="description" content="数据库中的函数">
  <meta property="og:type" content="article">
  <meta property="og:title" content="数据库中的函数 | 尼采般地抒情">
  <meta property="og:url" content="https://yun.wztlink1013.com/blog/sbxidb/">
  <meta property="og:site_name" content="数据库中的函数">
  <meta property="og:description" content="数据库中的函数">
  <meta name="generator" content="https://hexo.io" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <!-- <meta name="renderer" content="webkit"> -->
  <!-- 下面的是语雀图片不显示的解决办法 -->
  <meta name="referrer" content="no-referrer" />
  <link href="https://yun.wztlink1013.com/blogimgs/app-icon.png" rel="apple-touch-icon-precomposed">
  <link rel="shoticon" href="https://yun.wztlink1013.com/favicon.ico" type="image/x-icon">
  <link rel="alternate" type="application/rss+xml" href="https://yun.wztlink1013.com/rss2.xml" title="尼采般地抒情" />
  <link rel="prev" href="https://yun.wztlink1013.com/blog/frgbbo/" title="权限管理" />
  <link rel="next" href="https://yun.wztlink1013.com/blog/tr2ahg/" title="索引" />
  <!-- TODO: entry_blog -->
  <link rel="start" href="https://yun.wztlink1013.com/blog/" title="Blog blog" />
  <link rel="stylesheet" href="/public/css/style.css?v=20191101">
</head>


<body>
  <!-- TODO: CSS功能 -->
  <div class="rainbow"></div>
  <div class="container">
  <span class="local-search local-search-google local-search-plugin" style="position:absolute;right: 20px;top:30px;">
  <input type="search" placeholder="站内搜索" id="local-search-input" class="local-search-input-cls" style="">
  <i class="icon" aria-hidden="true" title="点击进入 Google 搜索">&#x2708;</i>
  <div id="local-search-result" class="local-search-result-cls"></div>
</span>
  <div class="article" itemscope itemtype="http://schema.org/Article">
    <div class="post">
      <div class="bread">
        <a href="/">尼采般地抒情个人博客</a> »
        <!-- TODO: entry_blog -->
        <a href="/blog/">博客</a> »
        
	<a class="category-link" href="/blog/categories/Language/">Language</a>


      </div>
      <div class="post-title-wrapper">
        <h1 class="post-title" itemprop="name">数据库中的函数<!--<img src="https://game.weixin.qq.com/cgi-bin/comm/qrcode?s=10&m=1&d=http:https://yun.wztlink1013.com/blog/sbxidb/" alt="扫码分享" onerror="this.style.display='none';">--></h1>
        <a href="/about/"><img src="https://cdn.jsdelivr.net/gh/wztlink1013/cdn-pictures@1.0.1/avatar/gif/avatar_Jitter.gif" alt="尼采般地抒情" /></a>
      </div>
      <div class="post-info">
        <span>作者: <a href="/about/">尼采般地抒情</a></span>
        <span>
          <time itemprop="timeCreated" aria-hidden="true">2020-09-23 22:01:00</time>
          <span class="aria-readonly">本文发布时间为2020年09月23日22时01分00秒</span>
        </span>
        <span>分类: 
	<a class="category-link" href="/blog/categories/Language/">Language</a>

</span>
        <span tabindex="0" aria-hidden="true">标签: </span>
        <span class="aria-readonly">下面是正文内容</span>
        <span tabindex="0" aria-hidden="true">评论数: <a href="#comments"
                      class="ds-thread-count hash-to-comments disqus-comment-count"
                      data-thread-key="blog/sbxidb"
                      data-disqus-identifier="blog/sbxidb"
                      id="changyan_count_unit"></a></span>
        <span tabindex="0" aria-hidden="true" id="busuanzi_container_site_pv">热度: <span id="busuanzi_value_page_pv"></span></span>
      </div>
      <div class="post-content" itemprop="articleBody">
        <div class="shit-spider" title="防爬虫不注明出处" tabindex="0" aria-hidden="true">
          <p>原文地址：<a href="https://yun.wztlink1013.com/blog/sbxidb/">https://yun.wztlink1013.com/blog/sbxidb/</a>，<a href="https://yun.wztlink1013.com/blog/sbxidb/#comments">参与评论</a></p>
          <img src="/blogimgs/avatar.png" width="150">
        </div>
        <h1 id="字符（串）函数"><a href="#字符（串）函数" class="headerlink" title="字符（串）函数"></a>字符（串）函数</h1><p>函数可以在 MySQL 提示符中，直接用 SELECT 语句测试。<br>比如 <strong>SELECT USER();</strong></p>
<h2 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h2><ul>
<li>字符函数</li>
<li>数值运算符与函数</li>
<li>比较运算符与函数</li>
<li>日期时间函数</li>
<li>信息函数</li>
<li>聚合函数</li>
<li>加密函数</li>
</ul>
<h2 id="字符（串）函数-1"><a href="#字符（串）函数-1" class="headerlink" title="字符（串）函数"></a>字符（串）函数</h2><table>
<thead>
<tr>
<th>名称</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>CONCAT</td>
<td>字符串连接</td>
</tr>
<tr>
<td>CONCAT_WS</td>
<td>同上，但指定连接符</td>
</tr>
<tr>
<td>FORMAT</td>
<td>数字格式化</td>
</tr>
<tr>
<td>LOWER</td>
<td>转换成小写字母</td>
</tr>
<tr>
<td>UPPER</td>
<td>转换成大写字母</td>
</tr>
<tr>
<td>LEFT</td>
<td>获取左侧字符</td>
</tr>
<tr>
<td>RIGHT</td>
<td>获取右侧字符</td>
</tr>
<tr>
<td>LENGTH</td>
<td>获取长度</td>
</tr>
<tr>
<td>LTRIM</td>
<td>删除前导空格</td>
</tr>
<tr>
<td>RTRIM</td>
<td>删除后续空格</td>
</tr>
<tr>
<td>TRIM</td>
<td>删除前后空格</td>
</tr>
<tr>
<td>SUBSTRING</td>
<td>字符串截取</td>
</tr>
<tr>
<td>[NOT] LIKE</td>
<td>模式匹配</td>
</tr>
<tr>
<td>REPEAT</td>
<td>重复字符串</td>
</tr>
<tr>
<td>REPLACE</td>
<td>字符串替换</td>
</tr>
</tbody>
</table>
<h3 id="CONCAT"><a href="#CONCAT" class="headerlink" title="CONCAT"></a>CONCAT</h3><p>参数个数不限，连接成一个字符串<br>已知 test 表的内如如下：</p>
<figure class="highlight gherkin"><table><tr><td class="code"><pre><span class="line">+----+------------+-----------+</span><br><span class="line">|<span class="string"> id </span>|<span class="string"> first_name </span>|<span class="string"> last_name </span>|</span><br><span class="line">+----+------------+-----------+</span><br><span class="line">|<span class="string">  1 </span>|<span class="string"> A          </span>|<span class="string"> B         </span>|</span><br><span class="line">|<span class="string">  2 </span>|<span class="string"> C          </span>|<span class="string"> D         </span>|</span><br><span class="line">|<span class="string">  3 </span>|<span class="string"> tom%       </span>|<span class="string"> 123       </span>|</span><br><span class="line">|<span class="string">  4 </span>|<span class="string"> NULL       </span>|<span class="string"> 11        </span>|</span><br><span class="line">|<span class="string">  5 </span>|<span class="string"> 11         </span>|<span class="string"> 22        </span>|</span><br><span class="line">|<span class="string">  6 </span>|<span class="string"> AA         </span>|<span class="string"> BB        </span>|</span><br><span class="line">|<span class="string">  7 </span>|<span class="string"> CC         </span>|<span class="string"> DD        </span>|</span><br><span class="line">+----+------------+-----------+</span><br></pre></td></tr></table></figure>
<p>test 表中有两个字段 first_name,和 last_name，调用连接函数之后：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SELECT CONCAT(first_name,last_name)AS full_name FROM test;</span><br><span class="line"></span><br><span class="line">+-----------+</span><br><span class="line">| full_name |</span><br><span class="line">+-----------+</span><br><span class="line">| AB        |</span><br><span class="line">| CD        |</span><br><span class="line">| tom%123   |</span><br><span class="line">| NULL      |</span><br><span class="line">| 1122      |</span><br><span class="line">| AABB      |</span><br><span class="line">| CCDD      |</span><br><span class="line">+-----------+</span><br></pre></td></tr></table></figure>
<h3 id="CONCAT-WS"><a href="#CONCAT-WS" class="headerlink" title="CONCAT_WS"></a>CONCAT_WS</h3><p>参数至少有三个，第一参数为要连接字符串的分隔符，后面的都是待连接的字符串。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SELECT CONCAT_WS(&apos;-&apos;,1992,10,17);</span><br><span class="line"></span><br><span class="line">+---------------------------+</span><br><span class="line">| CONCAT_WS(&apos;-&apos;,1992,10,17) |</span><br><span class="line">+---------------------------+</span><br><span class="line">| 1992-10-17                |</span><br><span class="line">+---------------------------+</span><br></pre></td></tr></table></figure>
<h3 id="FORMAT"><a href="#FORMAT" class="headerlink" title="FORMAT"></a>FORMAT</h3><p>将数字格式化为字符串。第二个参数为小数的位数。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SELECT FORMAT(12345.67,2);</span><br></pre></td></tr></table></figure>
<p>结果为千分位:</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="code">+--------------------+</span></span><br><span class="line">| FORMAT(12345.67,2) |</span><br><span class="line"><span class="code">+--------------------+</span></span><br><span class="line">| 12,345.67          |</span><br><span class="line"><span class="code">+--------------------+</span></span><br></pre></td></tr></table></figure>
<h3 id="LOWER-UPPER"><a href="#LOWER-UPPER" class="headerlink" title="LOWER/UPPER"></a>LOWER/UPPER</h3><p>顾名思义，不再解释</p>
<h3 id="LEFT-RIGHT"><a href="#LEFT-RIGHT" class="headerlink" title="LEFT/RIGHT"></a>LEFT/RIGHT</h3><p>获取左（右）侧第几个字符。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">LEFT</span>(<span class="string">'MySQL'</span>,<span class="number">2</span>);</span><br></pre></td></tr></table></figure>
<h3 id="LENGTH"><a href="#LENGTH" class="headerlink" title="LENGTH"></a>LENGTH</h3><p>获取字符串长度。SQL Server 中是 len 函数。MySQL 中没有 len 函数。</p>
<h3 id="LTRIM-RTRIM"><a href="#LTRIM-RTRIM" class="headerlink" title="LTRIM/RTRIM"></a>LTRIM/RTRIM</h3><p>删除前导/后续空格</p>
<h3 id="SUBSTRING"><a href="#SUBSTRING" class="headerlink" title="SUBSTRING"></a>SUBSTRING</h3><p>与其他语言中一样，截取子串的三个参数分别为：</p>
<ul>
<li>原字符串</li>
<li>起始位置（注意下标从 1 算起；可以为负数，即从右数起）</li>
<li>截取长度（缺省为截取到结尾）</li>
</ul>
<h3 id="NOT-LIKE"><a href="#NOT-LIKE" class="headerlink" title="[NOT] LIKE"></a>[NOT] LIKE</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">FROM</span> <span class="string">'MySQL'</span> <span class="keyword">LIKE</span> <span class="string">'M%'</span>;</span><br></pre></td></tr></table></figure>
<p>结果为 1，即 true。</p>
<ul>
<li>%代表 0 个或多个字符。</li>
<li>_代表任意一个字符。</li>
</ul>
<blockquote>
<p>关于转义<br>当要匹配的字符中含有特殊字符(比如%)时，需要转义。\，貌似\也可以<br>SELECT CONCAT(first_name,last_name)AS full_name FROM test WHERE first_name LIKE’%%’;</p>
</blockquote>
<p>也可以自己指定<br>SELECT CONCAT(first_name,last_name)AS full_name FROM test WHERE first_name LIKE’%1%’ ESCAPE ‘1’;</p>
<h3 id="TRIM"><a href="#TRIM" class="headerlink" title="TRIM"></a>TRIM</h3><p>缺省可以删除前后空格，也可以删除指定的字符。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- 删除??MySQL???前面的？</span><br><span class="line">SELECT TRIM(LEADING &apos;?&apos; FROM &apos;??MySQL???&apos;);</span><br><span class="line">-- 删除后面的？</span><br><span class="line">SELECT TRIM(TRAILING &apos;?&apos; FROM &apos;??MySQL???&apos;);</span><br><span class="line">-- 删除前后的？</span><br><span class="line">SELECT TRIM(BOTH &apos;?&apos; FROM &apos;??MySQL???&apos;);</span><br></pre></td></tr></table></figure>
<h3 id="REPEAT"><a href="#REPEAT" class="headerlink" title="REPEAT"></a>REPEAT</h3><p>重复某一字符串多少次</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SELECT REPEAT(&apos;ab&apos;,2);</span><br></pre></td></tr></table></figure>
<p>结果是：</p>
<figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="code">+----------------+</span></span><br><span class="line">| REPEAT(<span class="emphasis">'ab'</span>,2) |</span><br><span class="line"><span class="code">+----------------+</span></span><br><span class="line">| abab           |</span><br><span class="line"><span class="code">+----------------+</span></span><br></pre></td></tr></table></figure>
<h3 id="REPLACE"><a href="#REPLACE" class="headerlink" title="REPLACE"></a>REPLACE</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- 去掉所有的？</span><br><span class="line">SELECT REPLACE(&apos;??MySQL&apos;,&apos;?&apos;,&apos;&apos;);</span><br></pre></td></tr></table></figure>
<p>注意！替换的时候也可以一换多，多换一。</p>
<h1 id="数值运算和比较运算"><a href="#数值运算和比较运算" class="headerlink" title="数值运算和比较运算"></a>数值运算和比较运算</h1><h2 id="数值运算"><a href="#数值运算" class="headerlink" title="数值运算"></a>数值运算</h2><table>
<thead>
<tr>
<th>名称</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>CEIL()</td>
<td>进一取整</td>
</tr>
<tr>
<td>DIV</td>
<td>整数除法</td>
</tr>
<tr>
<td>FLOOR()</td>
<td>舍一取整</td>
</tr>
<tr>
<td>MOD</td>
<td>模运算</td>
</tr>
<tr>
<td>POWER()</td>
<td>幂运算</td>
</tr>
<tr>
<td>ROUND()</td>
<td>四舍五入</td>
</tr>
<tr>
<td>TRUNCARE()</td>
<td>数字截取</td>
</tr>
</tbody>
</table>
<h3 id="CEIL-FLOOR-ROUND"><a href="#CEIL-FLOOR-ROUND" class="headerlink" title="CEIL/FLOOR/ROUND"></a>CEIL/FLOOR/ROUND</h3><p>前两者为对应操作。一个向上取整，一个向下取整。第三个 ROUND 为四舍五入。</p>
<h3 id="DIV-MOD"><a href="#DIV-MOD" class="headerlink" title="DIV/MOD"></a>DIV/MOD</h3><p>两者并非函数，而是 <strong>运算符</strong>。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SELECT 5 DIV 2;</span><br><span class="line">SELECT 7 MOD 3;</span><br></pre></td></tr></table></figure>
<p>MOD 与%等价，就是模运算，与别不同的是，MySQL 中支持浮点数取模。</p>
<h3 id="POWER"><a href="#POWER" class="headerlink" title="POWER"></a>POWER</h3><p>幂运算</p>
<h3 id="TRUNCARE"><a href="#TRUNCARE" class="headerlink" title="TRUNCARE"></a>TRUNCARE</h3><p>所谓的数字截取，就是对数字逐位的截断。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SELECT TRUNCATE(125.123, 1);</span><br><span class="line">SELECT TRUNCATE(125.123, 0);</span><br><span class="line">SELECT TRUNCATE(125.123, - 1);</span><br></pre></td></tr></table></figure>
<h2 id="运算的结果分别为：125-1、125-0-120"><a href="#运算的结果分别为：125-1、125-0-120" class="headerlink" title="运算的结果分别为：125.1、125.0,120"></a>运算的结果分别为：125.1、125.0,120</h2><h2 id="比较运算符与函数"><a href="#比较运算符与函数" class="headerlink" title="比较运算符与函数"></a>比较运算符与函数</h2><table>
<thead>
<tr>
<th>名称</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>[NOT] BETWEEN…AND…</td>
<td>[不]在范围内</td>
</tr>
<tr>
<td>[NOT] IN()</td>
<td>[不]在列出的值范围内</td>
</tr>
<tr>
<td>IS [NOT] NULL</td>
<td>[不]为空</td>
</tr>
</tbody>
</table>
<h1 id="日期时间函数"><a href="#日期时间函数" class="headerlink" title="日期时间函数"></a>日期时间函数</h1><table>
<thead>
<tr>
<th>名称</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>NOW()</td>
<td>当前日期和时间</td>
</tr>
<tr>
<td>CURDATE()</td>
<td>当前日期</td>
</tr>
<tr>
<td>CURTIME()</td>
<td>当前时间</td>
</tr>
<tr>
<td>DATE_ADD()</td>
<td>日期变化</td>
</tr>
<tr>
<td>DATEDIFF()</td>
<td>日期差值</td>
</tr>
<tr>
<td>DATE_FORMATE()</td>
<td>日期格式化</td>
</tr>
</tbody>
</table>
<h3 id="NOW-CURDATE-CURTIME"><a href="#NOW-CURDATE-CURTIME" class="headerlink" title="NOW/CURDATE/CURTIME"></a>NOW/CURDATE/CURTIME</h3><p>可以把 NOW 看作是 CURDATE 和 CURTIME 的综合</p>
<h3 id="DATE-ADD"><a href="#DATE-ADD" class="headerlink" title="DATE_ADD"></a>DATE_ADD</h3><p>实现日志的增减，加为正数，减为负数</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SELECT DATE_ADD(CURDATE(),INTERVAL 3 WEEK);</span><br></pre></td></tr></table></figure>
<p>WEEK,也可以是 DAY，YEAR<br>与之相对的还有一个 DATE_SUB 函数。</p>
<h3 id="DATEDIFF"><a href="#DATEDIFF" class="headerlink" title="DATEDIFF"></a>DATEDIFF</h3><p>获取两个日期之间的差值，左边减去右边，值为天数。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SELECT DATEDIFF(&apos;2014-10-11&apos;,&apos;2014-09-06&apos;);</span><br></pre></td></tr></table></figure>
<h3 id="DATE-FORMAT"><a href="#DATE-FORMAT" class="headerlink" title="DATE_FORMAT()"></a>DATE_FORMAT()</h3><p>日期格式化为其他形式，比如：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SELECT DATE_FORMAT(&apos;2014-11-01&apos;,&apos;%m/%d/%Y&apos;);</span><br></pre></td></tr></table></figure>
<p>结果为：<br>11/01/2014<br>如果是小写的 y，则格式化为 11/01/14</p>
<h1 id="信息函数"><a href="#信息函数" class="headerlink" title="信息函数"></a>信息函数</h1><table>
<thead>
<tr>
<th>名称</th>
<th>函数</th>
</tr>
</thead>
<tbody>
<tr>
<td>CONNECTIOIN_ID</td>
<td>连接 ID</td>
</tr>
<tr>
<td>DATABASE</td>
<td>当前数据库</td>
</tr>
<tr>
<td>LAST_INSERT_ID</td>
<td>最后插入记录 ID</td>
</tr>
<tr>
<td>USER</td>
<td>当前用户</td>
</tr>
<tr>
<td>VERSION</td>
<td>版本信息</td>
</tr>
</tbody>
</table>
<h3 id="CONNECTION-ID"><a href="#CONNECTION-ID" class="headerlink" title="CONNECTION_ID"></a>CONNECTION_ID</h3><p>第一连接就是 1，以此类推。</p>
<h3 id="DATABASE"><a href="#DATABASE" class="headerlink" title="DATABASE"></a>DATABASE</h3><h3 id="LAST-INSERT-ID"><a href="#LAST-INSERT-ID" class="headerlink" title="LAST_INSERT_ID"></a>LAST_INSERT_ID</h3><p>当一条语句插入多条记录的时候，它只返回第一条记录的 ID。</p>
<h3 id="USER"><a href="#USER" class="headerlink" title="USER"></a>USER</h3><p>返回当前用户。MYSQL 中的用户的完整用户名是 <strong>用户名@登录主机</strong></p>
<h3 id="VERSION"><a href="#VERSION" class="headerlink" title="VERSION"></a>VERSION</h3><p>MySQL 版本号</p>
<h1 id="聚合函数"><a href="#聚合函数" class="headerlink" title="聚合函数"></a>聚合函数</h1><table>
<thead>
<tr>
<th>名称</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>AVG</td>
<td>平均值</td>
</tr>
<tr>
<td>COUNT</td>
<td>计数</td>
</tr>
<tr>
<td>MAX</td>
<td>最大值</td>
</tr>
<tr>
<td>MIN</td>
<td>最小值</td>
</tr>
<tr>
<td>SUM</td>
<td>求和</td>
</tr>
</tbody>
</table>
<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><ul>
<li>聚合函数只有一个返回值！</li>
<li>不能直接用 SELECT 加函数名的形式来调用，必须针对字段！</li>
<li>优先级<ul>
<li>聚合函数优先级小于 WHERE 语句，不能用来 WHERE 后面。</li>
<li>聚合函数优先级大于 HAVING，可以用在 HAVING 后面。</li>
</ul>
</li>
</ul>
<h2 id="COUNT"><a href="#COUNT" class="headerlink" title="COUNT"></a>COUNT</h2><ul>
<li>COUNT(*)统计 null</li>
<li>COUNT(字段)不统计 null</li>
<li>COUNT(1)可统计</li>
</ul>
<h1 id="自定义函数"><a href="#自定义函数" class="headerlink" title="自定义函数"></a>自定义函数</h1><p>UDF(User-defined function)</p>
<h2 id="创建自定义函数"><a href="#创建自定义函数" class="headerlink" title="创建自定义函数"></a>创建自定义函数</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CREATE FUCNTION function_name</span><br><span class="line">RETURNS</span><br><span class="line">&#123;STRING|INTEGER|REAL|DECIMAL&#125;</span><br><span class="line">RETURN</span><br><span class="line">routine_body</span><br></pre></td></tr></table></figure>
<h2 id="函数体"><a href="#函数体" class="headerlink" title="函数体"></a>函数体</h2><p>上面的 routine_body 指代函数体。其构成：</p>
<ul>
<li>函数体由合法的 SQL 语句构成</li>
<li>函数体可以是简单的 SELECT 或 INSERT 语句</li>
<li>函数体如果为符合结构则使用 BEGIN…END 语句</li>
<li>符合结构可以包含声明，循环，控制结构</li>
</ul>
<h2 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h2><p><code>来源慕课网</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- 无参数</span><br><span class="line">CREATE function f()</span><br><span class="line">RETURNS VARCHAR(30)</span><br><span class="line">  RETURN Date_format(Now(), &apos;%Y年%m月%d日 %H点：%i分：%s秒&apos;);</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- 带参数</span><br><span class="line">CREATE function f2(num1 SMALLINT UNSIGNED,</span><br><span class="line">                   num2 SMALLINT UNSIGNED)</span><br><span class="line">RETURNS FLOAT(10, 2) UNSIGNED</span><br><span class="line">  RETURN ( num1 + num2 ) / 2;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--  复合结构的函数体</span></span><br><span class="line">DELIMITER //</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">function</span></span><br><span class="line">  adduser(username <span class="built_in">VARCHAR</span>(<span class="number">20</span>)) <span class="keyword">returns</span> <span class="built_in">INT</span> <span class="keyword">UNSIGNED</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">INSERT</span> <span class="keyword">test</span></span><br><span class="line">         (</span><br><span class="line">                username</span><br><span class="line">         )</span><br><span class="line">         <span class="keyword">VALUES</span></span><br><span class="line">         (</span><br><span class="line">                username</span><br><span class="line">         );</span><br><span class="line"></span><br><span class="line">  RETURN Last_insert_id();</span><br><span class="line"><span class="keyword">END</span>//</span><br></pre></td></tr></table></figure>
<p>三个要点：</p>
<ul>
<li>首先因为函数体内有分号，所以我们要修改定界符，避免函数中途停止。使用 DELIMITER 指定新的定界符为//。</li>
<li>然后，因为函数体内有多条 SQL 语句，所以我们要用 BEGIN…END 包裹。</li>
<li>RETURN 在 BEGIN…END 结构内部。并且必须有 RETURN。默认情况下，RETURN 后面的语句会在屏幕上打印出来。</li>
</ul>
<h2 id="删除函数"><a href="#删除函数" class="headerlink" title="删除函数"></a>删除函数</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">DROP FUCNTION [IF EXISTS] function_name;</span><br></pre></td></tr></table></figure>
<p>一次只能删除一个函数。</p>
<h1 id="加密函数"><a href="#加密函数" class="headerlink" title="加密函数"></a>加密函数</h1><table>
<thead>
<tr>
<th>名称</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>MD5</td>
<td>信息摘要算法</td>
</tr>
<tr>
<td>PASSWORD</td>
<td>密码算法</td>
</tr>
</tbody>
</table>
<p>用于 WEB 页面用 MD5 算法保存用户密码<br>用户本地用户，用 PASSWORD 修改密码。比如</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> <span class="keyword">user</span> <span class="keyword">SET</span> <span class="keyword">Password</span>=<span class="keyword">PASSWORD</span>(<span class="string">'newpassword'</span>) <span class="keyword">where</span> <span class="keyword">USER</span>=<span class="string">'root'</span>;</span><br></pre></td></tr></table></figure>
<p>注意 user 表在系统数据库 mysql 下。执行命令之前请<code>USE mysql</code>。</p>

      </div>
    </div>
    
    <!-- <div class="follow-wechat"><img src="/blogimgs/follow.jpg"></div> -->

<div class="copyright" itemscope itemtype="http://schema.org/ProfilePage" tabindex="0" aria-hidden="true">
	<!-- <a href="/about/#support" class="supportme">赏</a> -->
	<ul>
		<li>作者:  <a href="/about/" itemprop="name">尼采般地抒情</a></li>
		<li>发表日期:  2020-09-23 22:01:00</li>
		<li>文章分类: 
	<a class="category-link" href="/blog/categories/Language/">Language</a>

</li>
		<li>文章标签: </li>
		
		<!-- <li>本文 Markdown 地址: <a href="/raw/posts/sbxidb.md" download target="_blank">数据库中的函数.md</a></li> -->
		<li>版权声明: 署名-非商业性使用-禁止演绎 3.0 国际（<a href="https://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh" target="_blank">CC BY-NC-ND 3.0</a>）</li>
		<li>最后编辑时间: 2020-11-07 14:40:42</li>
		<li>Feed 订阅: <a href="/rss2.xml"><i class="icon">&#x25c8;</i></a></li>
		<li style="opacity: 0.3; text-align: right;">
			编辑本文：<a href="https://github.com/barretlee/blog/edit/master/blog/src/_posts/2020-09-23-blog/sbxidb.md" target="_blank" aria-hidden="true"><i class="icon">&#xe622;</i></a>；
			新建文章：<a href="https://github.com/barretlee/blog/new/master/blog/src/_posts" target="_blank" aria-hidden="true"><i class="icon">&#xe616;</i></a>
		</li>
	</ul>
	<a href="/about/"><img src="https://cdn.jsdelivr.net/gh/wztlink1013/cdn-pictures@1.0.1/avatar/gif/avatar_Jitter.gif" /></a>
</div>

    <!-- TODO:  导航表头中的下拉菜单栏-->
<em  class="arrow-expend" tabindex="0" aria-hidden="0" aria-label="点击展开网页导航" aria-selected="true" aria-lable="网页导航" aria-expanded="false" id="i1">▾
<ul role="group" aria-labelledby="i1" aria-expanded="false">
  <!-- TODO: entry_blog -->
  <li><a href="/blog/">博客</a></li>
  <li><a href="/translation/">翻译</a></li>
  <li><a href="/message/">留言</a></li>
  <li><a href="/demo/">实验室</a></li>
  <!-- <a><a href="/comments/">最近评论</a></li> -->
  <li><a href="/friends/">友情链接</a></li>
</ul>
</em>
  </div>
  <div class="post-relative">
<div class="page-relative">
  
    <a href="/blog/frgbbo/" class="post-prev">
      <i class="icon" tabindex="0" aria-hidden="true">&#x261c;</i>
      <span class="aria-readonly">上一篇文章</span>
      
        <b>权限管理</b>
      
    </a>
  
  
    <a href="/blog/tr2ahg/" class="post-next">
      <span class="aria-readonly">下一篇文章</span>
      <b>索引</b>
      <i class="icon" tabindex="0" aria-hidden="true">&#xe602;</i>
    </a>
  
</div>


<div class="page-relative-fixed" tabindex="0" aria-hidden="true">
  
  <a href="/blog/frgbbo/" class="prev" title="权限管理">
    <i class="icon">&#xe600;</i>
    
    <b>权限管理</b>
    
  </a>
  
  
  <a href="/blog/tr2ahg/" class="next" title="索引">
    <i class="icon">&#x261e;</i>
    <b>索引</b>
  </a>
  
</div>
</div>
</div>
<!-- TODO: 文章内部左隐藏侧边栏 -->
<div class="sidebar" tabindex="0" aria-hidden="true">
	<div class="func-btns func-btns-up">
    <span class="func-item">
        <i class="func-nav icon">&#xe618;<span>目录</span></i>
        <div>
          <i class="left-arrow"></i><i class="left-arrow-clone"></i>
          <a href="javascript:void(0);" onclick="return false;">显示目录</a>
        </div>
    </span>
    <span class="func-item">
        <i class="func-font icon">&#xe604;<span>夜间</span></i>
        <div class="font-choose-box">
          <i class="left-arrow"></i><i class="left-arrow-clone"></i>
          <div class="font-choose bg-choose">
            <a href="javascript:void(0)" onclick="return false;" class="bg-type bg-type-sun font-type-song"><i class="icon">&#xe61a;</i></a>
            <a href="javascript:void(0)" onclick="return false;" class="bg-type bg-type-moon font-type-hei"><i class="icon">&#xe619;</i></a>
          </div>
          <!-- <div class="font-choose">
            <a href="javascript:void(0)" onclick="return false;" class="font-type font-type-song">黑体</a>
            <a href="javascript:void(0)" onclick="return false;" class="font-type font-type-hei">宋体</a>
          </div> -->
        </div>
    </span>
    <span class="func-item">
        <a href="https://weibo.com/5341970683" target="_blank"><i class="func-fb icon">博<span>分享</span></i></a>
        <div><i class="left-arrow"></i><i class="left-arrow-clone"></i>
          <p class="seperator sharecanvas"><a href="javascript: void(0);">微博分享</a></p>
          <p><a href="https://weibo.com/5341970683" target="_blank">微博关注</a></p>
        </div>
    </span>
    <span class="func-item">
        <i class="func-about icon">&#x263b;<span>关于</span></i>
        <div>
          <i class="left-arrow"></i><i class="left-arrow-clone"></i>
          <p><a href="/about/" class="func-about-link" target="_blank">关于作者</a></p>
          <div id="followMeOnWeibo"></div>
        </div>
    </span>
	</div>
	<div class="func-btns">
    <span class="func-item">
        <a href="http://demo.barretlee.com" target="_blank"><i class="func-rss icon">&#xe603;<span>实验</span></i></a>
        <div><i class="left-arrow"></i><i class="left-arrow-clone"></i>
          <p class="seperator"><a href="http://demo.barretlee.com" target="_blank">Demo平台</a></p>
          <p class="seperator"><a href="http://md.barretlee.com" target="_blank">WX格式</a></p>
          <p><a href="http://snippets.barretlee.com" target="_blank">Snippet应用</a></p>
        </div>
    </span>
    <!-- <span class="func-item">
        <i class="func-fb icon">&#x2121;<span>留言</span></i>
        <div><i class="left-arrow"></i><i class="left-arrow-clone"></i>
          <p class="seperator"><a href="/message/" target="_blank">给我留言</a></p>
          <p><a href="/comments/" target="_blank">近期留言</a></p>
        </div>
    </span> -->
    <span class="func-item">
        <a href="/friends/" target="_blank"><i class="func-rss icon">&#xe601;<span>链接</span></i></a>
        <div><i class="left-arrow"></i><i class="left-arrow-clone"></i>
          <a href="/friends/" target="_blank">友情链接</a>
        </div>
    </span>
    <span class="func-item">
        <a href="/rss2.xml" target="_blank"><i class="func-rss icon">&#x25c8;<span>订阅</span></i></a>
        <div><i class="left-arrow"></i><i class="left-arrow-clone"></i><a href="/rss2.xml" target="_blank">订阅我吧！</a></div>
    </span>
	</div>
</div>

<div class="single-page-footer">
<!-- TODO: 页脚评论+站点信息 -->
<div class="footer">
	<div class="footer-wraper">
		<div class="footer-content">
			<div class="footer-nav">
	<a href="javascript: void(0);" class="ds-thread-count disqus-comment-count"
	   data-thread-key="blog/sbxidb"
	   data-disqus-identifier="blog/sbxidb" 
		 tabindex="0" aria-hidden="true">评论内容</a>
	<a href="javascript: void(0);" id="comments">相关文章</a>
	<a href="/friends/" tabindex="0" aria-hidden="true">友情链接</a>
</div>
<div class="nav-detail">
	<div tabindex="0">
		<!-- TODO:  任何页面下的评论留言系统-->

  <!-- <section id="comments">
    <style>
      .utterances{
        max-width: 100%;
        }
    </style>
    <script src="https://utteranc.es/client.js"
          repo="wztlink1013/comment"
          issue-term="title"
          label="💬comment"
          theme="github-light"
          crossorigin="anonymous"
          async>
    </script>
  </section> -->

  <!-- <div id="gitalk" sid="blog/sbxidb"></div> -->
  <!-- <script charset="utf-8" type="text/javascript" src="/public/js/gitalk.js"></script> -->
  <!-- TODO: utteranc评论：基于github issue的评论系统 -->
  <style>
    .utterances{
      max-width: 100%;
      }
  </style>
  <script src="https://utteranc.es/client.js"
        repo="wztlink1013/comment"
        issue-term="title"
        label="💬comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
  </script>
  <!-- TODO: utteranc评论 -->
  <!-- <script type="text/javascript">
  var postContent = document.querySelectorAll('.post-content>p');
  if (postContent && postContent.length) {
    postContent = postContent.item(0).textContent + postContent.item(1).textContent;
    postContent = postContent.length > 140 ? postContent.slice(0, 140) + '...' : postContent;
  }

  var gitalk = new Gitalk({
    clientID: 'f2c1964e018d7d117141',
    clientSecret: '955d647b2198c347af06933263d0ff5e5d276bc6',
    language: "zh-CN",
    perPage: 10,
    createIssueManually: false,
    repo: 'comment',
    owner: 'wztlink1013',
    admin: ['wztlink1013'],
    id: "blog/sbxidb",
    body: '原文地址：' + location.href + '\n\n文摘：' + postContent || header.meta[description],
    distractionFreeMode: false
  });

  window.addEventListener('load', function() {
    setTimeout(function() {
      gitalk.render('gitalk');
    }, 2E3);
  });

  // show count
  var commentTimer = setInterval(() => {
    var count = document.querySelector('.gt-link-counts');
    var showCount = document.querySelector('.hash-to-comments');
    if (count && showCount) {
      showCount.textContent = count.textContent;
      clearInterval(commentTimer);
    }
  }, 500);
  setTimeout(() => {
    clearInterval(commentTimer);
  }, 60 * 1E3);
  </script> -->
  
	</div>
	<div style="display:block;">
		<div class="relative-to-comment" tabindex="0" aria-hidden="true"><span>打开评论</span></div>
		<div class="relative-wrapper">
	<div class="relative-article">
		
		<ul>
			<li>
				<span><font aria-hidden="true">2020-10-22 »</font> </span>
				<a href="/blog/zeszpb/">C++随机字符串生成函数</a>
				<span class="aria-readonly">发表时间为2020年10月22日</span>
				<div class="relative-box">
          
          <span class="aria-readonly">文章概要 </span>//C++ 随机字符串生成函数#include&lt;iostream&gt;#include&lt...
        </div>
			</li>
			
			<li>
				<span><font aria-hidden="true">2020-10-22 »</font> </span>
				<a href="/blog/xm1a2g/">JAVA-正则表达式</a>
				<span class="aria-readonly">发表时间为2020年10月22日</span>
				<div class="relative-box">
          
          <span class="aria-readonly">文章概要 </span>...
        </div>
			</li>
			
			<li>
				<span><font aria-hidden="true">2020-10-15 »</font> </span>
				<a href="/blog/yoi6sh/">BOM（浏览器对象模型）</a>
				<span class="aria-readonly">发表时间为2020年10月15日</span>
				<div class="relative-box">
          
          <span class="aria-readonly">文章概要 </span>BOM（浏览器对象模型）BOM 作用对象就是浏览器，从这一方面来说，DOM 也是 BOM 的属性之一...
        </div>
			</li>
			
			<li>
				<span><font aria-hidden="true">2020-10-15 »</font> </span>
				<a href="/blog/fkgmui/">DOM（文档对象模型）</a>
				<span class="aria-readonly">发表时间为2020年10月15日</span>
				<div class="relative-box">
          <a href="/blog/fkgmui/" class="relative-img-wrapper"><img src="https://cdn.nlark.com/yuque/0/2020/png/1484158/1598689552517-1346b948-8d7e-49f9-b450-fdbbcee61c73.png#align=left&amp;display=inline&amp;height=247&amp;margin=%5Bobject%20Object%5D&amp;originHeight=334&amp;originWidth=950&amp;size=0&amp;status=done&amp;style=shadow&amp;width=703" style="width:100%" data-original="https://cdn.nlark.com/yuque/0/2020/png/1484158/1598689552517-1346b948-8d7e-49f9-b450-fdbbcee61c73.png#align=left&amp;display=inline&amp;height=247&amp;margin=%5Bobject%20Object%5D&amp;originHeight=334&amp;originWidth=950&amp;size=0&amp;status=done&amp;style=shadow&amp;width=703"/></a>
          <span class="aria-readonly">文章概要 </span>DOM（文档对象模型）查找 HTML 元素通过 id、标签名、类名来查找document.getEl...
        </div>
			</li>
			
		</ul>
	</div>
</div>

		<!-- TODO: entry_blog -->
		<a href="/blog/" class="relative-to-comment-wrapper" tabindex="0" aria-hidden="true"><div class="relative-to-comment">回到首页</div></a>
	</div>
	<div class="friends-box">
		<ul>
			
			<li><a href="http://hustskyking.cnblogs.com" target="_blank">旧博客</a> <font aria-hidden="true">»</font> <span>我的旧博客（博客园荣誉博客）</span></li>
			
			<li><a href="http://www.zhangmengxue.com" target="_blank">大额</a> <font aria-hidden="true">»</font> <span>大额大额哼歌等日落</span></li>
			
			<li><a href="http://www.zhangxinxu.com" target="_blank">张鑫旭</a> <font aria-hidden="true">»</font> <span>原来大学我俩一个团队的~</span></li>
			
			<li><a href="http://web-tinker.com" target="_blank">次碳酸钴</a> <font aria-hidden="true">»</font> <span>深度交流的一个好朋友</span></li>
			
			<li><a href="http://imququ.com" target="_blank">屈屈</a> <font aria-hidden="true">»</font> <span>好吧，蛐蛐同学</span></li>
			
			<li><a href="http://www.ruanyifeng.com" target="_blank">阮一峰</a> <font aria-hidden="true">»</font> <span>阮老师,哈哈,第一次设计博客就是抄的你的样式</span></li>
			
			<li><a href="http://annn.me" target="_blank">安记</a> <font aria-hidden="true">»</font> <span>阿安同学</span></li>
			
			<li><a href="http://mouto.org/" target="_blank">卜卜口</a> <font aria-hidden="true">»</font> <span>二次元化身</span></li>
			
			<li><a href="/friends/">更多列表 <font aria-hidden="true">»</font></a></li>
		</ul>
	</div>
</div>
			<!-- TODO:  网站信息：网站最底下的信息-->

<div class="website-info" aria-hidden="true">
	<a class="page_editor" href="/admin/#/posts/ckh7c63vk006as8ujflu5wdrx" target="_blank">🧙‍♂️</a>
	<span>&copy;2019-2020 <small><a href="http://www.miitbeian.gov.cn/" about="_blank">赣ICP备20002826号-1</a></small></span>
	本站 <a href="/">尼采般地抒情</a> <a href="/about#contact">联系方式</a> | 总热度：<em id="busuanzi_value_site_pv"></em>
	<a href='https://union.zhaodao.ai/#random' title="随机跳转到一个有意思的网站" target='_blank' class="zhidao_ai"><img src='https://union.zhaodao.ai/icon.black.svg' width="20" height="20"></a>
</div>

		</div>
	</div>
</div>
</div>
<div class="tools-wrapper" tabindex="0" aria-hidden="true">
	<a class="gotop icon" href="#" title="回到顶部">&#x2191;</a>
	<!-- <a class="wechart icon">&#xe60d;<span><img src="/blogimgs/wechart.png" title="扫码添加小胡子哥微信"/> </span></a> -->
	<a class="hash-to-comments icon" title="我要评论">&#x2121;</a>
</div>
<div class="fixerr" tabindex="0" aria-hidden="true">纠错模式</div>

</body>
<!-- TODO: 导入脚本 -->
<script src="/public/js/jquery.js"></script>
<script src="/public/js/socket.io.js"></script>
<script>
  window.onerror = function(e) {
    window.console && window.console.log && window.console.log(e);
    $('#loadLayer').remove();
    return true;
  };
</script>
<script src="/public/js/aplayer.js"></script>
<script src="/public/js/main.js?v=20191101"></script>
</script>
</html>
