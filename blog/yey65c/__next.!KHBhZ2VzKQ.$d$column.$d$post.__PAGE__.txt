1:"$Sreact.fragment"
2:I[99897,["/_next/static/chunks/4eaa70fe861e9598.js","/_next/static/chunks/946bdd2e6c9b7c49.js","/_next/static/chunks/6dd6809ee42e252f.js","/_next/static/chunks/f2b800ca7ae14e96.js","/_next/static/chunks/e121db38c98deeb4.js","/_next/static/chunks/0973dd923ca2781d.js","/_next/static/chunks/b397c2fd2abb1207.js","/_next/static/chunks/11dff99839ab5ba0.js"],"MotionPreset"]
3:I[22016,["/_next/static/chunks/4eaa70fe861e9598.js","/_next/static/chunks/946bdd2e6c9b7c49.js","/_next/static/chunks/6dd6809ee42e252f.js","/_next/static/chunks/f2b800ca7ae14e96.js","/_next/static/chunks/e121db38c98deeb4.js","/_next/static/chunks/0973dd923ca2781d.js","/_next/static/chunks/b397c2fd2abb1207.js","/_next/static/chunks/11dff99839ab5ba0.js"],""]
4:I[85437,["/_next/static/chunks/4eaa70fe861e9598.js","/_next/static/chunks/946bdd2e6c9b7c49.js","/_next/static/chunks/6dd6809ee42e252f.js","/_next/static/chunks/f2b800ca7ae14e96.js","/_next/static/chunks/e121db38c98deeb4.js","/_next/static/chunks/0973dd923ca2781d.js","/_next/static/chunks/b397c2fd2abb1207.js","/_next/static/chunks/11dff99839ab5ba0.js"],"Image"]
5:I[48347,["/_next/static/chunks/4eaa70fe861e9598.js","/_next/static/chunks/946bdd2e6c9b7c49.js","/_next/static/chunks/6dd6809ee42e252f.js","/_next/static/chunks/f2b800ca7ae14e96.js","/_next/static/chunks/e121db38c98deeb4.js","/_next/static/chunks/0973dd923ca2781d.js","/_next/static/chunks/b397c2fd2abb1207.js","/_next/static/chunks/11dff99839ab5ba0.js"],"default"]
6:I[72436,["/_next/static/chunks/4eaa70fe861e9598.js","/_next/static/chunks/946bdd2e6c9b7c49.js","/_next/static/chunks/6dd6809ee42e252f.js","/_next/static/chunks/f2b800ca7ae14e96.js","/_next/static/chunks/e121db38c98deeb4.js","/_next/static/chunks/0973dd923ca2781d.js","/_next/static/chunks/b397c2fd2abb1207.js","/_next/static/chunks/11dff99839ab5ba0.js"],"Separator"]
d:I[97367,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/7340adf74ff47ec0.js"],"OutletBoundary"]
e:"$Sreact.suspense"
7:T2ddc,<!doctype html><div class="lake-content" typography="classic"><p id="u33c6bba4" class="ne-p"><span class="ne-text">前言：本文记录一下Serverless技术及其云函数计算FC的应用，以及API网关技术。本文从以下三方面详细展开：</span></p><ol class="ne-ol"><li id="u857b79b5"><span class="ne-text">先介绍Serverless的核心函数计算FC，并用其来迁移express web项目，也就是实实在在的写一个后端接口。</span></li><li id="u949b0e44"><span class="ne-text">开发过程中，如果是小功能项目直接再阿里云函数计算控制台编写代码即可，但如果是较大项目，本地开发的代码编写、调试、部署等功能就很重要了，介绍Serverless Devs Cli的使用。</span></li><li id="uadf4ad22"><span class="ne-text">最后是对API的系统化管理，比如说签名访问，提高安全性。阿里云的API网关技术，利用其完善的API的创建、测试、发布等功能，来模拟企业化开发流程。</span></li></ol><p id="u142c127a" class="ne-p"><span class="ne-text"></span></p><p id="u4b7659de" class="ne-p"><span class="ne-text"></span></p><p id="u76009ae1" class="ne-p"><span class="ne-text">前言：阿里云函数计算，与此对应的还有腾讯云函数计算，两者我都使用过，也做过demo，个人而言，腾讯云的函数计算的确操作及代码的编写简单于阿里云函数计算，具体有这么几个方面：</span></p><ul class="ne-ul"><li id="u07d15c90"><span class="ne-text">如果需要将之前的写好的一些项目代码迁移到里云函数计算中（例如express Web项目），需要改一些代码，比如对阿里云的入口函数handler进行封装，不过这个问题官方团队给出了解决代码。</span></li><li id="u5baafbfc"><span class="ne-text">文档的内容和编排不是那么详细，网络上其实对函数计算的教程类指导文章其实很少，对阿里云函数计算的更少，所以官方文档还是很重要的。</span></li><li id="udede6395"><span class="ne-text">计算函数社区模板，腾讯云应该是优于阿里云函数计算的。</span></li></ul><p id="ucc29651b" class="ne-p"><span class="ne-text"></span></p><p id="u1366782e" class="ne-p"><span class="ne-text">尽管相较腾讯云函数计算而言，阿里云操作稍微复杂，但我还是选择阿里云函数计算，一个是性能，另一个就是征服欲……</span><img src="https://cdn.nlark.com/yuque/0/2022/jpeg/1484158/1642990978768-d60330ad-e0dd-4234-bff1-92bd2df0d596.jpeg" width="52" id="GSie5" class="ne-image"></p><h3 id="cK83W"><span class="ne-text">简单写一个后端接口API</span></h3><p id="u37d56d66" class="ne-p"><span class="ne-text" style="background-color: #FADB14">文档/教程参考：</span></p><ul class="ne-ul"><li id="uee946aab"><a href="https://help.aliyun.com/product/50980.html" data-href="https://help.aliyun.com/product/50980.html" target="_blank" class="ne-link"><span class="ne-text">阿里云函数计算官方文档：函数计算</span></a></li><li id="uadaa8a44"><span class="ne-text">代码开发文档：</span><a href="https://help.aliyun.com/document_detail/74754.html" data-href="https://help.aliyun.com/document_detail/74754.html" target="_blank" class="ne-link"><span class="ne-text">https://help.aliyun.com/document_detail/74754.html</span></a></li><li id="u73badd09"><span class="ne-text">阿里云函数计算内置模块：</span><a href="https://help.aliyun.com/document_detail/58011.html#title-rp4-xhl-ri3" data-href="https://help.aliyun.com/document_detail/58011.html#title-rp4-xhl-ri3" target="_blank" class="ne-link"><span class="ne-text">https://help.aliyun.com/document_detail/58011.html#title-rp4-xhl-ri3</span></a></li></ul><p id="u0451c906" class="ne-p"><span class="ne-text">函数计算除了可以直接使用Node.js的内置模块，还可以使用阿里云里面封装好的一些模块。</span></p><ul class="ne-ul"><li id="ue4174d81"><a href="https://www.zhihu.com/question/506704568/answer/2275420449" data-href="https://www.zhihu.com/question/506704568/answer/2275420449" target="_blank" class="ne-link"><span class="ne-text">如何评价无服务器计算（serverless）的未来前景？你认为 serverless 有未来吗？</span></a></li></ul><p id="ud2ff72e6" class="ne-p"><span class="ne-text"></span></p><p id="u65b3659f" class="ne-p"><span class="ne-text" style="background-color: #FADB14">测试url：</span></p><ul class="ne-ul"><li id="u8e54bf03"><span class="ne-text"></span><a href="https://yunfunc.wztlink1013.com/simple-api" data-href="https://yunfunc.wztlink1013.com/simple-api" target="_blank" class="ne-link"><span class="ne-text">https://yunfunc.wztlink1013.com/simple-api</span></a></li></ul><h4 id="H1TyB"><span class="ne-text">阿里云函数计算的一些注意事项</span></h4><ul class="ne-ul"><li id="u2390a977"><a href="https://www.kancloud.cn/duolabmeng/duolablog/1533791" data-href="https://www.kancloud.cn/duolabmeng/duolablog/1533791" target="_blank" class="ne-link"><span class="ne-text">阿里云-函数计算从入门到放弃</span></a></li></ul><ul class="ne-ul"><li id="u2acafd43"><span class="ne-text">自定义模块就意味着自己之前写的代码不能维护，要改成他这样的内置代码使用</span></li></ul><h4 id="WgAZY"><span class="ne-text">initializer初始化函数</span></h4><p id="u6f87af38" class="ne-p"><img src="https://cdn.nlark.com/yuque/0/2022/png/1484158/1642908927273-fec0f794-3326-414d-b10c-cd423d3dd8af.png" width="433" id="ubeed9d07" class="ne-image"></p><pre data-language="javascript" id="RjzAS" class="ne-codeblock language-javascript">// 初始化函数
exports.context_initializer = {} // 便于打印展示
exports.initializer = (context, callback) =&gt; {
	console.log('初始化函数 -------------');
	context_initializer = context
	callback(null, '');
};</pre><h4 id="HEkOW"><span class="ne-text">handler入口函数</span></h4><pre data-language="javascript" id="GS8A1" class="ne-codeblock language-javascript">// 入口函数
exports.handler = (req, resp, context) =&gt; {
    console.log('入口函数 -------------');
    let params = {
        // path: req.path,
        // queries: req.queries,
        // headers: req.headers,
        // method : req.method,
        // requestURI : req.url,
        // clientIP : req.clientIP,
        request_info: req,
        context_handler: context,
        context_initializer: context_initializer
    }

    // 处理响应
    getRawBody(req, function(err, body) {
        for (let key in req.queries) {
          let value = req.queries[key];
          resp.setHeader(key, value);
        }
        resp.setHeader(&quot;Content-Type&quot;, &quot;text/plain&quot;);
        params.request_body = body.toString();
        resp.send(JSON.stringify(params, null, '    '));
    }); 
      
    /*
    getFormBody(req, function(err, formBody) {
        for (let key in req.queries) {
          let value = req.queries[key];
          resp.setHeader(key, value);
        }
        params.body = formBody;
        console.log(formBody);
        resp.send(JSON.stringify(params));
    }); 
    */
}</pre><h3 id="w0qTq"><span class="ne-text">移植Express Web应用</span></h3><p id="ued3f233c" class="ne-p"><span class="ne-text">由于阿里云计算函数内置的一些框架（比如指定的入口、初始化函数等），所以在写express相关代码的时候不能像是本地使用一样，需要对其进行一些封装改造，特别是函数计算当中的入口函数handler，它的请求与响应需要封装一下。具体的封装方案，是参考的官方团队所写的教程：</span><a href="https://developer.aliyun.com/article/703317" data-href="https://developer.aliyun.com/article/703317" target="_blank" class="ne-link"><span class="ne-text">移植 express.js 应用到函数计算</span></a></p><p id="u29ffc216" class="ne-p"><span class="ne-text"></span></p><p id="u5d4746e6" class="ne-p"><span class="ne-text">其他的一些参考文章：</span></p><ul class="ne-ul"><li id="u005cbe72"><a href="https://blog.csdn.net/weixin_34004576/article/details/89700121" data-href="https://blog.csdn.net/weixin_34004576/article/details/89700121" target="_blank" class="ne-link"><span class="ne-text">express框架应用接入阿里云函数计算</span></a></li><li id="uc181e1be"><a href="https://developer.aliyun.com/article/703320" data-href="https://developer.aliyun.com/article/703320" target="_blank" class="ne-link"><span class="ne-text">开发函数计算的正确姿势——移植 Express</span></a></li></ul><p id="u4e17cb87" class="ne-p"><span class="ne-text"></span></p><h4 id="FZ6b1"><span class="ne-text">多个域名路径与路径的访问</span></h4><p id="u787419bd" class="ne-p"><span class="ne-text">Express应用里面添加多个路由，然而在测试函数里面可以正常访问，在自定义域名url不能访问。</span></p><p id="u6b7df83e" class="ne-p"><img src="https://cdn.nlark.com/yuque/0/2022/png/1484158/1642921933726-9ecb436a-ccd4-4f86-829a-05fe5ec65f76.png" width="1293" id="u61acac75" class="ne-image"></p><p id="u268883ac" class="ne-p"><span class="ne-text">改用泛解析</span><code class="ne-code"><span class="ne-text">/*</span></code><span class="ne-text">还是访问无效</span></p><p id="u3da63adc" class="ne-p"><img src="https://cdn.nlark.com/yuque/0/2022/png/1484158/1642916657197-e43c510e-c901-4b62-aabf-206b75683c71.png" width="530" id="u90445c3a" class="ne-image"></p><p id="ub7bb7c87" class="ne-p"><span class="ne-text">解决：因为这个Express应用我是用自定义域名的一个路径为其根目录，所以项目中的路由配置都需要加上自定义域名下的路径。</span></p><p id="ue708fb06" class="ne-p"><img src="https://cdn.nlark.com/yuque/0/2022/png/1484158/1642920228403-8369d2ba-5983-4581-b570-6eeee3555826.png" width="633" id="uf84b4416" class="ne-image"></p><h3 id="zyFic"><span class="ne-text">自定义域名</span></h3><div class="ne-quote"><p id="ue14eddd8" class="ne-p"><span class="ne-text">如果不自定义域名，则访问http触发的url是以下载文件的形式访问。</span></p></div><ul class="ne-ul"><li id="u102981b6"><a href="https://help.aliyun.com/document_detail/90763.html?spm=5176.fcnext.help.dexternal.a85778c8URjMtd" data-href="https://help.aliyun.com/document_detail/90763.html?spm=5176.fcnext.help.dexternal.a85778c8URjMtd" target="_blank" class="ne-link"><span class="ne-text">函数计算 &gt;高级功能 &gt;配置自定义域名 产品详情 配置自定义域名</span></a></li><li id="u11a0a674"><a href="https://blog.51cto.com/u_14031415/2306499" data-href="https://blog.51cto.com/u_14031415/2306499" target="_blank" class="ne-link"><span class="ne-text">函数计算搭建 Serverless Web 应用（二）- 自定义域名</span></a></li></ul><h3 id="y02bK"><span class="ne-text">自定义域名配置HTTPS</span></h3><ul class="ne-ul"><li id="ufbfef6b2"><a href="https://help.aliyun.com/document_detail/156645.html" data-href="https://help.aliyun.com/document_detail/156645.html" target="_blank" class="ne-link"><span class="ne-text">申请免费DV试用证书</span></a></li></ul><p id="u2f18854f" class="ne-p"><span class="ne-text">查看免费的SSL证书：</span></p><ul class="ne-ul"><li id="u8e319937"><a href="https://yundun.console.aliyun.com/?p=cas#/certExtend/free" data-href="https://yundun.console.aliyun.com/?p=cas#/certExtend/free" target="_blank" class="ne-link"><span class="ne-text">https://yundun.console.aliyun.com/?p=cas#/certExtend/free</span></a></li></ul><p id="ua9cc3222" class="ne-p"><a href="https://bluo.cn/" data-href="https://bluo.cn/" target="_blank" class="ne-link"></a></p></div>0:{"buildId":"IZGNs8L3bI3loAyUuinBD","rsc":["$","$1","c",{"children":[["$","section",null,{"className":"relative","children":["$","$L2",null,{"fade":true,"blur":true,"transition":{"duration":0.5},"delay":0.1,"className":"relative overflow-hidden border-y xl:flex","children":[["$","div",null,{"className":"m-6 w-full flex-1 bg-[radial-gradient(circle_at_center,color-mix(in_oklab,var(--primary)_15%,transparent)_2px,transparent_2px)] bg-size-[18px_18px] max-xl:hidden"}],["$","div",null,{"className":"mx-auto w-full max-w-6xl flex-none space-y-8 px-4 py-8 min-[1158px]:border-x sm:px-6 sm:py-12 lg:px-8","children":[["$","$L2",null,{"fade":true,"blur":true,"slide":{"direction":"down","offset":30},"transition":{"duration":0.4},"children":["$","$L3",null,{"href":"/blog","className":"text-muted-foreground hover:text-foreground inline-flex items-center gap-2 text-sm transition-colors","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-arrow-left h-4 w-4","aria-hidden":"true","children":[["$","path","1l729n",{"d":"m12 19-7-7 7-7"}],["$","path","x3x0zl",{"d":"M19 12H5"}],"$undefined"]}],"返回","技术博客"]}]}],["$","article",null,{"className":"mx-auto max-w-4xl","children":[["$","header",null,{"className":"mb-8 space-y-6","children":[["$","$L2",null,{"fade":true,"blur":true,"slide":{"direction":"up","offset":50},"delay":0.2,"transition":{"duration":0.6},"children":["$","div",null,{"className":"relative aspect-video overflow-hidden rounded-xl","children":["$","$L4",null,{"src":"https://cdn.nlark.com/yuque/0/2022/png/1484158/1642908927273-fec0f794-3326-414d-b10c-cd423d3dd8af.png","alt":"阿里云函数计算FC技术","fill":true,"className":"object-cover","unoptimized":true}]}]}],["$","$L2",null,{"delay":0.3,"transition":{"duration":0.5},"children":["$","h1",null,{"className":"text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl","children":["$","$L5",null,{"text":"阿里云函数计算FC技术","delay":30,"animateBy":"words","direction":"bottom"}]}]}],["$","$L2",null,{"fade":true,"blur":true,"slide":{"direction":"down","offset":30},"delay":0.4,"transition":{"duration":0.5},"children":["$","p",null,{"className":"text-muted-foreground text-lg","children":"前言：本文记录一下Serverless技术及其云函数计算FC的应用，以及API网关技术。本文从以下三方面详细展开：先介绍Serverless的核心函数计算FC，并用其来迁移express web项目，也就是实实在在的写一个后端接口。开发过程中，如果是小功能项目直接再阿里云函数计算控制台编写代码..."}]}],["$","$L2",null,{"fade":true,"blur":true,"slide":{"direction":"down","offset":30},"delay":0.5,"transition":{"duration":0.5},"children":["$","div",null,{"className":"text-muted-foreground flex flex-wrap items-center gap-4 text-sm","children":[["$","div",null,{"className":"flex items-center gap-1","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-calendar h-4 w-4","aria-hidden":"true","children":[["$","path","1cmpym",{"d":"M8 2v4"}],["$","path","4m81vk",{"d":"M16 2v4"}],["$","rect","1hopcy",{"width":"18","height":"18","x":"3","y":"4","rx":"2"}],["$","path","8toen8",{"d":"M3 10h18"}],"$undefined"]}],["$","span",null,{"children":"2022年1月23日"}]]}],["$","div",null,{"className":"flex items-center gap-1","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-clock h-4 w-4","aria-hidden":"true","children":[["$","path","mmk7yg",{"d":"M12 6v6l4 2"}],["$","circle","1mglay",{"cx":"12","cy":"12","r":"10"}],"$undefined"]}],["$","span",null,{"children":"1.3千字"}]]}],["$","div",null,{"className":"flex items-center gap-1","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-eye h-4 w-4","aria-hidden":"true","children":[["$","path","1nclc0",{"d":"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"}],["$","circle","1v7zrd",{"cx":"12","cy":"12","r":"3"}],"$undefined"]}],["$","span",null,{"children":[1," 阅读"]}]]}],false,false]}]}],false]}],["$","$L2",null,{"delay":0.6,"fade":true,"blur":true,"transition":{"duration":0.6},"className":"-mx-4 sm:-mx-6 lg:-mx-8","children":["$","$L6",null,{}]}],["$","$L2",null,{"fade":true,"blur":true,"slide":{"direction":"up","offset":50},"delay":0.7,"transition":{"duration":0.6},"children":["$","div",null,{"className":"prose prose-neutral dark:prose-invert mt-8 max-w-none","dangerouslySetInnerHTML":{"__html":"$7"}}]}],"$L8","$L9"]}]]}],"$La"]}]}],["$Lb"],"$Lc"]}],"loading":null,"isPartial":false}
8:["$","$L2",null,{"delay":0.8,"fade":true,"blur":true,"transition":{"duration":0.6},"className":"-mx-4 mt-12 sm:-mx-6 lg:-mx-8","children":["$","$L6",null,{}]}]
9:["$","$L2",null,{"fade":true,"blur":true,"slide":{"direction":"up","offset":30},"delay":0.9,"transition":{"duration":0.5},"children":["$","nav",null,{"className":"mt-8 grid gap-4 md:grid-cols-2","children":[["$","$L3",null,{"href":"/blog/pp1d2p","className":"hover:bg-muted group flex flex-col rounded-lg border p-4 transition-colors","children":[["$","span",null,{"className":"text-muted-foreground mb-2 text-sm","children":"上一篇"}],["$","span",null,{"className":"group-hover:text-primary line-clamp-2 font-medium transition-colors","children":"WebSocket学习笔记"}]]}],["$","$L3",null,{"href":"/blog/gxh14f","className":"hover:bg-muted group flex flex-col rounded-lg border p-4 text-right transition-colors md:text-right","children":[["$","span",null,{"className":"text-muted-foreground mb-2 text-sm","children":"下一篇"}],["$","span",null,{"className":"group-hover:text-primary line-clamp-2 font-medium transition-colors","children":"Nodejs基本使用和内置模块"}]]}]]}]}]
a:["$","div",null,{"className":"m-6 w-full flex-1 bg-[radial-gradient(circle_at_center,color-mix(in_oklab,var(--primary)_15%,transparent)_2px,transparent_2px)] bg-size-[18px_18px] max-xl:hidden"}]
b:["$","script","script-0",{"src":"/_next/static/chunks/11dff99839ab5ba0.js","async":true}]
c:["$","$Ld",null,{"children":["$","$e",null,{"name":"Next.MetadataOutlet","children":"$@f"}]}]
f:null
