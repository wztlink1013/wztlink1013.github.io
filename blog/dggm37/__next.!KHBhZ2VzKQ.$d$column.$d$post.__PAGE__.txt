1:"$Sreact.fragment"
2:I[99897,["/_next/static/chunks/4eaa70fe861e9598.js","/_next/static/chunks/fa1a8f8830b9bf3a.js","/_next/static/chunks/6dd6809ee42e252f.js","/_next/static/chunks/f2b800ca7ae14e96.js","/_next/static/chunks/e121db38c98deeb4.js","/_next/static/chunks/6d971f5a9c16d0c2.js","/_next/static/chunks/b397c2fd2abb1207.js","/_next/static/chunks/11dff99839ab5ba0.js"],"MotionPreset"]
3:I[22016,["/_next/static/chunks/4eaa70fe861e9598.js","/_next/static/chunks/fa1a8f8830b9bf3a.js","/_next/static/chunks/6dd6809ee42e252f.js","/_next/static/chunks/f2b800ca7ae14e96.js","/_next/static/chunks/e121db38c98deeb4.js","/_next/static/chunks/6d971f5a9c16d0c2.js","/_next/static/chunks/b397c2fd2abb1207.js","/_next/static/chunks/11dff99839ab5ba0.js"],""]
4:I[48347,["/_next/static/chunks/4eaa70fe861e9598.js","/_next/static/chunks/fa1a8f8830b9bf3a.js","/_next/static/chunks/6dd6809ee42e252f.js","/_next/static/chunks/f2b800ca7ae14e96.js","/_next/static/chunks/e121db38c98deeb4.js","/_next/static/chunks/6d971f5a9c16d0c2.js","/_next/static/chunks/b397c2fd2abb1207.js","/_next/static/chunks/11dff99839ab5ba0.js"],"default"]
5:I[72436,["/_next/static/chunks/4eaa70fe861e9598.js","/_next/static/chunks/fa1a8f8830b9bf3a.js","/_next/static/chunks/6dd6809ee42e252f.js","/_next/static/chunks/f2b800ca7ae14e96.js","/_next/static/chunks/e121db38c98deeb4.js","/_next/static/chunks/6d971f5a9c16d0c2.js","/_next/static/chunks/b397c2fd2abb1207.js","/_next/static/chunks/11dff99839ab5ba0.js"],"Separator"]
c:I[97367,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/7340adf74ff47ec0.js"],"OutletBoundary"]
d:"$Sreact.suspense"
6:T119a5,<!doctype html><div class="lake-content" typography="classic"><p id="97ef088b442e4d2142d29a2e13b8d1de" class="ne-p"><span class="ne-text">规整数据：连接、合并、重构、转换etc</span></p><h2 id="vEPCg"><span class="ne-text">三、数据规整-连接-含索引</span></h2><p id="a1bbb91372d002f331fde0656b4cc56a" class="ne-p"><br></p><ul class="ne-ul"><li id="442526d957c5fb17cab73e321b572dfa"><span class="ne-text">数据连接 merge</span></li></ul><p id="3ed571a27f671d77436a0e8c85505146" class="ne-p"><br></p><pre data-language="python" id="5b25766e-1" class="ne-codeblock language-python">import pandas as pd
import numpy as np</pre><p id="07952fd692f716395bf5e1b3cf8a0099" class="ne-p"><br></p><pre data-language="python" id="798a5134" class="ne-codeblock language-python">df_obj1 = pd.DataFrame({'key': ['b', 'b', 'a', 'c', 'a', 'a', 'b'],
                        'data1' : ['sfd','fdsf','we',24,3253,234,23]})
df_obj2 = pd.DataFrame({'key': ['a', 'b', 'd'],
                        'data2' : np.random.randint(0,10,3)})

print (df_obj1)
print (df_obj2)</pre><p id="5691e0ea0261fff8e49759f14021d6ea" class="ne-p"><br></p><pre data-language="plain" id="1eb01d28" class="ne-codeblock language-plain">  key data1
0   b   sfd
1   b  fdsf
2   a    we
3   c    24
4   a  3253
5   a   234
6   b    23
  key  data2
0   a      0
1   b      6
2   d      6</pre><p id="e09f6a427b8f74efffb99ae32ddb18a0" class="ne-p"><br></p><h3 id="d0056c72"><span class="ne-text">merge和on</span></h3><p id="f9dd2e2d0d23aae3cf45c7b972556467" class="ne-p"><br></p><div class="ne-quote"><p id="4a2557b15dbc0d2dd180f6cb2c1d6d02" class="ne-p"><span class="ne-text">默认将重叠列的列名作为“外键”进行连接</span></p></div><p id="3a2d6c142e690e074bda76238f9b89e5" class="ne-p"><br></p><pre data-language="python" id="3ce979d5" class="ne-codeblock language-python">pd.merge(df_obj1, df_obj2)</pre><p id="3c48bf0324fce9a28d5c3344079b6ccd" class="ne-p"><br></p><table id="fa6fdee9" class="ne-table" style="width: 748px"><tbody><tr style="height: 33px"><td width="187"></td><td width="187"><p id="u81c7f678" class="ne-p"><span class="ne-text">key</span></p></td><td width="187"><p id="u47cc03c9" class="ne-p"><span class="ne-text">data1</span></p></td><td width="187"><p id="uad64b95c" class="ne-p"><span class="ne-text">data2</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="u9e853297" class="ne-p"><span class="ne-text">0</span></p></td><td width="187"><p id="u7fae4863" class="ne-p"><span class="ne-text">b</span></p></td><td width="187"><p id="u8fbc2b26" class="ne-p"><span class="ne-text">sfd</span></p></td><td width="187"><p id="u45459c4e" class="ne-p"><span class="ne-text">6</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="u7a799426" class="ne-p"><span class="ne-text">1</span></p></td><td width="187"><p id="ue933ed11" class="ne-p"><span class="ne-text">b</span></p></td><td width="187"><p id="uf60692d6" class="ne-p"><span class="ne-text">fdsf</span></p></td><td width="187"><p id="u1d4182bb" class="ne-p"><span class="ne-text">6</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="u9af03cc1" class="ne-p"><span class="ne-text">2</span></p></td><td width="187"><p id="ud93fd487" class="ne-p"><span class="ne-text">b</span></p></td><td width="187"><p id="uc69a1da8" class="ne-p"><span class="ne-text">23</span></p></td><td width="187"><p id="u38b73542" class="ne-p"><span class="ne-text">6</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="ufa297162" class="ne-p"><span class="ne-text">3</span></p></td><td width="187"><p id="u993abd3e" class="ne-p"><span class="ne-text">a</span></p></td><td width="187"><p id="u01b435c1" class="ne-p"><span class="ne-text">we</span></p></td><td width="187"><p id="uc8ce293f" class="ne-p"><span class="ne-text">0</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="ufa7c8400" class="ne-p"><span class="ne-text">4</span></p></td><td width="187"><p id="u020cedbb" class="ne-p"><span class="ne-text">a</span></p></td><td width="187"><p id="u06a7ac18" class="ne-p"><span class="ne-text">3253</span></p></td><td width="187"><p id="u0215a34d" class="ne-p"><span class="ne-text">0</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="u6dc25070" class="ne-p"><span class="ne-text">5</span></p></td><td width="187"><p id="u81a2de26" class="ne-p"><span class="ne-text">a</span></p></td><td width="187"><p id="u71c4b61e" class="ne-p"><span class="ne-text">234</span></p></td><td width="187"><p id="uce4a9e8e" class="ne-p"><span class="ne-text">0</span></p></td></tr></tbody></table><p id="fed4089a44edfd08f93ffcb4987f64d0" class="ne-p"><br></p><pre data-language="python" id="7ba391ad" class="ne-codeblock language-python"># on显示指定“外键”
pd.merge(df_obj1, df_obj2, on='key')</pre><p id="ea17b24616d7207d5ce90012a1fb671c" class="ne-p"><br></p><table id="fa6fdee9-1" class="ne-table" style="width: 748px"><tbody><tr style="height: 33px"><td width="187"></td><td width="187"><p id="u7fe1b3fa" class="ne-p"><span class="ne-text">key</span></p></td><td width="187"><p id="u122e90f3" class="ne-p"><span class="ne-text">data1</span></p></td><td width="187"><p id="u99351a52" class="ne-p"><span class="ne-text">data2</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="ue2faa1ca" class="ne-p"><span class="ne-text">0</span></p></td><td width="187"><p id="u5c4c597b" class="ne-p"><span class="ne-text">b</span></p></td><td width="187"><p id="ua544cc9f" class="ne-p"><span class="ne-text">sfd</span></p></td><td width="187"><p id="udf59bbc2" class="ne-p"><span class="ne-text">6</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="ueb229588" class="ne-p"><span class="ne-text">1</span></p></td><td width="187"><p id="u9dc8007c" class="ne-p"><span class="ne-text">b</span></p></td><td width="187"><p id="u656a787d" class="ne-p"><span class="ne-text">fdsf</span></p></td><td width="187"><p id="u826baaa4" class="ne-p"><span class="ne-text">6</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="u5807e653" class="ne-p"><span class="ne-text">2</span></p></td><td width="187"><p id="u816d0966" class="ne-p"><span class="ne-text">b</span></p></td><td width="187"><p id="uf6d9f8c9" class="ne-p"><span class="ne-text">23</span></p></td><td width="187"><p id="ub107dba1" class="ne-p"><span class="ne-text">6</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="u41659a36" class="ne-p"><span class="ne-text">3</span></p></td><td width="187"><p id="ucc46c302" class="ne-p"><span class="ne-text">a</span></p></td><td width="187"><p id="u626b47da" class="ne-p"><span class="ne-text">we</span></p></td><td width="187"><p id="u0e3b3b67" class="ne-p"><span class="ne-text">0</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="u550ff022" class="ne-p"><span class="ne-text">4</span></p></td><td width="187"><p id="u004f7a57" class="ne-p"><span class="ne-text">a</span></p></td><td width="187"><p id="ue8f1adea" class="ne-p"><span class="ne-text">3253</span></p></td><td width="187"><p id="u5c718f9f" class="ne-p"><span class="ne-text">0</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="ud676974f" class="ne-p"><span class="ne-text">5</span></p></td><td width="187"><p id="u6f743d5e" class="ne-p"><span class="ne-text">a</span></p></td><td width="187"><p id="u23413843" class="ne-p"><span class="ne-text">234</span></p></td><td width="187"><p id="u1fea02fd" class="ne-p"><span class="ne-text">0</span></p></td></tr></tbody></table><p id="6386a653f3be049e7f0f6aebfc469eef" class="ne-p"><br></p><h3 id="fde24c2a"><span class="ne-text">left-on和right-on</span></h3><p id="594d00f819eb667ccf7ca0de6d006a3c" class="ne-p"><br></p><pre data-language="python" id="29ec4548" class="ne-codeblock language-python"># left_on，right_on分别指定左侧数据和右侧数据的“外键”

# 更改列名
df_obj1 = df_obj1.rename(columns={'key':'key1'})
df_obj2 = df_obj2.rename(columns={'key':'key2'})</pre><p id="d5ff1a530532c6bb8601fbf92ca3d57d" class="ne-p"><br></p><pre data-language="python" id="934cfb11" class="ne-codeblock language-python">print(df_obj1)
print(df_obj2)</pre><p id="71109d928c3ae48fb908a9ed414771c4" class="ne-p"><br></p><pre data-language="plain" id="c7e0d06a" class="ne-codeblock language-plain">  key1 data1
0    b   sfd
1    b  fdsf
2    a    we
3    c    24
4    a  3253
5    a   234
6    b    23
  key2  data2
0    a      0
1    b      6
2    d      6</pre><p id="b4e360316db744a782b5f7fc3e0b6ae0" class="ne-p"><br></p><pre data-language="python" id="9c5ec533" class="ne-codeblock language-python">pd.merge(df_obj1, df_obj2, left_on='key1', right_on='key2')</pre><p id="95130cbb4e261528bb2343d18add2102" class="ne-p"><br></p><table id="8bca1abb" class="ne-table" style="width: 750px"><tbody><tr style="height: 33px"><td width="150"></td><td width="150"><p id="u06054f28" class="ne-p"><span class="ne-text">key1</span></p></td><td width="150"><p id="u9247a866" class="ne-p"><span class="ne-text">data1</span></p></td><td width="150"><p id="u7c6ce5a4" class="ne-p"><span class="ne-text">key2</span></p></td><td width="150"><p id="u7237f8b6" class="ne-p"><span class="ne-text">data2</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="ubcb21996" class="ne-p"><span class="ne-text">0</span></p></td><td width="150"><p id="ue30ad954" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="u9ee91e7a" class="ne-p"><span class="ne-text">sfd</span></p></td><td width="150"><p id="u415e3cea" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="u93c4f0bc" class="ne-p"><span class="ne-text">6</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="u9cf2aa12" class="ne-p"><span class="ne-text">1</span></p></td><td width="150"><p id="u1750e3d9" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="u61b465c1" class="ne-p"><span class="ne-text">fdsf</span></p></td><td width="150"><p id="u41baefeb" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="u49391f29" class="ne-p"><span class="ne-text">6</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="u4fb2ab16" class="ne-p"><span class="ne-text">2</span></p></td><td width="150"><p id="ub7cef164" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="u526066bd" class="ne-p"><span class="ne-text">23</span></p></td><td width="150"><p id="ud8d82bc9" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="uba43d188" class="ne-p"><span class="ne-text">6</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="u1cf0af8d" class="ne-p"><span class="ne-text">3</span></p></td><td width="150"><p id="uf3b015e1" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="ud650d4e7" class="ne-p"><span class="ne-text">we</span></p></td><td width="150"><p id="u24de2110" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="uadaff155" class="ne-p"><span class="ne-text">0</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="ue8fbb8ad" class="ne-p"><span class="ne-text">4</span></p></td><td width="150"><p id="u195aa35c" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="ue3d47ced" class="ne-p"><span class="ne-text">3253</span></p></td><td width="150"><p id="u652aef25" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="uc089db0c" class="ne-p"><span class="ne-text">0</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="uedad1fbf" class="ne-p"><span class="ne-text">5</span></p></td><td width="150"><p id="u4abb0a43" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="u65e75755" class="ne-p"><span class="ne-text">234</span></p></td><td width="150"><p id="u4a85a1f9" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="u098f7dca" class="ne-p"><span class="ne-text">0</span></p></td></tr></tbody></table><p id="ccae74a66be4389d93d7cb06bc608c98" class="ne-p"><br></p><h3 id="how"><span class="ne-text">how</span></h3><p id="149802a1efddfff49fbad25750572f02" class="ne-p"><br></p><pre data-language="python" id="c244b13e" class="ne-codeblock language-python"># “外连接”
pd.merge(df_obj1, df_obj2, left_on='key1', right_on='key2', how='outer')</pre><p id="8d62b2ca602aec2ae5f89e8a2144b7eb" class="ne-p"><br></p><table id="726ff191" class="ne-table" style="width: 750px"><tbody><tr style="height: 33px"><td width="150"></td><td width="150"><p id="ud5b7b797" class="ne-p"><span class="ne-text">key1</span></p></td><td width="150"><p id="u1a488068" class="ne-p"><span class="ne-text">data1</span></p></td><td width="150"><p id="uc39e995e" class="ne-p"><span class="ne-text">key2</span></p></td><td width="150"><p id="ubee6378f" class="ne-p"><span class="ne-text">data2</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="u14078539" class="ne-p"><span class="ne-text">0</span></p></td><td width="150"><p id="u9d3a854d" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="u0e13c750" class="ne-p"><span class="ne-text">sfd</span></p></td><td width="150"><p id="u4a0b5b0f" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="uc19cea51" class="ne-p"><span class="ne-text">6.0</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="uff06689c" class="ne-p"><span class="ne-text">1</span></p></td><td width="150"><p id="ueffc61ed" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="u54b586cb" class="ne-p"><span class="ne-text">fdsf</span></p></td><td width="150"><p id="u1854d84f" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="ubc9c3e92" class="ne-p"><span class="ne-text">6.0</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="u1654d75c" class="ne-p"><span class="ne-text">2</span></p></td><td width="150"><p id="ufa1b5463" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="u053b68ff" class="ne-p"><span class="ne-text">23</span></p></td><td width="150"><p id="ubab1b60b" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="uc168d932" class="ne-p"><span class="ne-text">6.0</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="u03e6d48c" class="ne-p"><span class="ne-text">3</span></p></td><td width="150"><p id="u9228a865" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="u8d0b8d13" class="ne-p"><span class="ne-text">we</span></p></td><td width="150"><p id="u9d151a6a" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="udb82c967" class="ne-p"><span class="ne-text">0.0</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="u50423c41" class="ne-p"><span class="ne-text">4</span></p></td><td width="150"><p id="u39f1fb57" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="ube53939a" class="ne-p"><span class="ne-text">3253</span></p></td><td width="150"><p id="ufbd76739" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="u2e144b7d" class="ne-p"><span class="ne-text">0.0</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="u449be90a" class="ne-p"><span class="ne-text">5</span></p></td><td width="150"><p id="u077a087a" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="uc91cb1f1" class="ne-p"><span class="ne-text">234</span></p></td><td width="150"><p id="u8b92efd9" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="u4af471dd" class="ne-p"><span class="ne-text">0.0</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="ud35b0d1d" class="ne-p"><span class="ne-text">6</span></p></td><td width="150"><p id="u30854da3" class="ne-p"><span class="ne-text">c</span></p></td><td width="150"><p id="ubdaca31c" class="ne-p"><span class="ne-text">24</span></p></td><td width="150"><p id="u5f0c01fa" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="150"><p id="u6d412986" class="ne-p"><span class="ne-text">NaN</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="uaf87fe4d" class="ne-p"><span class="ne-text">7</span></p></td><td width="150"><p id="uaa605f48" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="150"><p id="uf945c8b0" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="150"><p id="uce1bcf75" class="ne-p"><span class="ne-text">d</span></p></td><td width="150"><p id="ueeb4b365" class="ne-p"><span class="ne-text">6.0</span></p></td></tr></tbody></table><p id="7d128243f99f1148c8232d032b1f703a" class="ne-p"><br></p><pre data-language="python" id="28241de4" class="ne-codeblock language-python"># 左连接
pd.merge(df_obj1, df_obj2, left_on='key1', right_on='key2', how='left')</pre><p id="e7ff97059482740d29c9bac0032eae52" class="ne-p"><br></p><table id="a5cfc142" class="ne-table" style="width: 750px"><tbody><tr style="height: 33px"><td width="150"></td><td width="150"><p id="u63c99f94" class="ne-p"><span class="ne-text">key1</span></p></td><td width="150"><p id="ubdd125ab" class="ne-p"><span class="ne-text">data1</span></p></td><td width="150"><p id="u6421ee8e" class="ne-p"><span class="ne-text">key2</span></p></td><td width="150"><p id="u9fc23289" class="ne-p"><span class="ne-text">data2</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="u7f1006fe" class="ne-p"><span class="ne-text">0</span></p></td><td width="150"><p id="uf196dabb" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="u41a20ef9" class="ne-p"><span class="ne-text">sfd</span></p></td><td width="150"><p id="uc3a0fadb" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="u4a05892f" class="ne-p"><span class="ne-text">6.0</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="u8cae5ac7" class="ne-p"><span class="ne-text">1</span></p></td><td width="150"><p id="uc598fb00" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="u089b308f" class="ne-p"><span class="ne-text">fdsf</span></p></td><td width="150"><p id="uf7ee4ade" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="u14a13cfa" class="ne-p"><span class="ne-text">6.0</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="u7bd97d12" class="ne-p"><span class="ne-text">2</span></p></td><td width="150"><p id="ua3b58d74" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="u8f4e5089" class="ne-p"><span class="ne-text">we</span></p></td><td width="150"><p id="u2c17af4e" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="udc3d9c6e" class="ne-p"><span class="ne-text">0.0</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="ua7ff1057" class="ne-p"><span class="ne-text">3</span></p></td><td width="150"><p id="ud718c670" class="ne-p"><span class="ne-text">c</span></p></td><td width="150"><p id="u2c266203" class="ne-p"><span class="ne-text">24</span></p></td><td width="150"><p id="u321cd0ce" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="150"><p id="u8b086260" class="ne-p"><span class="ne-text">NaN</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="uca2089c3" class="ne-p"><span class="ne-text">4</span></p></td><td width="150"><p id="u19ce949e" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="ua92ceec6" class="ne-p"><span class="ne-text">3253</span></p></td><td width="150"><p id="ub0d07af1" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="u4d4af551" class="ne-p"><span class="ne-text">0.0</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="ua633e260" class="ne-p"><span class="ne-text">5</span></p></td><td width="150"><p id="u202ea6ca" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="u0e252d6b" class="ne-p"><span class="ne-text">234</span></p></td><td width="150"><p id="u30087809" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="ua46ba011" class="ne-p"><span class="ne-text">0.0</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="ue7928f90" class="ne-p"><span class="ne-text">6</span></p></td><td width="150"><p id="u7b35c690" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="uda1ad5f6" class="ne-p"><span class="ne-text">23</span></p></td><td width="150"><p id="ud6bd06dc" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="u18765b13" class="ne-p"><span class="ne-text">6.0</span></p></td></tr></tbody></table><p id="c27ff2da229f5c41d9452afc6596e283" class="ne-p"><br></p><pre data-language="python" id="244ee9cb" class="ne-codeblock language-python"># 右连接
pd.merge(df_obj1, df_obj2, left_on='key1', right_on='key2', how='right')</pre><p id="c99867ca36cc05595165c7f88d7177dd" class="ne-p"><br></p><table id="89ba0ef8" class="ne-table" style="width: 750px"><tbody><tr style="height: 33px"><td width="150"></td><td width="150"><p id="u1b72c8f6" class="ne-p"><span class="ne-text">key1</span></p></td><td width="150"><p id="u13578791" class="ne-p"><span class="ne-text">data1</span></p></td><td width="150"><p id="ube4e68a3" class="ne-p"><span class="ne-text">key2</span></p></td><td width="150"><p id="u4c6bef6a" class="ne-p"><span class="ne-text">data2</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="u850b96bd" class="ne-p"><span class="ne-text">0</span></p></td><td width="150"><p id="ufd624173" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="ube886771" class="ne-p"><span class="ne-text">sfd</span></p></td><td width="150"><p id="u2adafbae" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="u88182e42" class="ne-p"><span class="ne-text">6</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="u72a1c694" class="ne-p"><span class="ne-text">1</span></p></td><td width="150"><p id="uad77ad88" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="ub1c05071" class="ne-p"><span class="ne-text">fdsf</span></p></td><td width="150"><p id="ua0c89301" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="ubeb4aa02" class="ne-p"><span class="ne-text">6</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="u1cced7c1" class="ne-p"><span class="ne-text">2</span></p></td><td width="150"><p id="uddf830d2" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="u8932a4a3" class="ne-p"><span class="ne-text">23</span></p></td><td width="150"><p id="u22034050" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="u4a657573" class="ne-p"><span class="ne-text">6</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="u9bc615fc" class="ne-p"><span class="ne-text">3</span></p></td><td width="150"><p id="u14060d29" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="u95a7baf1" class="ne-p"><span class="ne-text">we</span></p></td><td width="150"><p id="ub78508cb" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="u5a3df887" class="ne-p"><span class="ne-text">0</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="u4b390fe9" class="ne-p"><span class="ne-text">4</span></p></td><td width="150"><p id="u20e5a6a2" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="uf4629209" class="ne-p"><span class="ne-text">3253</span></p></td><td width="150"><p id="u60f55919" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="u72a875b4" class="ne-p"><span class="ne-text">0</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="u557bb0a4" class="ne-p"><span class="ne-text">5</span></p></td><td width="150"><p id="u187c0608" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="ua92550d1" class="ne-p"><span class="ne-text">234</span></p></td><td width="150"><p id="u4bcf382e" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="uea179258" class="ne-p"><span class="ne-text">0</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="ubf0ad0fc" class="ne-p"><span class="ne-text">6</span></p></td><td width="150"><p id="u9a3d76ab" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="150"><p id="u7aea8edf" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="150"><p id="u3aeb1d5e" class="ne-p"><span class="ne-text">d</span></p></td><td width="150"><p id="ufc1fc8d0" class="ne-p"><span class="ne-text">6</span></p></td></tr></tbody></table><p id="11112ec21536f2c1ab276f8aec610529" class="ne-p"><br></p><h3 id="661c28ad"><span class="ne-text">处理重复列名suffixes</span></h3><p id="4e0f222c017990f038c3ec9ea9e0e1d2" class="ne-p"><br></p><pre data-language="python" id="0d38ce36" class="ne-codeblock language-python"># 处理重复列名
df_obj1 = pd.DataFrame({'key': ['b', 'b', 'a', 'c', 'a', 'a', 'b'],
                        'data' : np.random.randint(0,10,7)})
df_obj2 = pd.DataFrame({'key': ['a', 'b', 'd'],
                        'data' : np.random.randint(0,10,3)})

pd.merge(df_obj1, df_obj2, on='key', suffixes=('_left', '_right'))</pre><p id="b6b4547a314821c4c01a1dc7018d74ff" class="ne-p"><br></p><table id="e549a09a" class="ne-table" style="width: 748px"><tbody><tr style="height: 33px"><td width="187"></td><td width="187"><p id="u4a7e6604" class="ne-p"><span class="ne-text">key</span></p></td><td width="187"><p id="uf5cc2932" class="ne-p"><span class="ne-text">data_left</span></p></td><td width="187"><p id="u3c649438" class="ne-p"><span class="ne-text">data_right</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="u9010976f" class="ne-p"><span class="ne-text">0</span></p></td><td width="187"><p id="uf5846ba0" class="ne-p"><span class="ne-text">b</span></p></td><td width="187"><p id="ueba6a795" class="ne-p"><span class="ne-text">9</span></p></td><td width="187"><p id="u3c282e9e" class="ne-p"><span class="ne-text">1</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="uc2575b0c" class="ne-p"><span class="ne-text">1</span></p></td><td width="187"><p id="ub7a980b1" class="ne-p"><span class="ne-text">b</span></p></td><td width="187"><p id="u04a43efb" class="ne-p"><span class="ne-text">1</span></p></td><td width="187"><p id="u38130794" class="ne-p"><span class="ne-text">1</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="u51b27135" class="ne-p"><span class="ne-text">2</span></p></td><td width="187"><p id="u28efdd29" class="ne-p"><span class="ne-text">b</span></p></td><td width="187"><p id="u1c8e4402" class="ne-p"><span class="ne-text">6</span></p></td><td width="187"><p id="u7bbc7107" class="ne-p"><span class="ne-text">1</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="uf8d7f6a9" class="ne-p"><span class="ne-text">3</span></p></td><td width="187"><p id="u29c2763c" class="ne-p"><span class="ne-text">a</span></p></td><td width="187"><p id="u3b68162b" class="ne-p"><span class="ne-text">7</span></p></td><td width="187"><p id="ued6e6d1b" class="ne-p"><span class="ne-text">1</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="ue5500bd4" class="ne-p"><span class="ne-text">4</span></p></td><td width="187"><p id="ub942bbdb" class="ne-p"><span class="ne-text">a</span></p></td><td width="187"><p id="u72e7f305" class="ne-p"><span class="ne-text">3</span></p></td><td width="187"><p id="uad3535ca" class="ne-p"><span class="ne-text">1</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="u1432cbbe" class="ne-p"><span class="ne-text">5</span></p></td><td width="187"><p id="uf5fe005d" class="ne-p"><span class="ne-text">a</span></p></td><td width="187"><p id="u4d9ccf9e" class="ne-p"><span class="ne-text">4</span></p></td><td width="187"><p id="ued5648dc" class="ne-p"><span class="ne-text">1</span></p></td></tr></tbody></table><p id="d9ff3f0273fafbf1a39678bd76e0137c" class="ne-p"><br></p><pre data-language="python" id="53734adc" class="ne-codeblock language-python"># 按索引连接
df_obj3 = pd.DataFrame({'key': ['b', 'b', 'a', 'c', 'a', 'a', 'b'],
                        'data1' : np.random.randint(0,10,7)})
df_obj4 = pd.DataFrame({'data2' : np.random.randint(0,10,3)}, index=['a', 'b', 'd'])</pre><p id="3f46b4f7a30dc33710afecd7d7bee118" class="ne-p"><br></p><pre data-language="python" id="f4d18927" class="ne-codeblock language-python">print(df_obj3)
print(df_obj4)</pre><p id="4c1535115414f3abd8f35720a1efd400" class="ne-p"><br></p><pre data-language="plain" id="41a9d824" class="ne-codeblock language-plain">  key  data1
0   b      7
1   b      4
2   a      1
3   c      9
4   a      2
5   a      9
6   b      7
   data2
a      9
b      4
d      0</pre><p id="ba5cadd765601d9c81d3336139cf0825" class="ne-p"><br></p><pre data-language="python" id="34262285" class="ne-codeblock language-python">pd.merge(df_obj3, df_obj4, left_on='key', right_index=True)</pre><p id="3f8d7431b2331010ffc772e2f3cf0a85" class="ne-p"><br></p><table id="71c4d53b" class="ne-table" style="width: 748px"><tbody><tr style="height: 33px"><td width="187"></td><td width="187"><p id="ue676d06d" class="ne-p"><span class="ne-text">key</span></p></td><td width="187"><p id="u773ee3bd" class="ne-p"><span class="ne-text">data1</span></p></td><td width="187"><p id="u98abc2b3" class="ne-p"><span class="ne-text">data2</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="u7b12e514" class="ne-p"><span class="ne-text">0</span></p></td><td width="187"><p id="u96db1dff" class="ne-p"><span class="ne-text">b</span></p></td><td width="187"><p id="u01b1f3a6" class="ne-p"><span class="ne-text">7</span></p></td><td width="187"><p id="u8723a135" class="ne-p"><span class="ne-text">4</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="ud62cb7ec" class="ne-p"><span class="ne-text">1</span></p></td><td width="187"><p id="u4ce39eed" class="ne-p"><span class="ne-text">b</span></p></td><td width="187"><p id="uc03e835c" class="ne-p"><span class="ne-text">4</span></p></td><td width="187"><p id="ua2ac0b60" class="ne-p"><span class="ne-text">4</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="u4f48427b" class="ne-p"><span class="ne-text">6</span></p></td><td width="187"><p id="ub55f40e5" class="ne-p"><span class="ne-text">b</span></p></td><td width="187"><p id="ufc6c45c9" class="ne-p"><span class="ne-text">7</span></p></td><td width="187"><p id="u217a4a0d" class="ne-p"><span class="ne-text">4</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="u8df3b809" class="ne-p"><span class="ne-text">2</span></p></td><td width="187"><p id="u90b38f13" class="ne-p"><span class="ne-text">a</span></p></td><td width="187"><p id="u800bb8a5" class="ne-p"><span class="ne-text">1</span></p></td><td width="187"><p id="u1ec27293" class="ne-p"><span class="ne-text">9</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="ub83510f3" class="ne-p"><span class="ne-text">4</span></p></td><td width="187"><p id="ua44e4b57" class="ne-p"><span class="ne-text">a</span></p></td><td width="187"><p id="u9ec1582c" class="ne-p"><span class="ne-text">2</span></p></td><td width="187"><p id="u609d6fc7" class="ne-p"><span class="ne-text">9</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="ud2af22e4" class="ne-p"><span class="ne-text">5</span></p></td><td width="187"><p id="ue92a7dd3" class="ne-p"><span class="ne-text">a</span></p></td><td width="187"><p id="u2096078f" class="ne-p"><span class="ne-text">9</span></p></td><td width="187"><p id="u9b74a610" class="ne-p"><span class="ne-text">9</span></p></td></tr></tbody></table><p id="5a05660a53754f05ff35c456740b9b51" class="ne-p"><br></p><h3 id="49f47e6d"><span class="ne-text">按索引连接right_index</span></h3><p id="fbdbcd0395d391083d8cba07df975b14" class="ne-p"><br></p><pre data-language="python" id="069c5bde" class="ne-codeblock language-python"># 按索引连接
df_obj1 = pd.DataFrame({'key': ['b', 'b', 'a', 'c', 'a', 'a', 'b'],
                        'data1' : np.random.randint(0,10,7)})
df_obj2 = pd.DataFrame({'data2' : np.random.randint(0,10,3)}, index=['a', 'b', 'd'])</pre><p id="71b3c11c2b0e69ca9f4e23331b1485a0" class="ne-p"><br></p><pre data-language="python" id="934cfb11-1" class="ne-codeblock language-python">print(df_obj1)
print(df_obj2)</pre><p id="24292a6a36afdb16eaf0beb4b0307ac6" class="ne-p"><br></p><pre data-language="plain" id="cd70d572" class="ne-codeblock language-plain">  key  data1
0   b      0
1   b      2
2   a      7
3   c      3
4   a      1
5   a      1
6   b      6
   data2
a      2
b      1
d      1</pre><p id="76c85f57d29e2e47f13bb1002394a92e" class="ne-p"><br></p><pre data-language="python" id="2183c7e4" class="ne-codeblock language-python">pd.merge(df_obj1, df_obj2, left_on='key', right_index=True)</pre><p id="9207b0b94ba6c1704d694ae6091c45b5" class="ne-p"><br></p><table id="5bb8d65c" class="ne-table" style="width: 748px"><tbody><tr style="height: 33px"><td width="187"></td><td width="187"><p id="uf3bbccca" class="ne-p"><span class="ne-text">key</span></p></td><td width="187"><p id="ub0f7d646" class="ne-p"><span class="ne-text">data1</span></p></td><td width="187"><p id="u3c2a3cee" class="ne-p"><span class="ne-text">data2</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="u50247be0" class="ne-p"><span class="ne-text">0</span></p></td><td width="187"><p id="u8a9a7c9f" class="ne-p"><span class="ne-text">b</span></p></td><td width="187"><p id="u2613d70c" class="ne-p"><span class="ne-text">0</span></p></td><td width="187"><p id="u8fe6d22c" class="ne-p"><span class="ne-text">1</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="uc9eb80e3" class="ne-p"><span class="ne-text">1</span></p></td><td width="187"><p id="uf478f8ad" class="ne-p"><span class="ne-text">b</span></p></td><td width="187"><p id="u517918ba" class="ne-p"><span class="ne-text">2</span></p></td><td width="187"><p id="u906a3b22" class="ne-p"><span class="ne-text">1</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="u489501df" class="ne-p"><span class="ne-text">6</span></p></td><td width="187"><p id="u807e05c2" class="ne-p"><span class="ne-text">b</span></p></td><td width="187"><p id="u8e45dee3" class="ne-p"><span class="ne-text">6</span></p></td><td width="187"><p id="ue4a8525d" class="ne-p"><span class="ne-text">1</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="udc9495fe" class="ne-p"><span class="ne-text">2</span></p></td><td width="187"><p id="u195f6007" class="ne-p"><span class="ne-text">a</span></p></td><td width="187"><p id="u563e1529" class="ne-p"><span class="ne-text">7</span></p></td><td width="187"><p id="u407404da" class="ne-p"><span class="ne-text">2</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="u9785691e" class="ne-p"><span class="ne-text">4</span></p></td><td width="187"><p id="ue5d3ee74" class="ne-p"><span class="ne-text">a</span></p></td><td width="187"><p id="u2c0116bf" class="ne-p"><span class="ne-text">1</span></p></td><td width="187"><p id="ua8bb2afa" class="ne-p"><span class="ne-text">2</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="uc7e474cc" class="ne-p"><span class="ne-text">5</span></p></td><td width="187"><p id="u8d2a21f6" class="ne-p"><span class="ne-text">a</span></p></td><td width="187"><p id="ud80ce599" class="ne-p"><span class="ne-text">1</span></p></td><td width="187"><p id="u4d897f62" class="ne-p"><span class="ne-text">2</span></p></td></tr></tbody></table><p id="77a619e17ed30f0aa7e15d95a32210ed" class="ne-p"><br></p><h2 id="9b60fc97"><span class="ne-text">四、数据合并</span></h2><p id="18edee4592a49ccf3ae67cced40b6cfa" class="ne-p"><br></p><ul class="ne-ul"><li id="77625b8c9b2ecf5eb6d780abee640b86"><span class="ne-text">数据合并 concat</span></li><li id="2b0cdfced0b3ad2f4227beea1b9c79d2"><span class="ne-text">按索引连接===right_index</span></li></ul><p id="ed6338172bda2d4a9c6507d9cda3239a" class="ne-p"><br></p><pre data-language="python" id="379f4f72" class="ne-codeblock language-python">import numpy as np
import pandas as pd</pre><p id="0b775728997e70e0f93d3a375db538ff" class="ne-p"><br></p><h3 id="49dc343d"><span class="ne-text">numpy的concat</span></h3><p id="c95569105529e86f35e53a62889ab33d" class="ne-p"><br></p><pre data-language="python" id="108b072e" class="ne-codeblock language-python">arr1 = np.random.randint(0, 10, (3, 4))
arr2 = np.random.randint(0, 10, (3, 4))

print (arr1)
print (arr2)</pre><p id="4a735d281237eaa1531b33085dd1f7fb" class="ne-p"><br></p><pre data-language="plain" id="3a9d7b08" class="ne-codeblock language-plain">[[6 0 3 2]
 [5 7 9 8]
 [5 8 0 3]]
[[6 5 7 9]
 [0 1 0 0]
 [1 1 1 7]]</pre><p id="02900d627a5f4e09d8afb126589748c1" class="ne-p"><br></p><pre data-language="python" id="c5a39461" class="ne-codeblock language-python">np.concatenate([arr1, arr2])</pre><p id="2769aa5948ecc8ea89d8e26b7355e256" class="ne-p"><br></p><pre data-language="plain" id="34d42d27" class="ne-codeblock language-plain">array([[6, 0, 3, 2],
       [5, 7, 9, 8],
       [5, 8, 0, 3],
       [6, 5, 7, 9],
       [0, 1, 0, 0],
       [1, 1, 1, 7]])</pre><p id="14a136369610593e3e3f358328c7088d" class="ne-p"><br></p><pre data-language="python" id="f9edaf69" class="ne-codeblock language-python">np.concatenate([arr1, arr2], axis=1)</pre><p id="78ccf6f53e5fc87cba6face79f6057dc" class="ne-p"><br></p><pre data-language="plain" id="27d56b4d" class="ne-codeblock language-plain">array([[6, 0, 3, 2, 6, 5, 7, 9],
       [5, 7, 9, 8, 0, 1, 0, 0],
       [5, 8, 0, 3, 1, 1, 1, 7]])</pre><p id="512de7ce3af3c665b29a990bdaf86ceb" class="ne-p"><br></p><h3 id="e971060d"><span class="ne-text">series上的concat</span></h3><p id="dc665ce85f0e8c991214924a6ff21333" class="ne-p"><br></p><pre data-language="python" id="67ed1834" class="ne-codeblock language-python"># index 没有重复的情况
ser_obj1 = pd.Series(np.random.randint(0, 10, 5), index=range(0,5))
ser_obj2 = pd.Series(np.random.randint(0, 10, 4), index=range(5,9))
ser_obj3 = pd.Series(np.random.randint(0, 10, 3), index=range(9,12))</pre><p id="9375174b7428570213a03c2869e85e79" class="ne-p"><br></p><pre data-language="python" id="bba74a3b" class="ne-codeblock language-python">pd.concat([ser_obj1, ser_obj2, ser_obj3])</pre><p id="2b5423ebc29fbb43211fa4a94cdc6482" class="ne-p"><br></p><pre data-language="plain" id="8acc3736" class="ne-codeblock language-plain">0     0
1     4
2     5
3     1
4     9
5     7
6     8
7     5
8     0
9     5
10    9
11    0
dtype: int32</pre><p id="7a2aacd43d6294ea263f999cb56cdb6b" class="ne-p"><br></p><pre data-language="python" id="c4a1b3d7" class="ne-codeblock language-python">pd.concat([ser_obj1, ser_obj2, ser_obj3], axis=1)</pre><p id="04a2ff893e8f69d45ea62966d979756b" class="ne-p"><br></p><table id="8427a3c9" class="ne-table" style="width: 748px"><tbody><tr style="height: 33px"><td width="187"></td><td width="187"><p id="u68272f85" class="ne-p"><span class="ne-text">0</span></p></td><td width="187"><p id="u9f251536" class="ne-p"><span class="ne-text">1</span></p></td><td width="187"><p id="ua0c573b4" class="ne-p"><span class="ne-text">2</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="u2cb3f6be" class="ne-p"><span class="ne-text">0</span></p></td><td width="187"><p id="u64a4ba24" class="ne-p"><span class="ne-text">0.0</span></p></td><td width="187"><p id="ub35b7657" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="187"><p id="u9259d2e3" class="ne-p"><span class="ne-text">NaN</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="u974efbdd" class="ne-p"><span class="ne-text">1</span></p></td><td width="187"><p id="u9f73e4f3" class="ne-p"><span class="ne-text">4.0</span></p></td><td width="187"><p id="u598ff12c" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="187"><p id="u9bcf9b46" class="ne-p"><span class="ne-text">NaN</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="ufc476255" class="ne-p"><span class="ne-text">2</span></p></td><td width="187"><p id="u2a31a0b6" class="ne-p"><span class="ne-text">5.0</span></p></td><td width="187"><p id="ubc01f667" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="187"><p id="u29df66d5" class="ne-p"><span class="ne-text">NaN</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="ua6f10e9f" class="ne-p"><span class="ne-text">3</span></p></td><td width="187"><p id="u32b9d10e" class="ne-p"><span class="ne-text">1.0</span></p></td><td width="187"><p id="uf366b326" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="187"><p id="ub37a92a6" class="ne-p"><span class="ne-text">NaN</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="u573469cf" class="ne-p"><span class="ne-text">4</span></p></td><td width="187"><p id="u3365dbc7" class="ne-p"><span class="ne-text">9.0</span></p></td><td width="187"><p id="u46f1e3b7" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="187"><p id="u552073d8" class="ne-p"><span class="ne-text">NaN</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="ue83b0001" class="ne-p"><span class="ne-text">5</span></p></td><td width="187"><p id="ubf5df2de" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="187"><p id="ufd454cbd" class="ne-p"><span class="ne-text">7.0</span></p></td><td width="187"><p id="uf3048786" class="ne-p"><span class="ne-text">NaN</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="u6d2a712f" class="ne-p"><span class="ne-text">6</span></p></td><td width="187"><p id="u3d847a81" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="187"><p id="u9086dcfe" class="ne-p"><span class="ne-text">8.0</span></p></td><td width="187"><p id="u263cd9b8" class="ne-p"><span class="ne-text">NaN</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="uf9426871" class="ne-p"><span class="ne-text">7</span></p></td><td width="187"><p id="u418435d4" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="187"><p id="u20bb670f" class="ne-p"><span class="ne-text">5.0</span></p></td><td width="187"><p id="uc920091e" class="ne-p"><span class="ne-text">NaN</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="uad32547e" class="ne-p"><span class="ne-text">8</span></p></td><td width="187"><p id="u15cc9d57" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="187"><p id="u234eee7b" class="ne-p"><span class="ne-text">0.0</span></p></td><td width="187"><p id="uc6b9510f" class="ne-p"><span class="ne-text">NaN</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="u07396bb2" class="ne-p"><span class="ne-text">9</span></p></td><td width="187"><p id="u066a5866" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="187"><p id="u7a34e029" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="187"><p id="u4916b5a6" class="ne-p"><span class="ne-text">5.0</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="uaf35c6b0" class="ne-p"><span class="ne-text">10</span></p></td><td width="187"><p id="u8ace6b4e" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="187"><p id="uf4e1c731" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="187"><p id="ue24c1d5e" class="ne-p"><span class="ne-text">9.0</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="uc869a91e" class="ne-p"><span class="ne-text">11</span></p></td><td width="187"><p id="u424909af" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="187"><p id="u24805868" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="187"><p id="u4a968f40" class="ne-p"><span class="ne-text">0.0</span></p></td></tr></tbody></table><p id="12a40b9035ba00eb3d255135cc6f03cf" class="ne-p"><br></p><pre data-language="python" id="192f82a7" class="ne-codeblock language-python"># index 有重复的情况
ser_obj1 = pd.Series(np.random.randint(0, 10, 5), index=range(5))
ser_obj2 = pd.Series(np.random.randint(0, 10, 4), index=range(4))
ser_obj3 = pd.Series(np.random.randint(0, 10, 3), index=range(3))

print (ser_obj1)
print (ser_obj2)
print (ser_obj3)</pre><p id="65f2989eec41d9e3edbf15829d050c4b" class="ne-p"><br></p><pre data-language="plain" id="c2e3fffd" class="ne-codeblock language-plain">0    5
1    3
2    0
3    8
4    3
dtype: int32
0    5
1    3
2    2
3    1
dtype: int32
0    5
1    8
2    6
dtype: int32</pre><p id="43e0399af1da657ae037dbcfa7ece246" class="ne-p"><br></p><pre data-language="python" id="bba74a3b-1" class="ne-codeblock language-python">pd.concat([ser_obj1, ser_obj2, ser_obj3])</pre><p id="f0815a23c01cd10d1fa91c689cc8d459" class="ne-p"><br></p><pre data-language="plain" id="bd9d04ac" class="ne-codeblock language-plain">0    5
1    3
2    0
3    8
4    3
0    5
1    3
2    2
3    1
0    5
1    8
2    6
dtype: int32</pre><p id="0d5c7ae2b016bcb65ea90fd972d2175f" class="ne-p"><br></p><pre data-language="python" id="774cffe6" class="ne-codeblock language-python">pd.concat([ser_obj1, ser_obj2, ser_obj3], axis=1, join='inner')</pre><p id="12b98ea80373f2aa707dcb8965a4766a" class="ne-p"><br></p><table id="e22433b0" class="ne-table" style="width: 748px"><tbody><tr style="height: 33px"><td width="187"></td><td width="187"><p id="u4ca4c7f7" class="ne-p"><span class="ne-text">0</span></p></td><td width="187"><p id="uf38912d4" class="ne-p"><span class="ne-text">1</span></p></td><td width="187"><p id="u4b7040a9" class="ne-p"><span class="ne-text">2</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="u5b8f08c7" class="ne-p"><span class="ne-text">0</span></p></td><td width="187"><p id="u2824847e" class="ne-p"><span class="ne-text">5</span></p></td><td width="187"><p id="u187ea68a" class="ne-p"><span class="ne-text">5</span></p></td><td width="187"><p id="u3ca97659" class="ne-p"><span class="ne-text">5</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="ue07e43b3" class="ne-p"><span class="ne-text">1</span></p></td><td width="187"><p id="ua2cd5759" class="ne-p"><span class="ne-text">3</span></p></td><td width="187"><p id="u72b9b04e" class="ne-p"><span class="ne-text">3</span></p></td><td width="187"><p id="u61b41737" class="ne-p"><span class="ne-text">8</span></p></td></tr><tr style="height: 33px"><td width="187"><p id="u76ff3900" class="ne-p"><span class="ne-text">2</span></p></td><td width="187"><p id="u82306db4" class="ne-p"><span class="ne-text">0</span></p></td><td width="187"><p id="u718c4f3a" class="ne-p"><span class="ne-text">2</span></p></td><td width="187"><p id="u3aa8d31a" class="ne-p"><span class="ne-text">6</span></p></td></tr></tbody></table><p id="919e295539e5d4ce048d1068bf02fc40" class="ne-p"><br></p><h3 id="335f7ae5"><span class="ne-text">dataframe上的concat</span></h3><p id="c4e24097651cc85c44624174455debf9" class="ne-p"><br></p><pre data-language="python" id="c4cd0e53" class="ne-codeblock language-python">df_obj1 = pd.DataFrame(np.random.randint(0, 10, (3, 2)), index=['a', 'b', 'c'],
                       columns=['A', 'B'])
df_obj2 = pd.DataFrame(np.random.randint(0, 10, (2, 2)), index=['a', 'b'],
                       columns=['C', 'D'])
print (df_obj1)
print (df_obj2)</pre><p id="c3eddd7d60ed23308ecc08a06554c379" class="ne-p"><br></p><pre data-language="plain" id="2cb814ca" class="ne-codeblock language-plain">   A  B
a  4  3
b  8  1
c  6  3
   C  D
a  1  3
b  8  2</pre><p id="ed2fdeecaa0daa34d97a7d590aa87af5" class="ne-p"><br></p><pre data-language="python" id="1582b91e" class="ne-codeblock language-python">pd.concat([df_obj1, df_obj2])</pre><p id="077f4b0cfaf1fecffca7302f73362348" class="ne-p"><br></p><pre data-language="plain" id="b69c93f9" class="ne-codeblock language-plain">C:\Users\wztli\Anaconda3\lib\site-packages\ipykernel_launcher.py:1: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version
of pandas will change to not sort by default.

To accept the future behavior, pass 'sort=False'.

To retain the current behavior and silence the warning, pass 'sort=True'.

  &quot;&quot;&quot;Entry point for launching an IPython kernel.</pre><p id="fc316cf85cde91be2757489ae12b9135" class="ne-p"><br></p><table id="ac00ad54" class="ne-table" style="width: 750px"><tbody><tr style="height: 33px"><td width="150"></td><td width="150"><p id="uab796b30" class="ne-p"><span class="ne-text">A</span></p></td><td width="150"><p id="ue12b0137" class="ne-p"><span class="ne-text">B</span></p></td><td width="150"><p id="u271a66f0" class="ne-p"><span class="ne-text">C</span></p></td><td width="150"><p id="u6068b22c" class="ne-p"><span class="ne-text">D</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="ub830ccf8" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="u266f71bd" class="ne-p"><span class="ne-text">4.0</span></p></td><td width="150"><p id="u7542c263" class="ne-p"><span class="ne-text">3.0</span></p></td><td width="150"><p id="ubd7e4c4e" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="150"><p id="ua283a993" class="ne-p"><span class="ne-text">NaN</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="u529832e3" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="ued5ad518" class="ne-p"><span class="ne-text">8.0</span></p></td><td width="150"><p id="u0557f4f4" class="ne-p"><span class="ne-text">1.0</span></p></td><td width="150"><p id="u1781a84c" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="150"><p id="u7e92786c" class="ne-p"><span class="ne-text">NaN</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="uae87b9fb" class="ne-p"><span class="ne-text">c</span></p></td><td width="150"><p id="u8c99268a" class="ne-p"><span class="ne-text">6.0</span></p></td><td width="150"><p id="u90adcf59" class="ne-p"><span class="ne-text">3.0</span></p></td><td width="150"><p id="ua2020bd0" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="150"><p id="u1fe0774d" class="ne-p"><span class="ne-text">NaN</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="u92a7afd0" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="u2dcb7440" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="150"><p id="u79a8b449" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="150"><p id="u306e4273" class="ne-p"><span class="ne-text">1.0</span></p></td><td width="150"><p id="uf3df0c17" class="ne-p"><span class="ne-text">3.0</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="uaed95ed2" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="u6c477b1d" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="150"><p id="u14989056" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="150"><p id="u739f66ee" class="ne-p"><span class="ne-text">8.0</span></p></td><td width="150"><p id="u81b88095" class="ne-p"><span class="ne-text">2.0</span></p></td></tr></tbody></table><p id="67a9d50c87f86671b30abe750ad1c0b3" class="ne-p"><br></p><pre data-language="python" id="4ef72bdb" class="ne-codeblock language-python">pd.concat([df_obj1, df_obj2], axis=1)</pre><p id="9fbaee2702102560b31ed7ed296bd607" class="ne-p"><br></p><pre data-language="plain" id="b69c93f9-1" class="ne-codeblock language-plain">C:\Users\wztli\Anaconda3\lib\site-packages\ipykernel_launcher.py:1: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version
of pandas will change to not sort by default.

To accept the future behavior, pass 'sort=False'.

To retain the current behavior and silence the warning, pass 'sort=True'.

  &quot;&quot;&quot;Entry point for launching an IPython kernel.</pre><p id="40b9f3d4ca1045b61eb9d93d25f1dd72" class="ne-p"><br></p><table id="8a43a84b" class="ne-table" style="width: 750px"><tbody><tr style="height: 33px"><td width="150"></td><td width="150"><p id="u02e408f2" class="ne-p"><span class="ne-text">A</span></p></td><td width="150"><p id="u6d20e4f5" class="ne-p"><span class="ne-text">B</span></p></td><td width="150"><p id="u03bdd708" class="ne-p"><span class="ne-text">C</span></p></td><td width="150"><p id="ub2b48fa4" class="ne-p"><span class="ne-text">D</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="u8143ea69" class="ne-p"><span class="ne-text">a</span></p></td><td width="150"><p id="ub12fb30e" class="ne-p"><span class="ne-text">4</span></p></td><td width="150"><p id="ud80ebe28" class="ne-p"><span class="ne-text">3</span></p></td><td width="150"><p id="u7b61c426" class="ne-p"><span class="ne-text">1.0</span></p></td><td width="150"><p id="ub409f483" class="ne-p"><span class="ne-text">3.0</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="uae898043" class="ne-p"><span class="ne-text">b</span></p></td><td width="150"><p id="ua563c8cd" class="ne-p"><span class="ne-text">8</span></p></td><td width="150"><p id="u63ce1413" class="ne-p"><span class="ne-text">1</span></p></td><td width="150"><p id="u997b869a" class="ne-p"><span class="ne-text">8.0</span></p></td><td width="150"><p id="u8e61c765" class="ne-p"><span class="ne-text">2.0</span></p></td></tr><tr style="height: 33px"><td width="150"><p id="u2789d61f" class="ne-p"><span class="ne-text">c</span></p></td><td width="150"><p id="u7bc2332c" class="ne-p"><span class="ne-text">6</span></p></td><td width="150"><p id="u4498fc92" class="ne-p"><span class="ne-text">3</span></p></td><td width="150"><p id="ub5bb1127" class="ne-p"><span class="ne-text">NaN</span></p></td><td width="150"><p id="uc0abec00" class="ne-p"><span class="ne-text">NaN</span></p></td></tr></tbody></table><p id="8bfb15bac0ecf1b8c787dc7a01c2a028" class="ne-p"><br></p><h2 id="aaabb73c"><span class="ne-text">五、数据重构</span></h2><p id="09679efbcf9f47e02fee9a1a6d039b6a" class="ne-p"><br></p><pre data-language="python" id="379f4f72-1" class="ne-codeblock language-python">import numpy as np
import pandas as pd</pre><p id="6200b93aabb7c246f4f1f1fb4525e67f" class="ne-p"><br></p><h3 id="stack"><span class="ne-text">stack</span></h3><p id="5206bb1c95588434110c48ed5dcfa6aa" class="ne-p"><br></p><pre data-language="python" id="fa002eeb" class="ne-codeblock language-python">df_obj = pd.DataFrame(np.random.randint(0,10, (5,2)), columns=['data1', 'data2'])
df_obj</pre><p id="a837b226492db97471958ac9903b4432" class="ne-p"><br></p><table id="91086468" class="ne-table" style="width: 750px"><tbody><tr style="height: 33px"><td width="250"></td><td width="250"><p id="uc9e2ebb3" class="ne-p"><span class="ne-text">data1</span></p></td><td width="250"><p id="u8db106c0" class="ne-p"><span class="ne-text">data2</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="u44268a4a" class="ne-p"><span class="ne-text">0</span></p></td><td width="250"><p id="udb7beff3" class="ne-p"><span class="ne-text">0</span></p></td><td width="250"><p id="udbfad175" class="ne-p"><span class="ne-text">4</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="ufacb442c" class="ne-p"><span class="ne-text">1</span></p></td><td width="250"><p id="u08cff539" class="ne-p"><span class="ne-text">6</span></p></td><td width="250"><p id="ubd9a116a" class="ne-p"><span class="ne-text">2</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="u08ee48c6" class="ne-p"><span class="ne-text">2</span></p></td><td width="250"><p id="uc383920b" class="ne-p"><span class="ne-text">9</span></p></td><td width="250"><p id="u542ab240" class="ne-p"><span class="ne-text">8</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="u5cc68de2" class="ne-p"><span class="ne-text">3</span></p></td><td width="250"><p id="u636e6bb5" class="ne-p"><span class="ne-text">7</span></p></td><td width="250"><p id="uf1d60ada" class="ne-p"><span class="ne-text">0</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="u8025f01a" class="ne-p"><span class="ne-text">4</span></p></td><td width="250"><p id="u03306ab8" class="ne-p"><span class="ne-text">3</span></p></td><td width="250"><p id="u1006e986" class="ne-p"><span class="ne-text">1</span></p></td></tr></tbody></table><p id="59f7ab51fb7b67a21d7164f545943fb5" class="ne-p"><br></p><pre data-language="python" id="4da7dd95" class="ne-codeblock language-python">stacked = df_obj.stack()
print (stacked)</pre><p id="7236f683db3fda28b0c683af2ce355b8" class="ne-p"><br></p><pre data-language="plain" id="61346a5e" class="ne-codeblock language-plain">0  data1    0
   data2    4
1  data1    6
   data2    2
2  data1    9
   data2    8
3  data1    7
   data2    0
4  data1    3
   data2    1
dtype: int32</pre><p id="0ed95166cddf4c254591d38d6d8d3ecb" class="ne-p"><br></p><pre data-language="python" id="156b5ea4" class="ne-codeblock language-python">print (type(stacked))
print (type(stacked.index))</pre><p id="a0f97e379854a606e012448962686ef5" class="ne-p"><br></p><pre data-language="plain" id="314a292c" class="ne-codeblock language-plain">&lt;class 'pandas.core.series.Series'&gt;
&lt;class 'pandas.core.indexes.multi.MultiIndex'&gt;</pre><p id="c14a7b185435507ea54db3144176f42e" class="ne-p"><br></p><h3 id="unstack"><span class="ne-text">unstack</span></h3><p id="289adf4c5e7a257346bc39676ca3849f" class="ne-p"><br></p><pre data-language="python" id="28db94e9" class="ne-codeblock language-python"># 默认操作内层索引
stacked.unstack()</pre><p id="25917fddfb9e9ef38ac7b69c0493ba5d" class="ne-p"><br></p><table id="91086468-1" class="ne-table" style="width: 750px"><tbody><tr style="height: 33px"><td width="250"></td><td width="250"><p id="u81e4bf05" class="ne-p"><span class="ne-text">data1</span></p></td><td width="250"><p id="ub06599cb" class="ne-p"><span class="ne-text">data2</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="u07bbb3c4" class="ne-p"><span class="ne-text">0</span></p></td><td width="250"><p id="u2d4d6069" class="ne-p"><span class="ne-text">0</span></p></td><td width="250"><p id="ue44d5fa9" class="ne-p"><span class="ne-text">4</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="ua1ad5523" class="ne-p"><span class="ne-text">1</span></p></td><td width="250"><p id="uf65a0b11" class="ne-p"><span class="ne-text">6</span></p></td><td width="250"><p id="u6b0d2066" class="ne-p"><span class="ne-text">2</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="u8603d2a8" class="ne-p"><span class="ne-text">2</span></p></td><td width="250"><p id="u858ad280" class="ne-p"><span class="ne-text">9</span></p></td><td width="250"><p id="u209b4b73" class="ne-p"><span class="ne-text">8</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="u718c743b" class="ne-p"><span class="ne-text">3</span></p></td><td width="250"><p id="u376daae7" class="ne-p"><span class="ne-text">7</span></p></td><td width="250"><p id="u773270ad" class="ne-p"><span class="ne-text">0</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="u095b98a1" class="ne-p"><span class="ne-text">4</span></p></td><td width="250"><p id="ue3ac7448" class="ne-p"><span class="ne-text">3</span></p></td><td width="250"><p id="u249cb31f" class="ne-p"><span class="ne-text">1</span></p></td></tr></tbody></table><p id="82baa61bc650bac43fe315afe791d962" class="ne-p"><br></p><pre data-language="python" id="4085d62b" class="ne-codeblock language-python"># 通过level指定操作索引的级别
stacked.unstack(level=0)</pre><p id="d7e58703c322b81ee262bfede7ac4a5f" class="ne-p"><br></p><table id="2ff17a10" class="ne-table" style="width: 750px"><tbody><tr style="height: 33px"><td width="125"></td><td width="125"><p id="u8209af75" class="ne-p"><span class="ne-text">0</span></p></td><td width="125"><p id="u30cc3d16" class="ne-p"><span class="ne-text">1</span></p></td><td width="125"><p id="u5f8f0599" class="ne-p"><span class="ne-text">2</span></p></td><td width="125"><p id="u5df48f31" class="ne-p"><span class="ne-text">3</span></p></td><td width="125"><p id="u5a1b07ff" class="ne-p"><span class="ne-text">4</span></p></td></tr><tr style="height: 33px"><td width="125"><p id="uf7e9d9e7" class="ne-p"><span class="ne-text">data1</span></p></td><td width="125"><p id="uab1b1305" class="ne-p"><span class="ne-text">0</span></p></td><td width="125"><p id="u34b7f6c6" class="ne-p"><span class="ne-text">6</span></p></td><td width="125"><p id="u4e1d9e66" class="ne-p"><span class="ne-text">9</span></p></td><td width="125"><p id="ua84a0995" class="ne-p"><span class="ne-text">7</span></p></td><td width="125"><p id="uc02cc941" class="ne-p"><span class="ne-text">3</span></p></td></tr><tr style="height: 33px"><td width="125"><p id="u49b9b876" class="ne-p"><span class="ne-text">data2</span></p></td><td width="125"><p id="uf54625a0" class="ne-p"><span class="ne-text">4</span></p></td><td width="125"><p id="u848b644a" class="ne-p"><span class="ne-text">2</span></p></td><td width="125"><p id="udbac930f" class="ne-p"><span class="ne-text">8</span></p></td><td width="125"><p id="u8560deaa" class="ne-p"><span class="ne-text">0</span></p></td><td width="125"><p id="u1409f450" class="ne-p"><span class="ne-text">1</span></p></td></tr></tbody></table><p id="c3c3d38f0736bc7689d61d97fc990b67" class="ne-p"><br></p><h2 id="8b734d80"><span class="ne-text">六、数据转换</span></h2><p id="dd7c210c859d5825a6fc3a6970eeb989" class="ne-p"><br></p><pre data-language="python" id="379f4f72-2" class="ne-codeblock language-python">import numpy as np
import pandas as pd</pre><p id="1de42d69bb5e55f7742fe670a84e4017" class="ne-p"><br></p><h3 id="733c6e83"><span class="ne-text">重复数据duplicates函数</span></h3><p id="962a64b299d0f2297960980e1f901514" class="ne-p"><br></p><pre data-language="python" id="23bc48e7" class="ne-codeblock language-python">df_obj = pd.DataFrame({'data1' : ['a'] * 4 + ['b'] * 4,
                       'data2' : np.random.randint(0, 4, 8)})
df_obj</pre><p id="6f619776294030ce1be0072f00a19853" class="ne-p"><br></p><table id="e04f5215" class="ne-table" style="width: 750px"><tbody><tr style="height: 33px"><td width="250"></td><td width="250"><p id="u29addf64" class="ne-p"><span class="ne-text">data1</span></p></td><td width="250"><p id="uf4c1bc65" class="ne-p"><span class="ne-text">data2</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="u6da35f6c" class="ne-p"><span class="ne-text">0</span></p></td><td width="250"><p id="uac616efa" class="ne-p"><span class="ne-text">a</span></p></td><td width="250"><p id="ub8202c56" class="ne-p"><span class="ne-text">3</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="u155bfe0c" class="ne-p"><span class="ne-text">1</span></p></td><td width="250"><p id="ub284bbba" class="ne-p"><span class="ne-text">a</span></p></td><td width="250"><p id="u1e5f62f4" class="ne-p"><span class="ne-text">2</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="uf650c2c9" class="ne-p"><span class="ne-text">2</span></p></td><td width="250"><p id="ua8c0d965" class="ne-p"><span class="ne-text">a</span></p></td><td width="250"><p id="ud6e1ddc2" class="ne-p"><span class="ne-text">2</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="u6928d329" class="ne-p"><span class="ne-text">3</span></p></td><td width="250"><p id="u4ece4166" class="ne-p"><span class="ne-text">a</span></p></td><td width="250"><p id="u5308bb48" class="ne-p"><span class="ne-text">1</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="u5eca0bb9" class="ne-p"><span class="ne-text">4</span></p></td><td width="250"><p id="u60f0a88d" class="ne-p"><span class="ne-text">b</span></p></td><td width="250"><p id="ueb83b479" class="ne-p"><span class="ne-text">0</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="u6c220b40" class="ne-p"><span class="ne-text">5</span></p></td><td width="250"><p id="uf15379a7" class="ne-p"><span class="ne-text">b</span></p></td><td width="250"><p id="u1f68bac9" class="ne-p"><span class="ne-text">2</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="ue49eff14" class="ne-p"><span class="ne-text">6</span></p></td><td width="250"><p id="ua4b7ebc3" class="ne-p"><span class="ne-text">b</span></p></td><td width="250"><p id="udd5752c2" class="ne-p"><span class="ne-text">2</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="ub1a2a5f1" class="ne-p"><span class="ne-text">7</span></p></td><td width="250"><p id="u60398876" class="ne-p"><span class="ne-text">b</span></p></td><td width="250"><p id="u206db7c0" class="ne-p"><span class="ne-text">1</span></p></td></tr></tbody></table><p id="5faea08b4e3bbc7b5a2ee0960b926599" class="ne-p"><br></p><pre data-language="python" id="2adb2765" class="ne-codeblock language-python">df_obj.duplicated()</pre><p id="2327004780c08df0e8ad8280ae74a217" class="ne-p"><br></p><pre data-language="plain" id="263fe025" class="ne-codeblock language-plain">0    False
1    False
2     True
3    False
4    False
5    False
6     True
7    False
dtype: bool</pre><p id="7b51935ce28e051cf9e03153030e9bba" class="ne-p"><br></p><pre data-language="python" id="9f84e5e9" class="ne-codeblock language-python">df_obj.drop_duplicates()</pre><p id="42e64d2366041ba4f6a8abf12afc225e" class="ne-p"><br></p><table id="60f15592" class="ne-table" style="width: 750px"><tbody><tr style="height: 33px"><td width="250"></td><td width="250"><p id="u6ef0f98b" class="ne-p"><span class="ne-text">data1</span></p></td><td width="250"><p id="uce9c2d07" class="ne-p"><span class="ne-text">data2</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="uea5fc425" class="ne-p"><span class="ne-text">0</span></p></td><td width="250"><p id="u0ec2791f" class="ne-p"><span class="ne-text">a</span></p></td><td width="250"><p id="u00a07693" class="ne-p"><span class="ne-text">3</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="u41e18df0" class="ne-p"><span class="ne-text">1</span></p></td><td width="250"><p id="ud2250003" class="ne-p"><span class="ne-text">a</span></p></td><td width="250"><p id="u383b7309" class="ne-p"><span class="ne-text">2</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="uf36ee208" class="ne-p"><span class="ne-text">3</span></p></td><td width="250"><p id="u0f4b3c9f" class="ne-p"><span class="ne-text">a</span></p></td><td width="250"><p id="uf1ef6594" class="ne-p"><span class="ne-text">1</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="u0dffc0ed" class="ne-p"><span class="ne-text">4</span></p></td><td width="250"><p id="u14b2a985" class="ne-p"><span class="ne-text">b</span></p></td><td width="250"><p id="u2f08f83f" class="ne-p"><span class="ne-text">0</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="uf8354273" class="ne-p"><span class="ne-text">5</span></p></td><td width="250"><p id="u85a7d9e0" class="ne-p"><span class="ne-text">b</span></p></td><td width="250"><p id="u44b593ca" class="ne-p"><span class="ne-text">2</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="ua7d4d6bd" class="ne-p"><span class="ne-text">7</span></p></td><td width="250"><p id="u76e6704e" class="ne-p"><span class="ne-text">b</span></p></td><td width="250"><p id="u0a63610f" class="ne-p"><span class="ne-text">1</span></p></td></tr></tbody></table><p id="286808f0af9855277d74f3310fdfdee0" class="ne-p"><br></p><pre data-language="python" id="883df7a7" class="ne-codeblock language-python">df_obj.drop_duplicates('data2')</pre><p id="5ef194d891497497b7d9d24d10c447d9" class="ne-p"><br></p><table id="377e3648" class="ne-table" style="width: 750px"><tbody><tr style="height: 33px"><td width="250"></td><td width="250"><p id="u5dfa3cff" class="ne-p"><span class="ne-text">data1</span></p></td><td width="250"><p id="u20afa825" class="ne-p"><span class="ne-text">data2</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="uab7ba142" class="ne-p"><span class="ne-text">0</span></p></td><td width="250"><p id="u4b24c996" class="ne-p"><span class="ne-text">a</span></p></td><td width="250"><p id="ub0e38445" class="ne-p"><span class="ne-text">3</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="ua2dda83e" class="ne-p"><span class="ne-text">1</span></p></td><td width="250"><p id="ud09c3c1c" class="ne-p"><span class="ne-text">a</span></p></td><td width="250"><p id="u09b7e036" class="ne-p"><span class="ne-text">2</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="ub942c0eb" class="ne-p"><span class="ne-text">3</span></p></td><td width="250"><p id="u92494f3f" class="ne-p"><span class="ne-text">a</span></p></td><td width="250"><p id="u55a6f46a" class="ne-p"><span class="ne-text">1</span></p></td></tr><tr style="height: 33px"><td width="250"><p id="uc494eb8b" class="ne-p"><span class="ne-text">4</span></p></td><td width="250"><p id="ub9808a69" class="ne-p"><span class="ne-text">b</span></p></td><td width="250"><p id="uf67e7889" class="ne-p"><span class="ne-text">0</span></p></td></tr></tbody></table><p id="6fb8ac6cc72bbf4d459ca4323c3369cf" class="ne-p"><br></p><h3 id="207de4ba"><span class="ne-text">map函数</span></h3><p id="0b852b014c420dfa44de29a2094f36bc" class="ne-p"><br></p><pre data-language="python" id="e66db930" class="ne-codeblock language-python">ser_obj = pd.Series(np.random.randint(0,10,10))
ser_obj</pre><p id="20f3b3fe6db7de5d960e0f9f3e5daa5c" class="ne-p"><br></p><pre data-language="plain" id="883103db" class="ne-codeblock language-plain">0    1
1    9
2    1
3    2
4    7
5    2
6    4
7    5
8    4
9    6
dtype: int32</pre><p id="417b03bd67025a010d552a47f2557d9f" class="ne-p"><br></p><pre data-language="python" id="15248bd2" class="ne-codeblock language-python">ser_obj.map(lambda x : x ** 2)</pre><p id="1e8c432b1337e249a62dd72a98a9bd65" class="ne-p"><br></p><pre data-language="plain" id="a2279e5a" class="ne-codeblock language-plain">0     1
1    81
2     1
3     4
4    49
5     4
6    16
7    25
8    16
9    36
dtype: int64</pre><p id="1e529b753a515a1b0e602cd47d91e556" class="ne-p"><br></p><h3 id="1584db2b"><span class="ne-text">数据替换repalce</span></h3><p id="8110e898e645923cf5bdb0698a0ba85e" class="ne-p"><br></p><pre data-language="python" id="9379d450" class="ne-codeblock language-python"># 替换单个值
ser_obj.replace(0, -100)</pre><p id="8acd89d411f1fe553a62e07956358d97" class="ne-p"><br></p><pre data-language="plain" id="883103db-1" class="ne-codeblock language-plain">0    1
1    9
2    1
3    2
4    7
5    2
6    4
7    5
8    4
9    6
dtype: int32</pre><p id="b54c66d8f7e43413c0b8cf2346183aa0" class="ne-p"><br></p><pre data-language="python" id="7a6be364" class="ne-codeblock language-python"># 替换多个值
ser_obj.replace([0, 2], -100)</pre><p id="ecfa1ac314577c38da677bf50befe650" class="ne-p"><br></p><pre data-language="plain" id="10f50805" class="ne-codeblock language-plain">0      1
1      9
2      1
3   -100
4      7
5   -100
6      4
7      5
8      4
9      6
dtype: int32</pre><p id="068d5496b45003de6a59b69f9d88ef82" class="ne-p"><br></p><pre data-language="python" id="788607ac" class="ne-codeblock language-python"># 替换多个值
ser_obj.replace([0, 2], [-100, -200])</pre><p id="72422fede5e8faea414154c40133d57f" class="ne-p"><br></p><pre data-language="plain" id="7388dc30" class="ne-codeblock language-plain">0      1
1      9
2      1
3   -200
4      7
5   -200
6      4
7      5
8      4
9      6
dtype: int64</pre><p id="d65e0ebb83ebe63c7e11dc2777c3e2cc" class="ne-p"><br></p><pre data-language="python" id="512b24b5" class="ne-codeblock language-python">ser_obj.map(lambda x : x ** 2)

#### 3. 数据替换repalce

# 替换单个值
ser_obj.replace(0, -100)

# 替换多个值
ser_obj.replace([0, 2], -100)

# 替换多个值
ser_obj.replace([0, 2], [-100, -200])</pre><p id="ec9881a62ad4fb02d90aa9fa8ea52c70" class="ne-p"><br></p><pre data-language="plain" id="7388dc30-1" class="ne-codeblock language-plain">0      1
1      9
2      1
3   -200
4      7
5   -200
6      4
7      5
8      4
9      6
dtype: int64</pre></div>0:{"buildId":"2Uf-0k87jGUS-VSwdLfXo","rsc":["$","$1","c",{"children":[["$","section",null,{"className":"relative","children":["$","$L2",null,{"fade":true,"blur":true,"transition":{"duration":0.5},"delay":0.1,"className":"relative overflow-hidden border-y xl:flex","children":[["$","div",null,{"className":"m-6 w-full flex-1 bg-[radial-gradient(circle_at_center,color-mix(in_oklab,var(--primary)_15%,transparent)_2px,transparent_2px)] bg-size-[18px_18px] max-xl:hidden"}],["$","div",null,{"className":"mx-auto w-full max-w-6xl flex-none space-y-8 px-4 py-8 min-[1158px]:border-x sm:px-6 sm:py-12 lg:px-8","children":[["$","$L2",null,{"fade":true,"blur":true,"slide":{"direction":"down","offset":30},"transition":{"duration":0.4},"children":["$","$L3",null,{"href":"/blog","className":"text-muted-foreground hover:text-foreground inline-flex items-center gap-2 text-sm transition-colors","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-arrow-left h-4 w-4","aria-hidden":"true","children":[["$","path","1l729n",{"d":"m12 19-7-7 7-7"}],["$","path","x3x0zl",{"d":"M19 12H5"}],"$undefined"]}],"返回","技术博客"]}]}],["$","article",null,{"className":"mx-auto max-w-4xl","children":[["$","header",null,{"className":"mb-8 space-y-6","children":["",["$","$L2",null,{"delay":0.3,"transition":{"duration":0.5},"children":["$","h1",null,{"className":"text-2xl font-bold tracking-tight sm:text-3xl md:text-4xl","children":["$","$L4",null,{"text":"数据的清洗和规整（二）","delay":30,"animateBy":"words","direction":"bottom"}]}]}],["$","$L2",null,{"fade":true,"blur":true,"slide":{"direction":"down","offset":30},"delay":0.4,"transition":{"duration":0.5},"children":["$","p",null,{"className":"text-muted-foreground text-lg","children":"规整数据：连接、合并、重构、转换etc三、数据规整-连接-含索引数据连接 mergeimport pandas as pd import numpy as npdf_obj1 = pd.DataFrame({'key': ['b', 'b', 'a', 'c', 'a', 'a', 'b'],..."}]}],["$","$L2",null,{"fade":true,"blur":true,"slide":{"direction":"down","offset":30},"delay":0.5,"transition":{"duration":0.5},"children":["$","div",null,{"className":"text-muted-foreground flex flex-wrap items-center gap-4 text-sm","children":[["$","div",null,{"className":"flex items-center gap-1","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-calendar h-4 w-4","aria-hidden":"true","children":[["$","path","1cmpym",{"d":"M8 2v4"}],["$","path","4m81vk",{"d":"M16 2v4"}],["$","rect","1hopcy",{"width":"18","height":"18","x":"3","y":"4","rx":"2"}],["$","path","8toen8",{"d":"M3 10h18"}],"$undefined"]}],["$","span",null,{"children":"2020年8月29日"}]]}],["$","div",null,{"className":"flex items-center gap-1","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-clock h-4 w-4","aria-hidden":"true","children":[["$","path","mmk7yg",{"d":"M12 6v6l4 2"}],["$","circle","1mglay",{"cx":"12","cy":"12","r":"10"}],"$undefined"]}],["$","span",null,{"children":"1.7千字"}]]}],["$","div",null,{"className":"flex items-center gap-1","children":[["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":24,"height":24,"viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":2,"strokeLinecap":"round","strokeLinejoin":"round","className":"lucide lucide-eye h-4 w-4","aria-hidden":"true","children":[["$","path","1nclc0",{"d":"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"}],["$","circle","1v7zrd",{"cx":"12","cy":"12","r":"3"}],"$undefined"]}],["$","span",null,{"children":[7," 阅读"]}]]}],false,false]}]}],false]}],["$","$L2",null,{"delay":0.6,"fade":true,"blur":true,"transition":{"duration":0.6},"className":"-mx-4 sm:-mx-6 lg:-mx-8","children":["$","$L5",null,{}]}],["$","$L2",null,{"fade":true,"blur":true,"slide":{"direction":"up","offset":50},"delay":0.7,"transition":{"duration":0.6},"children":["$","div",null,{"className":"prose prose-neutral dark:prose-invert mt-8 max-w-none","dangerouslySetInnerHTML":{"__html":"$6"}}]}],"$L7","$L8"]}]]}],"$L9"]}]}],["$La"],"$Lb"]}],"loading":null,"isPartial":false}
7:["$","$L2",null,{"delay":0.8,"fade":true,"blur":true,"transition":{"duration":0.6},"className":"-mx-4 mt-12 sm:-mx-6 lg:-mx-8","children":["$","$L5",null,{}]}]
8:["$","$L2",null,{"fade":true,"blur":true,"slide":{"direction":"up","offset":30},"delay":0.9,"transition":{"duration":0.5},"children":["$","nav",null,{"className":"mt-8 grid gap-4 md:grid-cols-2","children":[["$","$L3",null,{"href":"/blog/gvi1hn","className":"hover:bg-muted group flex flex-col rounded-lg border p-4 transition-colors","children":[["$","span",null,{"className":"text-muted-foreground mb-2 text-sm","children":"上一篇"}],["$","span",null,{"className":"group-hover:text-primary line-clamp-2 font-medium transition-colors","children":"数据的清洗和规整（一）"}]]}],["$","$L3",null,{"href":"/blog/lb8ugs","className":"hover:bg-muted group flex flex-col rounded-lg border p-4 text-right transition-colors md:text-right","children":[["$","span",null,{"className":"text-muted-foreground mb-2 text-sm","children":"下一篇"}],["$","span",null,{"className":"group-hover:text-primary line-clamp-2 font-medium transition-colors","children":"Python的本地各类数据读取"}]]}]]}]}]
9:["$","div",null,{"className":"m-6 w-full flex-1 bg-[radial-gradient(circle_at_center,color-mix(in_oklab,var(--primary)_15%,transparent)_2px,transparent_2px)] bg-size-[18px_18px] max-xl:hidden"}]
a:["$","script","script-0",{"src":"/_next/static/chunks/11dff99839ab5ba0.js","async":true}]
b:["$","$Lc",null,{"children":["$","$d",null,{"name":"Next.MetadataOutlet","children":"$@e"}]}]
e:null
