(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,35852,e=>{"use strict";let t,r,n;var a=e.i(43476),s=e.i(71645),o=e.i(26999),i=e.i(73156),l=e.i(30655),d=e.i(51999),c=e.i(22071),u=e.i(19056),p=e.i(35776),m=e.i(83599);let f=(0,e.i(71235).withMiddleware)(m.default,e=>(t,r,n)=>(n.revalidateOnFocus=!1,n.revalidateIfStale=!1,n.revalidateOnReconnect=!1,e(t,r,n)));var g=e.i(12276),h=e.i(87607),x=e.i(25913),v=e.i(81140),b=e.i(20783),y=e.i(30030),w=e.i(69340),j=e.i(48425),C=e.i(75830),_=e.i(86318),N=e.i(26330),R=e.i(3536),S=e.i(65491),M=e.i(10772),E=e.i(53660),k=e.i(74606),D=e.i(96626),P=e.i(30207),I="rovingFocusGroup.onEntryFocus",T={bubbles:!1,cancelable:!0},O="RovingFocusGroup",[L,F,$]=(0,C.createCollection)(O),[A,V]=(0,y.createContextScope)(O,[$]),[H,z]=A(O),K=s.forwardRef((e,t)=>(0,a.jsx)(L.Provider,{scope:e.__scopeRovingFocusGroup,children:(0,a.jsx)(L.Slot,{scope:e.__scopeRovingFocusGroup,children:(0,a.jsx)(U,{...e,ref:t})})}));K.displayName=O;var U=s.forwardRef((e,t)=>{let{__scopeRovingFocusGroup:r,orientation:n,loop:o=!1,dir:i,currentTabStopId:l,defaultCurrentTabStopId:d,onCurrentTabStopIdChange:c,onEntryFocus:u,preventScrollOnEntryFocus:p=!1,...m}=e,f=s.useRef(null),g=(0,b.useComposedRefs)(t,f),h=(0,_.useDirection)(i),[x,y]=(0,w.useControllableState)({prop:l,defaultProp:d??null,onChange:c,caller:O}),[C,N]=s.useState(!1),R=(0,P.useCallbackRef)(u),S=F(r),M=s.useRef(!1),[E,k]=s.useState(0);return s.useEffect(()=>{let e=f.current;if(e)return e.addEventListener(I,R),()=>e.removeEventListener(I,R)},[R]),(0,a.jsx)(H,{scope:r,orientation:n,dir:h,loop:o,currentTabStopId:x,onItemFocus:s.useCallback(e=>y(e),[y]),onItemShiftTab:s.useCallback(()=>N(!0),[]),onFocusableItemAdd:s.useCallback(()=>k(e=>e+1),[]),onFocusableItemRemove:s.useCallback(()=>k(e=>e-1),[]),children:(0,a.jsx)(j.Primitive.div,{tabIndex:C||0===E?-1:0,"data-orientation":n,...m,ref:g,style:{outline:"none",...e.style},onMouseDown:(0,v.composeEventHandlers)(e.onMouseDown,()=>{M.current=!0}),onFocus:(0,v.composeEventHandlers)(e.onFocus,e=>{let t=!M.current;if(e.target===e.currentTarget&&t&&!C){let t=new CustomEvent(I,T);if(e.currentTarget.dispatchEvent(t),!t.defaultPrevented){let e=S().filter(e=>e.focusable);W([e.find(e=>e.active),e.find(e=>e.id===x),...e].filter(Boolean).map(e=>e.ref.current),p)}}M.current=!1}),onBlur:(0,v.composeEventHandlers)(e.onBlur,()=>N(!1))})})}),B="RovingFocusGroupItem",G=s.forwardRef((e,t)=>{let{__scopeRovingFocusGroup:r,focusable:n=!0,active:o=!1,tabStopId:i,children:l,...d}=e,c=(0,M.useId)(),u=i||c,p=z(B,r),m=p.currentTabStopId===u,f=F(r),{onFocusableItemAdd:g,onFocusableItemRemove:h,currentTabStopId:x}=p;return s.useEffect(()=>{if(n)return g(),()=>h()},[n,g,h]),(0,a.jsx)(L.ItemSlot,{scope:r,id:u,focusable:n,active:o,children:(0,a.jsx)(j.Primitive.span,{tabIndex:m?0:-1,"data-orientation":p.orientation,...d,ref:t,onMouseDown:(0,v.composeEventHandlers)(e.onMouseDown,e=>{n?p.onItemFocus(u):e.preventDefault()}),onFocus:(0,v.composeEventHandlers)(e.onFocus,()=>p.onItemFocus(u)),onKeyDown:(0,v.composeEventHandlers)(e.onKeyDown,e=>{if("Tab"===e.key&&e.shiftKey)return void p.onItemShiftTab();if(e.target!==e.currentTarget)return;let t=function(e,t,r){var n;let a=(n=e.key,"rtl"!==r?n:"ArrowLeft"===n?"ArrowRight":"ArrowRight"===n?"ArrowLeft":n);if(!("vertical"===t&&["ArrowLeft","ArrowRight"].includes(a))&&!("horizontal"===t&&["ArrowUp","ArrowDown"].includes(a)))return J[a]}(e,p.orientation,p.dir);if(void 0!==t){if(e.metaKey||e.ctrlKey||e.altKey||e.shiftKey)return;e.preventDefault();let a=f().filter(e=>e.focusable).map(e=>e.ref.current);if("last"===t)a.reverse();else if("prev"===t||"next"===t){var r,n;"prev"===t&&a.reverse();let s=a.indexOf(e.currentTarget);a=p.loop?(r=a,n=s+1,r.map((e,t)=>r[(n+t)%r.length])):a.slice(s+1)}setTimeout(()=>W(a))}}),children:"function"==typeof l?l({isCurrentTabStop:m,hasTabStop:null!=x}):l})})});G.displayName=B;var J={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function W(e,t=!1){let r=document.activeElement;for(let n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}var X=Symbol("radix.slottable");function Y(e){return s.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===X}var Z=e.i(86312),q=e.i(85369),Q=["Enter"," "],ee=["ArrowUp","PageDown","End"],et=["ArrowDown","PageUp","Home",...ee],er={ltr:[...Q,"ArrowRight"],rtl:[...Q,"ArrowLeft"]},en={ltr:["ArrowLeft"],rtl:["ArrowRight"]},ea="Menu",[es,eo,ei]=(0,C.createCollection)(ea),[el,ed]=(0,y.createContextScope)(ea,[ei,E.createPopperScope,V]),ec=(0,E.createPopperScope)(),eu=V(),[ep,em]=el(ea),[ef,eg]=el(ea),eh=e=>{let{__scopeMenu:t,open:r=!1,children:n,dir:o,onOpenChange:i,modal:l=!0}=e,d=ec(t),[c,u]=s.useState(null),p=s.useRef(!1),m=(0,P.useCallbackRef)(i),f=(0,_.useDirection)(o);return s.useEffect(()=>{let e=()=>{p.current=!0,document.addEventListener("pointerdown",t,{capture:!0,once:!0}),document.addEventListener("pointermove",t,{capture:!0,once:!0})},t=()=>p.current=!1;return document.addEventListener("keydown",e,{capture:!0}),()=>{document.removeEventListener("keydown",e,{capture:!0}),document.removeEventListener("pointerdown",t,{capture:!0}),document.removeEventListener("pointermove",t,{capture:!0})}},[]),(0,a.jsx)(E.Root,{...d,children:(0,a.jsx)(ep,{scope:t,open:r,onOpenChange:m,content:c,onContentChange:u,children:(0,a.jsx)(ef,{scope:t,onClose:s.useCallback(()=>m(!1),[m]),isUsingKeyboardRef:p,dir:f,modal:l,children:n})})})};eh.displayName=ea;var ex=s.forwardRef((e,t)=>{let{__scopeMenu:r,...n}=e,s=ec(r);return(0,a.jsx)(E.Anchor,{...s,...n,ref:t})});ex.displayName="MenuAnchor";var ev="MenuPortal",[eb,ey]=el(ev,{forceMount:void 0}),ew=e=>{let{__scopeMenu:t,forceMount:r,children:n,container:s}=e,o=em(ev,t);return(0,a.jsx)(eb,{scope:t,forceMount:r,children:(0,a.jsx)(D.Presence,{present:r||o.open,children:(0,a.jsx)(k.Portal,{asChild:!0,container:s,children:n})})})};ew.displayName=ev;var ej="MenuContent",[eC,e_]=el(ej),eN=s.forwardRef((e,t)=>{let r=ey(ej,e.__scopeMenu),{forceMount:n=r.forceMount,...s}=e,o=em(ej,e.__scopeMenu),i=eg(ej,e.__scopeMenu);return(0,a.jsx)(es.Provider,{scope:e.__scopeMenu,children:(0,a.jsx)(D.Presence,{present:n||o.open,children:(0,a.jsx)(es.Slot,{scope:e.__scopeMenu,children:i.modal?(0,a.jsx)(eR,{...s,ref:t}):(0,a.jsx)(eS,{...s,ref:t})})})})}),eR=s.forwardRef((e,t)=>{let r=em(ej,e.__scopeMenu),n=s.useRef(null),o=(0,b.useComposedRefs)(t,n);return s.useEffect(()=>{let e=n.current;if(e)return(0,Z.hideOthers)(e)},[]),(0,a.jsx)(eE,{...e,ref:o,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:(0,v.composeEventHandlers)(e.onFocusOutside,e=>e.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),eS=s.forwardRef((e,t)=>{let r=em(ej,e.__scopeMenu);return(0,a.jsx)(eE,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),eM=((n=s.forwardRef((e,t)=>{let{children:r,...n}=e;if(s.isValidElement(r)){var a;let e,o,i=(a=r,(o=(e=Object.getOwnPropertyDescriptor(a.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.ref:(o=(e=Object.getOwnPropertyDescriptor(a,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?a.props.ref:a.props.ref||a.ref),l=function(e,t){let r={...t};for(let n in t){let a=e[n],s=t[n];/^on[A-Z]/.test(n)?a&&s?r[n]=(...e)=>{let t=s(...e);return a(...e),t}:a&&(r[n]=a):"style"===n?r[n]={...a,...s}:"className"===n&&(r[n]=[a,s].filter(Boolean).join(" "))}return{...e,...r}}(n,r.props);return r.type!==s.Fragment&&(l.ref=t?(0,b.composeRefs)(t,i):i),s.cloneElement(r,l)}return s.Children.count(r)>1?s.Children.only(null):null})).displayName="MenuContent.ScrollLock.SlotClone",t=n,(r=s.forwardRef((e,r)=>{let{children:n,...o}=e,i=s.Children.toArray(n),l=i.find(Y);if(l){let e=l.props.children,n=i.map(t=>t!==l?t:s.Children.count(e)>1?s.Children.only(null):s.isValidElement(e)?e.props.children:null);return(0,a.jsx)(t,{...o,ref:r,children:s.isValidElement(e)?s.cloneElement(e,void 0,n):null})}return(0,a.jsx)(t,{...o,ref:r,children:n})})).displayName="MenuContent.ScrollLock.Slot",r),eE=s.forwardRef((e,t)=>{let{__scopeMenu:r,loop:n=!1,trapFocus:o,onOpenAutoFocus:i,onCloseAutoFocus:l,disableOutsidePointerEvents:d,onEntryFocus:c,onEscapeKeyDown:u,onPointerDownOutside:p,onFocusOutside:m,onInteractOutside:f,onDismiss:g,disableOutsideScroll:h,...x}=e,y=em(ej,r),w=eg(ej,r),j=ec(r),C=eu(r),_=eo(r),[M,k]=s.useState(null),D=s.useRef(null),P=(0,b.useComposedRefs)(t,D,y.onContentChange),I=s.useRef(0),T=s.useRef(""),O=s.useRef(0),L=s.useRef(null),F=s.useRef("right"),$=s.useRef(0),A=h?q.RemoveScroll:s.Fragment;s.useEffect(()=>()=>window.clearTimeout(I.current),[]),(0,R.useFocusGuards)();let V=s.useCallback(e=>{var t,r;return F.current===L.current?.side&&(t=e,!!(r=L.current?.area)&&function(e,t){let{x:r,y:n}=e,a=!1;for(let e=0,s=t.length-1;e<t.length;s=e++){let o=t[e],i=t[s],l=o.x,d=o.y,c=i.x,u=i.y;d>n!=u>n&&r<(c-l)*(n-d)/(u-d)+l&&(a=!a)}return a}({x:t.clientX,y:t.clientY},r))},[]);return(0,a.jsx)(eC,{scope:r,searchRef:T,onItemEnter:s.useCallback(e=>{V(e)&&e.preventDefault()},[V]),onItemLeave:s.useCallback(e=>{V(e)||(D.current?.focus(),k(null))},[V]),onTriggerLeave:s.useCallback(e=>{V(e)&&e.preventDefault()},[V]),pointerGraceTimerRef:O,onPointerGraceIntentChange:s.useCallback(e=>{L.current=e},[]),children:(0,a.jsx)(A,{...h?{as:eM,allowPinchZoom:!0}:void 0,children:(0,a.jsx)(S.FocusScope,{asChild:!0,trapped:o,onMountAutoFocus:(0,v.composeEventHandlers)(i,e=>{e.preventDefault(),D.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:l,children:(0,a.jsx)(N.DismissableLayer,{asChild:!0,disableOutsidePointerEvents:d,onEscapeKeyDown:u,onPointerDownOutside:p,onFocusOutside:m,onInteractOutside:f,onDismiss:g,children:(0,a.jsx)(K,{asChild:!0,...C,dir:w.dir,orientation:"vertical",loop:n,currentTabStopId:M,onCurrentTabStopIdChange:k,onEntryFocus:(0,v.composeEventHandlers)(c,e=>{w.isUsingKeyboardRef.current||e.preventDefault()}),preventScrollOnEntryFocus:!0,children:(0,a.jsx)(E.Content,{role:"menu","aria-orientation":"vertical","data-state":e1(y.open),"data-radix-menu-content":"",dir:w.dir,...j,...x,ref:P,style:{outline:"none",...x.style},onKeyDown:(0,v.composeEventHandlers)(x.onKeyDown,e=>{let t=e.target.closest("[data-radix-menu-content]")===e.currentTarget,r=e.ctrlKey||e.altKey||e.metaKey,n=1===e.key.length;if(t){var a;let t,s,o,i,l,d;"Tab"===e.key&&e.preventDefault(),!r&&n&&(a=e.key,t=T.current+a,s=_().filter(e=>!e.disabled),o=document.activeElement,i=s.find(e=>e.ref.current===o)?.textValue,l=function(e,t,r){var n;let a=t.length>1&&Array.from(t).every(e=>e===t[0])?t[0]:t,s=r?e.indexOf(r):-1,o=(n=Math.max(s,0),e.map((t,r)=>e[(n+r)%e.length]));1===a.length&&(o=o.filter(e=>e!==r));let i=o.find(e=>e.toLowerCase().startsWith(a.toLowerCase()));return i!==r?i:void 0}(s.map(e=>e.textValue),t,i),d=s.find(e=>e.textValue===l)?.ref.current,function e(t){T.current=t,window.clearTimeout(I.current),""!==t&&(I.current=window.setTimeout(()=>e(""),1e3))}(t),d&&setTimeout(()=>d.focus()))}let s=D.current;if(e.target!==s||!et.includes(e.key))return;e.preventDefault();let o=_().filter(e=>!e.disabled).map(e=>e.ref.current);ee.includes(e.key)&&o.reverse(),function(e){let t=document.activeElement;for(let r of e)if(r===t||(r.focus(),document.activeElement!==t))return}(o)}),onBlur:(0,v.composeEventHandlers)(e.onBlur,e=>{e.currentTarget.contains(e.target)||(window.clearTimeout(I.current),T.current="")}),onPointerMove:(0,v.composeEventHandlers)(e.onPointerMove,e5(e=>{let t=e.target,r=$.current!==e.clientX;e.currentTarget.contains(t)&&r&&(F.current=e.clientX>$.current?"right":"left",$.current=e.clientX)}))})})})})})})});eN.displayName=ej;var ek=s.forwardRef((e,t)=>{let{__scopeMenu:r,...n}=e;return(0,a.jsx)(j.Primitive.div,{role:"group",...n,ref:t})});ek.displayName="MenuGroup";var eD=s.forwardRef((e,t)=>{let{__scopeMenu:r,...n}=e;return(0,a.jsx)(j.Primitive.div,{...n,ref:t})});eD.displayName="MenuLabel";var eP="MenuItem",eI="menu.itemSelect",eT=s.forwardRef((e,t)=>{let{disabled:r=!1,onSelect:n,...o}=e,i=s.useRef(null),l=eg(eP,e.__scopeMenu),d=e_(eP,e.__scopeMenu),c=(0,b.useComposedRefs)(t,i),u=s.useRef(!1);return(0,a.jsx)(eO,{...o,ref:c,disabled:r,onClick:(0,v.composeEventHandlers)(e.onClick,()=>{let e=i.current;if(!r&&e){let t=new CustomEvent(eI,{bubbles:!0,cancelable:!0});e.addEventListener(eI,e=>n?.(e),{once:!0}),(0,j.dispatchDiscreteCustomEvent)(e,t),t.defaultPrevented?u.current=!1:l.onClose()}}),onPointerDown:t=>{e.onPointerDown?.(t),u.current=!0},onPointerUp:(0,v.composeEventHandlers)(e.onPointerUp,e=>{u.current||e.currentTarget?.click()}),onKeyDown:(0,v.composeEventHandlers)(e.onKeyDown,e=>{let t=""!==d.searchRef.current;r||t&&" "===e.key||Q.includes(e.key)&&(e.currentTarget.click(),e.preventDefault())})})});eT.displayName=eP;var eO=s.forwardRef((e,t)=>{let{__scopeMenu:r,disabled:n=!1,textValue:o,...i}=e,l=e_(eP,r),d=eu(r),c=s.useRef(null),u=(0,b.useComposedRefs)(t,c),[p,m]=s.useState(!1),[f,g]=s.useState("");return s.useEffect(()=>{let e=c.current;e&&g((e.textContent??"").trim())},[i.children]),(0,a.jsx)(es.ItemSlot,{scope:r,disabled:n,textValue:o??f,children:(0,a.jsx)(G,{asChild:!0,...d,focusable:!n,children:(0,a.jsx)(j.Primitive.div,{role:"menuitem","data-highlighted":p?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...i,ref:u,onPointerMove:(0,v.composeEventHandlers)(e.onPointerMove,e5(e=>{n?l.onItemLeave(e):(l.onItemEnter(e),e.defaultPrevented||e.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:(0,v.composeEventHandlers)(e.onPointerLeave,e5(e=>l.onItemLeave(e))),onFocus:(0,v.composeEventHandlers)(e.onFocus,()=>m(!0)),onBlur:(0,v.composeEventHandlers)(e.onBlur,()=>m(!1))})})})}),eL=s.forwardRef((e,t)=>{let{checked:r=!1,onCheckedChange:n,...s}=e;return(0,a.jsx)(eU,{scope:e.__scopeMenu,checked:r,children:(0,a.jsx)(eT,{role:"menuitemcheckbox","aria-checked":e2(r)?"mixed":r,...s,ref:t,"data-state":e4(r),onSelect:(0,v.composeEventHandlers)(s.onSelect,()=>n?.(!!e2(r)||!r),{checkForDefaultPrevented:!1})})})});eL.displayName="MenuCheckboxItem";var eF="MenuRadioGroup",[e$,eA]=el(eF,{value:void 0,onValueChange:()=>{}}),eV=s.forwardRef((e,t)=>{let{value:r,onValueChange:n,...s}=e,o=(0,P.useCallbackRef)(n);return(0,a.jsx)(e$,{scope:e.__scopeMenu,value:r,onValueChange:o,children:(0,a.jsx)(ek,{...s,ref:t})})});eV.displayName=eF;var eH="MenuRadioItem",ez=s.forwardRef((e,t)=>{let{value:r,...n}=e,s=eA(eH,e.__scopeMenu),o=r===s.value;return(0,a.jsx)(eU,{scope:e.__scopeMenu,checked:o,children:(0,a.jsx)(eT,{role:"menuitemradio","aria-checked":o,...n,ref:t,"data-state":e4(o),onSelect:(0,v.composeEventHandlers)(n.onSelect,()=>s.onValueChange?.(r),{checkForDefaultPrevented:!1})})})});ez.displayName=eH;var eK="MenuItemIndicator",[eU,eB]=el(eK,{checked:!1}),eG=s.forwardRef((e,t)=>{let{__scopeMenu:r,forceMount:n,...s}=e,o=eB(eK,r);return(0,a.jsx)(D.Presence,{present:n||e2(o.checked)||!0===o.checked,children:(0,a.jsx)(j.Primitive.span,{...s,ref:t,"data-state":e4(o.checked)})})});eG.displayName=eK;var eJ=s.forwardRef((e,t)=>{let{__scopeMenu:r,...n}=e;return(0,a.jsx)(j.Primitive.div,{role:"separator","aria-orientation":"horizontal",...n,ref:t})});eJ.displayName="MenuSeparator";var eW=s.forwardRef((e,t)=>{let{__scopeMenu:r,...n}=e,s=ec(r);return(0,a.jsx)(E.Arrow,{...s,...n,ref:t})});eW.displayName="MenuArrow";var[eX,eY]=el("MenuSub"),eZ="MenuSubTrigger",eq=s.forwardRef((e,t)=>{let r=em(eZ,e.__scopeMenu),n=eg(eZ,e.__scopeMenu),o=eY(eZ,e.__scopeMenu),i=e_(eZ,e.__scopeMenu),l=s.useRef(null),{pointerGraceTimerRef:d,onPointerGraceIntentChange:c}=i,u={__scopeMenu:e.__scopeMenu},p=s.useCallback(()=>{l.current&&window.clearTimeout(l.current),l.current=null},[]);return s.useEffect(()=>p,[p]),s.useEffect(()=>{let e=d.current;return()=>{window.clearTimeout(e),c(null)}},[d,c]),(0,a.jsx)(ex,{asChild:!0,...u,children:(0,a.jsx)(eO,{id:o.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":o.contentId,"data-state":e1(r.open),...e,ref:(0,b.composeRefs)(t,o.onTriggerChange),onClick:t=>{e.onClick?.(t),e.disabled||t.defaultPrevented||(t.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:(0,v.composeEventHandlers)(e.onPointerMove,e5(t=>{i.onItemEnter(t),!t.defaultPrevented&&(e.disabled||r.open||l.current||(i.onPointerGraceIntentChange(null),l.current=window.setTimeout(()=>{r.onOpenChange(!0),p()},100)))})),onPointerLeave:(0,v.composeEventHandlers)(e.onPointerLeave,e5(e=>{p();let t=r.content?.getBoundingClientRect();if(t){let n=r.content?.dataset.side,a="right"===n,s=t[a?"left":"right"],o=t[a?"right":"left"];i.onPointerGraceIntentChange({area:[{x:e.clientX+(a?-5:5),y:e.clientY},{x:s,y:t.top},{x:o,y:t.top},{x:o,y:t.bottom},{x:s,y:t.bottom}],side:n}),window.clearTimeout(d.current),d.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(e),e.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:(0,v.composeEventHandlers)(e.onKeyDown,t=>{let a=""!==i.searchRef.current;e.disabled||a&&" "===t.key||er[n.dir].includes(t.key)&&(r.onOpenChange(!0),r.content?.focus(),t.preventDefault())})})})});eq.displayName=eZ;var eQ="MenuSubContent",e0=s.forwardRef((e,t)=>{let r=ey(ej,e.__scopeMenu),{forceMount:n=r.forceMount,...o}=e,i=em(ej,e.__scopeMenu),l=eg(ej,e.__scopeMenu),d=eY(eQ,e.__scopeMenu),c=s.useRef(null),u=(0,b.useComposedRefs)(t,c);return(0,a.jsx)(es.Provider,{scope:e.__scopeMenu,children:(0,a.jsx)(D.Presence,{present:n||i.open,children:(0,a.jsx)(es.Slot,{scope:e.__scopeMenu,children:(0,a.jsx)(eE,{id:d.contentId,"aria-labelledby":d.triggerId,...o,ref:u,align:"start",side:"rtl"===l.dir?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:e=>{l.isUsingKeyboardRef.current&&c.current?.focus(),e.preventDefault()},onCloseAutoFocus:e=>e.preventDefault(),onFocusOutside:(0,v.composeEventHandlers)(e.onFocusOutside,e=>{e.target!==d.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:(0,v.composeEventHandlers)(e.onEscapeKeyDown,e=>{l.onClose(),e.preventDefault()}),onKeyDown:(0,v.composeEventHandlers)(e.onKeyDown,e=>{let t=e.currentTarget.contains(e.target),r=en[l.dir].includes(e.key);t&&r&&(i.onOpenChange(!1),d.trigger?.focus(),e.preventDefault())})})})})})});function e1(e){return e?"open":"closed"}function e2(e){return"indeterminate"===e}function e4(e){return e2(e)?"indeterminate":e?"checked":"unchecked"}function e5(e){return t=>"mouse"===t.pointerType?e(t):void 0}e0.displayName=eQ;var e7="DropdownMenu",[e6,e3]=(0,y.createContextScope)(e7,[ed]),e9=ed(),[e8,te]=e6(e7),tt=e=>{let{__scopeDropdownMenu:t,children:r,dir:n,open:o,defaultOpen:i,onOpenChange:l,modal:d=!0}=e,c=e9(t),u=s.useRef(null),[p,m]=(0,w.useControllableState)({prop:o,defaultProp:i??!1,onChange:l,caller:e7});return(0,a.jsx)(e8,{scope:t,triggerId:(0,M.useId)(),triggerRef:u,contentId:(0,M.useId)(),open:p,onOpenChange:m,onOpenToggle:s.useCallback(()=>m(e=>!e),[m]),modal:d,children:(0,a.jsx)(eh,{...c,open:p,onOpenChange:m,dir:n,modal:d,children:r})})};tt.displayName=e7;var tr="DropdownMenuTrigger",tn=s.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,disabled:n=!1,...s}=e,o=te(tr,r),i=e9(r);return(0,a.jsx)(ex,{asChild:!0,...i,children:(0,a.jsx)(j.Primitive.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...s,ref:(0,b.composeRefs)(t,o.triggerRef),onPointerDown:(0,v.composeEventHandlers)(e.onPointerDown,e=>{!n&&0===e.button&&!1===e.ctrlKey&&(o.onOpenToggle(),o.open||e.preventDefault())}),onKeyDown:(0,v.composeEventHandlers)(e.onKeyDown,e=>{!n&&(["Enter"," "].includes(e.key)&&o.onOpenToggle(),"ArrowDown"===e.key&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(e.key)&&e.preventDefault())})})})});tn.displayName=tr;var ta=e=>{let{__scopeDropdownMenu:t,...r}=e,n=e9(t);return(0,a.jsx)(ew,{...n,...r})};ta.displayName="DropdownMenuPortal";var ts="DropdownMenuContent",to=s.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,o=te(ts,r),i=e9(r),l=s.useRef(!1);return(0,a.jsx)(eN,{id:o.contentId,"aria-labelledby":o.triggerId,...i,...n,ref:t,onCloseAutoFocus:(0,v.composeEventHandlers)(e.onCloseAutoFocus,e=>{l.current||o.triggerRef.current?.focus(),l.current=!1,e.preventDefault()}),onInteractOutside:(0,v.composeEventHandlers)(e.onInteractOutside,e=>{let t=e.detail.originalEvent,r=0===t.button&&!0===t.ctrlKey,n=2===t.button||r;(!o.modal||n)&&(l.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});to.displayName=ts,s.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,s=e9(r);return(0,a.jsx)(ek,{...s,...n,ref:t})}).displayName="DropdownMenuGroup",s.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,s=e9(r);return(0,a.jsx)(eD,{...s,...n,ref:t})}).displayName="DropdownMenuLabel";var ti=s.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,s=e9(r);return(0,a.jsx)(eT,{...s,...n,ref:t})});ti.displayName="DropdownMenuItem",s.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,s=e9(r);return(0,a.jsx)(eL,{...s,...n,ref:t})}).displayName="DropdownMenuCheckboxItem",s.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,s=e9(r);return(0,a.jsx)(eV,{...s,...n,ref:t})}).displayName="DropdownMenuRadioGroup",s.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,s=e9(r);return(0,a.jsx)(ez,{...s,...n,ref:t})}).displayName="DropdownMenuRadioItem",s.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,s=e9(r);return(0,a.jsx)(eG,{...s,...n,ref:t})}).displayName="DropdownMenuItemIndicator",s.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,s=e9(r);return(0,a.jsx)(eJ,{...s,...n,ref:t})}).displayName="DropdownMenuSeparator",s.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,s=e9(r);return(0,a.jsx)(eW,{...s,...n,ref:t})}).displayName="DropdownMenuArrow",s.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,s=e9(r);return(0,a.jsx)(eq,{...s,...n,ref:t})}).displayName="DropdownMenuSubTrigger",s.forwardRef((e,t)=>{let{__scopeDropdownMenu:r,...n}=e,s=e9(r);return(0,a.jsx)(e0,{...s,...n,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})}).displayName="DropdownMenuSubContent";var tl=(0,s.createContext)(void 0);function td(){let e=(0,s.useContext)(tl);if(!e)throw Error("Components must be wrapped under <CommentsProvider />");return e}function tc({page:e,auth:t,children:r}){let{fetcher:n}=(0,c.useCommentsContext)(),o=f("api"===t.type?`/api/comment/${e}/auth`:null,()=>n.getAuthSession({page:e}),{shouldRetryOnError:!1}),i=(0,s.useMemo)(()=>{var e;return"ssr"===t.type?{isLoading:!1,session:t.session,signIn:t.signIn}:{session:o.data?{id:o.data.id,permissions:{delete:(null==(e=o.data.role)?void 0:e.canDelete)===!0}}:null,isLoading:o.isLoading,signIn:t.signIn}},[t,o.data,o.isLoading]);return(0,a.jsx)(tl.Provider,{value:i,children:r})}function tu(e){return["/api/comments",e]}function tp(){let e=new Map;return{trigger(t,...r){var n;for(let a of null!=(n=e.get(t))?n:[])a(...r)},useListener(t,r){(0,s.useEffect)(()=>{var n;let a=null!=(n=e.get(t))?n:[];return a.push(r),e.set(t,a),()=>{var n,a;e.set(t,null!=(a=null==(n=e.get(t))?void 0:n.filter(e=>e!==r))?a:[])}},[t,r,e])}}}var tm=new Map,{useListener:tf,trigger:tg}=tp();function th(e,t){let r=tx(e),n=t(tm.get(r));n&&(tm.set(r,n),tg(r))}function tx(e){var t;return`${e[0]}:${null!=(t=e[1])?t:"unset"}`}var tv=new Map,{useListener:tb,trigger:ty}=tp();function tw(e){for(let t of e)tj(t.id,t)}function tj(e,t){tv.set(e,t),ty(e,t)}function tC(e,t){let r=tv.get(e);r&&tj(e,t(r))}function t_(e,t){tC(e,e=>{let r=e.likes,n=e.dislikes;return!0===e.liked&&r--,!1===e.liked&&n--,!0===t&&r++,!1===t&&n++,(0,p.__spreadProps)((0,p.__spreadValues)({},e),{likes:r,dislikes:n,liked:t})})}var tN=(0,s.forwardRef)((e,t)=>{var{placeholder:r="Leave comment"}=e,n=(0,p.__objRest)(e,["placeholder"]);let o=td(),{page:i,fetcher:m}=(0,c.useCommentsContext)(),[f,h]=(0,s.useState)(!0),x=(0,s.useRef)(void 0),v=(0,g.default)(tu({page:i}),(e,{arg:t})=>m.postComment((0,p.__spreadValues)({page:i},t)),{onSuccess:e=>{var t;th([e.page,e.threadId],t=>t?[e,...t]:void 0),tw([e]),null==(t=x.current)||t.commands.clearContent(!0)},revalidate:!1}),b=v.isMutating,y=(0,c.useLatestCallback)(()=>{if(o.isLoading||null===o.session||!x.current)return;let e=x.current.getJSON();x.current.isEmpty||((0,d.clearPersistentId)("create"),v.trigger({content:e}))});return(0,a.jsxs)("form",(0,p.__spreadProps)((0,p.__spreadValues)({ref:t,onSubmit:e=>{y(),e.preventDefault()}},n),{className:(0,u.twMerge)("relative",n.className),children:[v.error?(0,a.jsx)("p",{className:"text-sm text-fc-danger p-4",children:v.error.message}):null,(0,a.jsx)(d.CommentEditor,{persistentId:"create",containerProps:{className:"border-none p-1 rounded-b-none focus-within:ring-0"},editorRef:x,disabled:b,onChange:(0,s.useCallback)(e=>{h(e.isEmpty)},[]),onSubmit:y,placeholder:r,children:o.isLoading||o.session?(0,a.jsx)("button",{"aria-label":"Send",className:(0,u.twMerge)((0,c.buttonVariants)({size:"icon"})),disabled:b||f,type:"submit",children:v.isMutating?(0,a.jsx)(l.Spinner,{}):(0,a.jsx)(c.SendHorizontal,{className:"size-4"})}):(0,a.jsx)(tG,{className:(0,u.twMerge)((0,c.buttonVariants)({size:"small"}))})})]}))});tN.displayName="CreateForm";var tR=(0,s.createContext)(void 0);function tS(){let e=(0,s.useContext)(tR);if(!e)throw Error("Missing Commend Context");return e}var tM=tR.Provider;function tE(e){var t,{editorRef:r,onCancel:n,comment:o}=e,i=(0,p.__objRest)(e,["editorRef","onCancel","comment"]);let[m,f]=(0,s.useState)(!0),{fetcher:h}=(0,c.useCommentsContext)(),x=(0,g.default)(tu({thread:null!=(t=o.threadId)?t:o.id,page:o.page}),(e,{arg:t})=>h.postComment((0,p.__spreadValues)((0,p.__spreadValues)({},e[1]),t)),{revalidate:!1,onSuccess(e){var t;th([e.page,e.threadId],t=>t?[...t,e]:void 0),e.threadId&&tC(e.threadId,e=>(0,p.__spreadProps)((0,p.__spreadValues)({},e),{replies:e.replies+1})),null==n||n(),null==(t=r.current)||t.commands.clearContent()}}),v=(0,c.useLatestCallback)(()=>{if(!r.current||r.current.isEmpty)return;let e=r.current.getJSON();(0,d.clearPersistentId)(`reply-${o.id}`),x.trigger({content:e})});return(0,a.jsxs)("form",(0,p.__spreadProps)((0,p.__spreadValues)({},i),{className:(0,u.twMerge)("relative",i.className),onSubmit:e=>{v(),e.preventDefault()},children:[x.error?(0,a.jsx)("p",{className:"mb-1 text-sm text-fc-error",children:x.error.message}):null,(0,a.jsx)(d.CommentEditor,{persistentId:`reply-${o.id}`,disabled:x.isMutating,editorRef:r,onChange:(0,s.useCallback)(e=>{f(e.isEmpty)},[]),onEscape:n,onSubmit:v,placeholder:"Reply to comment",children:(0,a.jsx)("button",{"aria-label":"Reply",className:(0,u.twMerge)((0,c.buttonVariants)({size:"icon"})),disabled:x.isMutating||m,type:"submit",children:x.isMutating?(0,a.jsx)(l.Spinner,{}):(0,a.jsx)(c.SendHorizontal,{className:"size-4"})})})]}))}var tk=(0,x.cva)("inline-flex items-center gap-1.5 p-2 text-xs transition-colors rounded-full focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-fc-ring",{variants:{active:{true:"bg-fc-accent text-fc-accent-foreground",false:"text-fc-muted-foreground hover:text-fc-accent-foreground"}}});function tD({canReply:e=!1}){let{fetcher:t}=(0,c.useCommentsContext)(),{comment:r,isReplying:n,setReply:o}=tS(),i=(0,s.useRef)(void 0),{session:l}=td(),p=null!==l,m=(0,d.useIsMobile)();function f(e,r){r===e.liked?(t.deleteRate({id:e.id,page:e.page}),t_(e.id,void 0)):(t.setRate({id:e.id,page:e.page,like:r}),t_(e.id,r))}return(0,s.useEffect)(()=>{n&&setTimeout(()=>{var e;null==(e=i.current)||e.commands.focus("end")},100)},[n]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mt-2 flex flex-row -mx-2",children:[(0,a.jsxs)("button",{className:(0,u.twMerge)(tk({active:!0===r.liked})),disabled:!p,onClick:()=>{f(r,!0)},type:"button",children:[(0,a.jsx)(c.ThumbsUp,{"aria-label":"Like",className:"size-4"}),r.likes>0?r.likes:null]}),(0,a.jsxs)("button",{className:(0,u.twMerge)(tk({active:!1===r.liked})),disabled:!p,onClick:()=>{f(r,!1)},type:"button",children:[(0,a.jsx)(c.ThumbsDown,{"aria-label":"Dislike",className:"size-4"}),r.dislikes>0?r.dislikes:null]}),e&&p?(0,a.jsxs)("button",{type:"button",className:(0,u.twMerge)(tk({active:!1})),onClick:()=>o(!n),children:[(0,a.jsx)(c.Reply,{className:"size-4"}),"Reply"]}):null]}),m?(0,a.jsx)(d.Dialog,{open:n,onOpenChange:o,children:(0,a.jsxs)(d.DialogContent,{"aria-describedby":"reply-description",onOpenAutoFocus:e=>e.preventDefault(),children:[(0,a.jsxs)(d.DialogTitle,{className:"sr-only",children:["Replying to ",r.author.name]}),(0,a.jsx)(tE,{editorRef:i,comment:r,onCancel:()=>o(!1)})]})}):null,!m&&n?(0,a.jsx)(tE,{className:"mt-2",editorRef:i,comment:r,onCancel:()=>o(!1)}):null]})}var tP=(0,x.cva)("inline-flex flex-row items-center justify-between cursor-pointer px-3 py-2 text-start focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-80 [&_svg]:size-3.5",{variants:{variant:{destructive:"text-fc-danger data-[highlighted]:bg-fc-danger/10",default:"data-[highlighted]:bg-fc-accent data-[highlighted]:text-fc-accent-foreground"}},defaultVariants:{variant:"default"}}),tI=(0,x.cva)("flex w-56 flex-col overflow-hidden rounded-lg border border-fc-border bg-fc-popover text-sm text-fc-popover-foreground shadow-lg z-50 focus-visible:outline-none data-[state=closed]:animate-fc-fadeOut"),tT=(0,s.forwardRef)((e,t)=>{var{className:r}=e,n=(0,p.__objRest)(e,["className"]);return(0,a.jsx)(ta,{children:(0,a.jsx)(to,(0,p.__spreadProps)((0,p.__spreadValues)({className:(0,u.twMerge)(tI({className:r})),ref:t},n),{children:n.children}))})});tT.displayName="MenuItems";var tO=(0,s.forwardRef)((e,t)=>{var{className:r,variant:n}=e,s=(0,p.__objRest)(e,["className","variant"]);return(0,a.jsx)(ti,(0,p.__spreadProps)((0,p.__spreadValues)({className:(0,u.twMerge)(tP({className:r,variant:n})),ref:t},s),{children:s.children}))});function tL(e){var{image:t,placeholder:r="avatar"}=e,n=(0,p.__objRest)(e,["image","placeholder"]);return t?(0,a.jsx)("img",(0,p.__spreadProps)((0,p.__spreadValues)({src:t,alt:r},n),{className:(0,u.twMerge)("size-8 select-none rounded-full bg-fc-muted",n.className),"aria-label":"avatar"})):(0,a.jsx)("div",(0,p.__spreadProps)((0,p.__spreadValues)({},n),{"aria-describedby":r,className:(0,u.twMerge)("size-8 rounded-full bg-gradient-to-br from-blue-600 to-red-600",n.className)}))}function tF({onClose:e}){let[t,r]=(0,s.useState)(!1),{comment:n,editorRef:o}=tS(),{fetcher:i}=(0,c.useCommentsContext)(),m=(0,g.default)(tu({page:n.page,thread:n.threadId}),(e,{arg:t})=>i.editComment((0,p.__spreadValues)({id:n.id,page:n.page},t)),{revalidate:!1}),f=(0,c.useLatestCallback)(()=>{if(!o.current||o.current.isEmpty)return;let t=o.current.getJSON();(0,d.clearPersistentId)(`edit-${n.id}`),m.trigger({content:t},{onSuccess(){e(),tC(n.id,e=>(0,p.__spreadProps)((0,p.__spreadValues)({},e),{content:t}))}})});return(0,a.jsx)("form",{className:"relative",onSubmit:e=>{f(),e.preventDefault()},children:(0,a.jsx)(d.CommentEditor,{persistentId:`edit-${n.id}`,defaultValue:n.content,disabled:m.isMutating,editorRef:o,onChange:(0,s.useCallback)(e=>{r(e.isEmpty)},[]),onEscape:e,onSubmit:f,placeholder:"Edit Message",children:(0,a.jsx)("button",{"aria-label":"Edit",className:(0,u.twMerge)((0,c.buttonVariants)({variant:"primary",size:"icon"})),disabled:m.isMutating||t,type:"submit",children:m.isMutating?(0,a.jsx)(l.Spinner,{}):(0,a.jsx)(c.Pencil,{className:"size-4"})})})})}function t$({timestamp:e}){let[t,r]=(0,s.useState)("");return(0,s.useLayoutEffect)(()=>{var t;let n,a,s;r((t=new Date(e),n=new Date(Date.now()),a=t.getFullYear()===n.getFullYear()&&t.getMonth()===n.getMonth()&&t.getDate()===n.getDate()?"Today":[t.getDate().toString().padStart(2,"0"),(t.getMonth()+1).toString().padStart(2,"0"),t.getFullYear()].join("/"),s=[t.getHours().toString().padStart(2,"0"),t.getMinutes().toString().padStart(2,"0")].join(":"),`${a} ${s}`))},[e]),t}function tA(e){var t,{comment:r,actions:n,children:o}=e,l=(0,p.__objRest)(e,["comment","actions","children"]);let[d,c]=(0,s.useState)(!1),m=(0,s.useRef)(void 0),f=null!=(t=function(e){let[t,r]=(0,s.useState)(()=>tv.get(e));return tb(e,r),t}(r.id))?t:r,g=(0,s.useMemo)(()=>({isReplying:d,editorRef:m,setReply:c,comment:f}),[f,d]);return(0,a.jsxs)(tM,{value:g,children:[(0,a.jsxs)("div",(0,p.__spreadProps)((0,p.__spreadValues)({},l),{className:(0,u.twMerge)("relative flex flex-row gap-2 p-4 text-sm",l.className),"data-fc-comment":g.comment.id,"data-fc-reply":g.isReplying,children:[(0,a.jsx)(tL,{placeholder:f.author.name,image:f.author.image,className:"shrink-0"}),(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,a.jsx)("span",{className:"truncate font-medium",children:f.author.name}),(0,a.jsx)("span",{className:"text-xs text-fc-muted-foreground",children:(0,a.jsx)(t$,{timestamp:f.timestamp})}),(0,a.jsx)(tV,{className:"ms-auto -my-2"})]}),(0,a.jsx)(i.ContentRenderer,{content:f.content}),n]})]})),o]})}function tV(e){var t,{className:r}=e,n=(0,p.__objRest)(e,["className"]);let{session:o}=td(),[i,l]=(0,s.useState)(!1),{comment:m,editorRef:f,isReplying:h}=tS(),{fetcher:x}=(0,c.useCommentsContext)(),v=(0,g.default)(tu({thread:m.threadId,page:m.page}),()=>x.deleteComment(m),{onSuccess(){th([m.page,m.threadId],e=>null==e?void 0:e.filter(e=>e.id!==m.id)),m.threadId&&tC(m.threadId,e=>(0,p.__spreadProps)((0,p.__spreadValues)({},e),{replies:e.replies-1}))},revalidate:!1}),b=null!==o&&o.id===m.author.id,y=null!==o&&((null==(t=o.permissions)?void 0:t.delete)||o.id===m.author.id);return(0,a.jsxs)(d.Dialog,{open:i,onOpenChange:l,children:[(0,a.jsxs)(d.DialogContent,{children:[(0,a.jsx)(d.DialogTitle,{className:"max-sm:sr-only",children:"Edit Comment"}),(0,a.jsx)(d.DialogDescription,{className:"max-sm:sr-only",children:"Edit the content of your comment."}),(0,a.jsx)(tF,{onClose:()=>l(!1)})]}),(0,a.jsxs)(tt,{children:[(0,a.jsx)(tn,(0,p.__spreadProps)((0,p.__spreadValues)({"aria-label":"Open Menu",className:(0,u.twMerge)((0,c.buttonVariants)({size:"icon",variant:"ghost",className:"text-fc-muted-foreground data-[state=open]:bg-fc-accent data-[state=open]:text-fc-accent-foreground disabled:invisible"}),r),disabled:i||h},n),{children:(0,a.jsx)(c.EllipsisVertical,{className:"size-4"})})),(0,a.jsxs)(tT,{onCloseAutoFocus:e=>{var t;null==(t=f.current)||t.commands.focus("end"),e.preventDefault()},children:[(0,a.jsxs)(tO,{onSelect:()=>{let e=function e(t){var r,n,a;if("text"===t.type)return null!=(r=t.text)?r:"";let s=(null!=(a=null==(n=t.content)?void 0:n.map(t=>e(t)))?a:[]).join("").trimEnd();return"paragraph"===t.type?`${s}
`:s}(m.content);navigator.clipboard.writeText(e)},children:["Copy",(0,a.jsx)(c.Copy,{})]}),b?(0,a.jsxs)(tO,{onSelect:()=>{l(!0)},children:["Edit",(0,a.jsx)(c.Pencil,{})]}):null,y?(0,a.jsxs)(tO,{disabled:v.isMutating,onSelect:()=>{v.trigger()},variant:"destructive",children:["Delete",(0,a.jsx)(c.Trash2,{})]}):null]})]})]})}tO.displayName="MenuItem";var tH=({comment:e})=>(0,a.jsx)(tA,{comment:e,actions:(0,a.jsx)(tD,{canReply:!0}),children:(0,a.jsx)(tK,{})});function tz(e){var{ref:t,threadId:r,isSubThread:n=!1,components:o={}}=e,i=(0,p.__objRest)(e,["ref","threadId","isSubThread","components"]);let{page:d,fetcher:m}=(0,c.useCommentsContext)(),[g,h]=(0,s.useState)(),{Comment:x=tH}=(0,s.useRef)(o).current,v=function(e){let t=tx(e),[r,n]=(0,s.useState)(()=>{var e;return null!=(e=tm.get(t))?e:[]});return tf(t,(0,c.useLatestCallback)(()=>{var e;n(null!=(e=tm.get(t))?e:[])})),r}([d,r]),b=f(tu({thread:r,page:d,sort:n?"oldest":"newest",[n?"after":"before"]:"number"==typeof g?new Date(g):void 0,limit:40}),([e,t])=>m.fetchComments(t),{onSuccess(e){th([d,r],(t=[])=>[...t,...e]),tw(e)}});return(0,a.jsxs)("div",(0,p.__spreadProps)((0,p.__spreadValues)({ref:t},i),{className:(0,u.twMerge)("flex flex-col",i.className),children:[!b.isLoading&&void 0===g&&0===v.length&&(0,a.jsx)("p",{className:"mx-auto my-4 text-center text-sm text-fc-muted-foreground",children:"No comments"}),v.map(e=>(0,a.jsx)(x,{comment:e},e.id)),b.data&&b.data.length>=40?(0,a.jsx)("button",{type:"button",className:(0,u.twMerge)((0,c.buttonVariants)({variant:"secondary",size:"medium",className:"mx-auto my-2"})),onClick:()=>{v.length>0&&h(new Date(v[v.length-1].timestamp).getTime())},children:"Load More"}):null,b.isLoading?(0,a.jsx)(l.Spinner,{className:"mx-auto my-4"}):null]}))}function tK(){let{comment:e}=tS(),t=td(),r=(0,d.useIsMobile)(),[n,o]=(0,s.useState)(!1),i=(0,s.useRef)(void 0);if(0===e.replies)return null;let l=(0,a.jsxs)("button",{type:"button",className:(0,u.twMerge)((0,c.buttonVariants)({variant:"ghost",size:"medium",className:"w-full text-start justify-start gap-2 pl-13.5 bg-fc-card rounded-none"})),children:[(0,a.jsx)(c.ChevronDown,{className:(0,u.twMerge)("size-4 transition-transform",n&&"rotate-180")}),e.replies," Replies"]});return r?(0,a.jsxs)(d.Dialog,{open:n,onOpenChange:o,children:[(0,a.jsx)(d.DialogTrigger,{asChild:!0,children:l}),(0,a.jsxs)(d.DialogContent,{className:"h-[70vh]",children:[(0,a.jsx)(d.DialogTitle,{children:"Comments"}),(0,a.jsx)(tz,{threadId:e.id,isSubThread:!0,className:"flex-1 -mx-4 overflow-y-auto",components:{Comment:({comment:e})=>(0,a.jsx)(tA,{comment:e,actions:(0,a.jsx)(tD,{})})}}),t.isLoading||t.session?(0,a.jsx)(tE,{comment:e,editorRef:i,className:"bg-fc-popover"}):null]})]}):(0,a.jsxs)(h.Collapsible,{className:"bg-fc-card",open:n,onOpenChange:o,children:[(0,a.jsx)(h.CollapsibleTrigger,{asChild:!0,children:l}),(0,a.jsx)(h.CollapsibleContent,{className:"overflow-hidden data-[state=closed]:animate-fc-accordion-up data-[state=open]:animate-fc-accordion-down",children:(0,a.jsx)(tz,{threadId:e.id,isSubThread:!0,components:{Comment:({comment:e})=>(0,a.jsx)(tA,{comment:e,actions:(0,a.jsx)(tD,{canReply:!0}),className:"ml-10"})}})})]})}function tU({page:e,children:t,mention:r,storage:n,auth:o,apiUrl:i}){let l=t,d=(0,s.useMemo)(()=>({page:e,fetcher:function(e="/api/comments"){function t(e,t){return(0,p.__async)(this,null,function*(){let r=yield fetch(e,t);if(!r.ok){let e=yield r.text(),t=Error(e);try{let r=JSON.parse(e);"message"in r&&"string"==typeof r.message&&(t=Error(r.message))}catch(e){}throw t}return yield r.json()})}return{fetchComments:function({page:r,thread:n,sort:a,before:s,after:o,limit:i}){let l=new URLSearchParams;return n&&l.append("thread",n.toString()),a&&l.append("sort",a),s&&l.append("before",s.getTime().toString()),i&&l.append("limit",i.toString()),o&&l.append("after",o.getTime().toString()),t(`${e}/${r}/?${l.toString()}`)},postComment:function(r){return(0,p.__async)(this,arguments,function*({content:r,page:n,thread:a}){return yield t(`${e}/${n}`,{method:"POST",body:JSON.stringify({thread:a,content:r})})})},editComment:function(r){return(0,p.__async)(this,arguments,function*({id:r,page:n,content:a}){yield t(`${e}/${n}/${r}`,{method:"PATCH",body:JSON.stringify({content:a})})})},deleteComment:function(r){return(0,p.__async)(this,null,function*(){yield t(`${e}/${r.page}/${r.id}`,{method:"DELETE"})})},setRate:function(r){return(0,p.__async)(this,null,function*(){yield t(`${e}/${r.page}/${r.id}/rate`,{method:"POST",body:JSON.stringify({like:r.like})})})},queryUsers:function(r){return(0,p.__async)(this,null,function*(){let n=new URLSearchParams;return n.append("name",r.name),t(`${e}/${r.page}/users?${n.toString()}`)})},deleteRate:function(r){return(0,p.__async)(this,null,function*(){yield t(`${e}/${r.page}/${r.id}/rate`,{method:"DELETE"})})},getAuthSession:function(r){return(0,p.__async)(this,null,function*(){return yield t(`${e}/${r.page}/auth`,{method:"GET"})})}}}(i)}),[e,i]);return r&&(l=(0,a.jsx)(c.MentionProvider,{mention:r,children:l})),n&&(l=(0,a.jsx)(c.StorageProvider,{storage:n,children:l})),(0,a.jsx)(c.CommentsProvider,{value:d,children:(0,a.jsx)(tc,{page:e,auth:o,children:l})})}var tB=(0,s.forwardRef)((e,t)=>{var{className:r}=e,n=(0,p.__objRest)(e,["className"]);return(0,a.jsx)("div",(0,p.__spreadProps)((0,p.__spreadValues)({className:(0,u.twMerge)("flex flex-col",r),ref:t},n),{children:(0,a.jsx)(tz,{})}))});function tG(e){var t;let{signIn:r}=td();return"function"==typeof r?(0,a.jsx)("button",(0,p.__spreadProps)((0,p.__spreadValues)({},e),{onClick:r,type:"button",children:null!=(t=e.children)?t:"Sign In"})):r}tB.displayName="CommentsList",e.i(20765);var tJ=(0,s.forwardRef)((e,t)=>{var{page:r,className:n,title:s,storage:o,editor:i,mention:l,auth:d,apiUrl:c}=e,m=(0,p.__objRest)(e,["page","className","title","storage","editor","mention","auth","apiUrl"]);return(0,a.jsx)(tU,{page:r,apiUrl:c,auth:d,storage:o,mention:l,children:(0,a.jsxs)("div",(0,p.__spreadProps)((0,p.__spreadValues)({className:(0,u.twMerge)("overflow-hidden rounded-xl border border-fc-border bg-fc-background text-fc-foreground",n),ref:t},m),{children:[(0,a.jsxs)("div",{className:"relative flex flex-col gap-2",children:[s,(0,a.jsx)(tN,(0,p.__spreadValues)({},i))]}),(0,a.jsx)(tB,{})]}))})});tJ.displayName="Comments";var tW=e.i(75254);let tX=(0,tW.default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),tY=(0,tW.default)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var tZ=e.i(41947),tZ=tZ,tq=e.i(19455),tQ=e.i(75157);function t0({className:e,type:t,...r}){return(0,a.jsx)("input",{type:t,"data-slot":"input",className:(0,tQ.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...r})}e.i(74080);var t1=e.i(91918),t2=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=(0,t1.createSlot)(`Primitive.${t}`),n=s.forwardRef((e,n)=>{let{asChild:s,...o}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,a.jsx)(s?r:t,{...o,ref:n})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{}),t4=s.forwardRef((e,t)=>(0,a.jsx)(t2.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));function t5({className:e,...t}){return(0,a.jsx)(t4,{"data-slot":"label",className:(0,tQ.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}t4.displayName="Label";let t7="https://blog-comment-api.wztlink1013.com",t6=`${t7}/api/comments`,t3=`${t7}/api/auth/get-session`,t9=`${t7}/api/auth/sign-in/email`,t8=`${t7}/api/auth/sign-up/email`,re=`${t7}/api/auth/sign-out`,rt=()=>{let[e,t]=(0,s.useState)(null),[r,n]=(0,s.useState)(""),[i,l]=(0,s.useState)(""),[d,c]=(0,s.useState)(""),[u,p]=(0,s.useState)(null),[m,f]=(0,s.useState)(!1),[g,h]=(0,s.useState)(!1),[x,v]=(0,s.useState)(!1),b=(0,s.useCallback)((e,t="info")=>{p({message:e,tone:t})},[]),y=(0,s.useCallback)(async()=>{try{f(!0);let e=await fetch(t3,{credentials:"include"});if(401===e.status)return void t(null);if(!e.ok){t(null),b(`获取登录状态失败（${e.status}）`,"error");return}let r=await e.json();t(r.session??null)}catch{t(null),b("获取登录状态失败，请稍后重试。","error")}finally{f(!1)}},[b]);(0,s.useEffect)(()=>{y()},[y]),(0,s.useEffect)(()=>{let e=window.fetch.bind(window);return window.fetch=(t,r)=>("string"==typeof t?t:t instanceof URL?t.toString():t.url).startsWith(t6)?e(t,{...r,credentials:"include"}):e(t,r),()=>{window.fetch=e}},[]);let w=(0,s.useCallback)(async()=>{let e=r.trim(),t=i.trim().toLowerCase(),n=d.trim();if(!e||!t||!n)return void b("请填写昵称、邮箱和密码。","error");try{f(!0),p(null);let r=await fetch(t8,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:t,password:n})});if(!r.ok){let e=await r.text();b(`注册失败：${e||r.status}`,"error");return}b("注册成功，已登录。","success"),await y(),h(!1),v(!1),c("")}catch{b("注册失败，请稍后重试。","error")}finally{f(!1)}},[i,y,r,d,b]),j=(0,s.useCallback)(async()=>{let e=i.trim().toLowerCase(),t=d.trim();if(!e||!t)return void b("请填写邮箱和密码。","error");try{f(!0),p(null);let r=await fetch(t9,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t,rememberMe:!0})});if(!r.ok){let e=await r.text();b(`登录失败：${e||r.status}`,"error");return}b("登录成功。","success"),await y(),h(!1),v(!1),c("")}catch{b("登录失败，请稍后重试。","error")}finally{f(!1)}},[i,y,d,b]),C=(0,s.useCallback)(async()=>{try{f(!0),p(null);let e=await fetch(re,{method:"POST",credentials:"include"});if(!e.ok){let t=await e.text();b(`退出失败：${t||e.status}`,"error");return}t(null),b("已退出登录。","success")}catch{b("退出失败，请稍后重试。","error")}finally{f(!1)}},[b]),_=(0,s.useCallback)(()=>{h(!0)},[]),N=u?.tone==="error"?"text-destructive":u?.tone==="success"?"text-emerald-600":"text-muted-foreground";return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-card space-y-4 rounded-xl border p-6",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"登录后留言"}),(0,a.jsx)("p",{className:"text-muted-foreground text-xs",children:"请先注册或登录，再发布你的留言。"})]}),(0,a.jsx)("div",{className:"bg-muted/30 text-muted-foreground rounded-lg border border-dashed p-3 text-xs",children:e?`已登录：${e?.user?.name??e?.user?.email??"匿名用户"}`:"未登录，请先注册或登录。"}),!e&&(0,a.jsxs)(o.Root,{open:g,onOpenChange:h,children:[(0,a.jsx)(o.Trigger,{asChild:!0,children:(0,a.jsx)(tq.Button,{type:"button",children:"Login / Register"})}),(0,a.jsxs)(o.Portal,{children:[(0,a.jsx)(o.Overlay,{className:"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50 backdrop-blur-sm"}),(0,a.jsxs)(o.Content,{className:"bg-card data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-1/2 left-1/2 z-50 w-[min(92vw,460px)] -translate-x-1/2 -translate-y-1/2 rounded-2xl border p-6 shadow-xl",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(o.Title,{className:"text-base font-semibold",children:"Login / Register"}),(0,a.jsx)(o.Close,{asChild:!0,children:(0,a.jsx)("button",{type:"button",className:"text-muted-foreground hover:text-foreground transition","aria-label":"Close",children:(0,a.jsx)(tZ.default,{className:"size-4"})})})]}),(0,a.jsxs)("div",{className:"mt-4 grid gap-4",children:[(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(t5,{htmlFor:"message-name",children:"昵称"}),(0,a.jsx)(t0,{id:"message-name",value:r,onChange:e=>n(e.target.value),placeholder:"你的昵称",autoComplete:"nickname",disabled:m})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(t5,{htmlFor:"message-email",children:"邮箱"}),(0,a.jsx)(t0,{id:"message-email",type:"email",value:i,onChange:e=>l(e.target.value),placeholder:"name@example.com",autoComplete:"email",disabled:m})]}),(0,a.jsxs)("div",{className:"space-y-2 sm:col-span-2",children:[(0,a.jsx)(t5,{htmlFor:"message-password",children:"密码"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(t0,{id:"message-password",type:x?"text":"password",value:d,onChange:e=>c(e.target.value),placeholder:"请输入密码",autoComplete:"current-password",disabled:m,className:"pr-10"}),(0,a.jsx)("button",{type:"button",className:"text-muted-foreground hover:text-foreground absolute top-1/2 right-2 -translate-y-1/2 transition",onClick:()=>v(e=>!e),"aria-label":x?"Hide password":"Show password","aria-pressed":x,disabled:m,children:x?(0,a.jsx)(tY,{className:"size-4"}):(0,a.jsx)(tX,{className:"size-4"})})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)(tq.Button,{type:"button",onClick:w,disabled:m,children:"注册"}),(0,a.jsx)(tq.Button,{type:"button",variant:"outline",onClick:j,disabled:m,children:"登录"})]}),u&&(0,a.jsx)("p",{className:`text-sm ${N}`,children:u.message})]})]})]})]}),e&&(0,a.jsx)(tq.Button,{type:"button",variant:"outline",onClick:C,disabled:m,children:"退出登录"}),u&&!g&&(0,a.jsx)("p",{className:`text-sm ${N}`,children:u.message})]}),(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsx)(tJ,{page:"message-board",apiUrl:t6,auth:{type:"api",signIn:_},className:"w-full",title:(0,a.jsxs)("div",{className:"space-y-1 px-5 pt-5",children:[(0,a.jsx)("h2",{className:"text-base font-semibold",children:"留言区"}),(0,a.jsx)("p",{className:"text-muted-foreground text-xs",children:"发布后可实时显示，支持点赞与回复。"})]})})})]})};e.s(["MessageBoard",()=>rt],35852)}]);